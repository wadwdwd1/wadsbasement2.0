"use strict";var game={audio:null,audioQueue:[],assetQueue:[],config:{},debug:null,device:{},devicemotion:null,json:{},keyboard:null,modules:{},paths:{},plugins:{},pool:null,s:{},scale:1,scene:null,storage:null,system:null,version:"2.0.2",_booted:!1,_coreModules:["engine.analytics","engine.audio","engine.camera","engine.geometry","engine.keyboard","engine.loader","engine.particle","engine.physics","engine.pixi","engine.pool","engine.renderer","engine.scene","engine.storage","engine.system","engine.timer","engine.tween"],_current:null,_currentModule:null,_DOMLoaded:!1,_gameLoopId:1,_gameLoops:{},_gameModuleDefined:!1,_loader:null,_loadFinished:!1,_moduleQueue:[],_nocache:"",_waitForLoad:0,addAsset:function(t,e){return this._addFileToQueue(t,e,"assetQueue")},addAttributes:function(t,e){for(var i in e)t[i]=e[i]},addAudio:function(t,e){this._addFileToQueue(t,e,"audioQueue")},body:function(t){return this._current.body=t,this._booted||0===this._current.name.indexOf("engine.")?(this._current=null,this._loadFinished&&this._loadModules(),void(this._gameModuleDefined&&this._DOMLoaded&&!this._loadFinished&&this._loadModules())):(this._current=null,this._boot())},clearCache:function(){this.json={},this.paths={}},defineProperties:function(t,e){for(var i in e)Object.defineProperty(t.prototype,i,{get:e[i].get,set:e[i].set})},getJSON:function(t){return this.json[this.paths[t]]},ksort:function(t,e){if(!t||"object"!=typeof t)return!1;var i,n=[],r={};for(i in t)n.push(i);for(n.sort(e),i=0;i<n.length;i++)r[n[i]]=t[n[i]];return r},merge:function(t,e){for(var i in e){var n=e[i];"object"!=typeof n||n instanceof HTMLElement?t[i]=n:(t[i]&&"object"==typeof t[i]||(t[i]=n instanceof Array?[]:{}),this.merge(t[i],n))}return t},module:function(t){if(this._current)throw"Module "+this._current.name+" has no body";if(this.modules[t]&&this.modules[t].body)throw"Module "+t+" is already defined";if(this._current={name:t,requires:[],loaded:!1,imports:{},exports:{}},0===t.indexOf("game.")&&(this._gameModuleDefined=!0,this._current.requires.push("engine.core")),this.modules[t]=this._current,this._moduleQueue.push(this._current),"engine.core"===t){if(this.config.ignoreModules)for(var e=this._coreModules.length-1;e>=0;e--)-1!==this.config.ignoreModules.indexOf(this._coreModules[e])&&this._coreModules.splice(e,1);this._current.requires=this._coreModules,this.body((function(){}))}return this},onStart:function(){},ready:function(){},require:function(t){var e;t=Array.prototype.slice.call(arguments);for(e=0;e<t.length;e++){var i=t[e];i&&-1===this._current.requires.indexOf(i)&&this._current.requires.push(i)}return this},_addFileToQueue:function(t,e,i){if(!(e&&this.paths[e]||this.paths[t])){var n=this._getFilePath(t)+this._nocache;return e&&(this.paths[e]=n),this.paths[t]=n,-1===this[i].indexOf(n)&&this[i].push(n),e}},_boot:function(){for(var t in this._booted=!0,this._loadNativeExtensions(),this._loadDeviceInformation(),this._normalizeVendorAttribute(window,"requestAnimationFrame"),this._normalizeVendorAttribute(navigator,"vibrate"),this.device)if(this.device[t]&&this.config[t])for(var e in this.config[t])"object"==typeof this.config[t][e]?this.merge(this.config[e],this.config[t][e]):this.config[e]=this.config[t][e];(document.location.href.match(/\?nocache/)||this.config.disableCache)&&(this._nocache="?"+performance.now()),void 0===this.config.sourceFolder&&(this.config.sourceFolder="src"),void 0===this.config.mediaFolder&&(this.config.mediaFolder="assets");var i=document.getElementsByTagName("meta");for(t=0;t<i.length;t++)if("viewport"===i[t].name){var n=!0;break}if(!n){var r=document.createElement("meta");r.name="viewport";var o="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no";this.device.iOS71&&(o+=",minimal-ui"),r.content=o,document.getElementsByTagName("head")[0].appendChild(r)}window.addEventListener("devicemotion",(function(t){game.devicemotion=t.accelerationIncludingGravity})),this.module("engine.core"),window.onloadFunction=this._DOMReady.bind(this)},_clearGameLoop:function(t){this._gameLoops[t]?delete this._gameLoops[t]:window.clearInterval(t)},_DOMReady:function(){if(!this._DOMLoaded){if(!document.body)return setTimeout(this._DOMReady.bind(this),40);this._DOMLoaded=!0,this._gameModuleDefined&&this._loadModules()}},_getFilePath:function(t){return-1!==t.indexOf("://")||this.config.mediaFolder&&(t=this.config.mediaFolder+"/"+t),t},_getVendorAttribute:function(t,e){var i=e.ucfirst();return t[e]||t["ms"+i]||t["moz"+i]||t["webkit"+i]||t["o"+i]},removeAsset:function(t){var e=this.paths[t];if(this.json[e]&&this.json[e].frames)for(var i in this.json[e].frames)this.TextureCache[i].destroy(!0),delete this.TextureCache[i];else this.TextureCache[e]&&(this.TextureCache[e].destroy(!0),delete this.TextureCache[e]);delete this.paths[t]},removeAssets:function(){for(var t in this.TextureCache)this.TextureCache[t].destroy(!0),delete this.TextureCache[t];this.paths={}},_loadDeviceInformation:function(){this.device.pixelRatio=window.devicePixelRatio||1,this.device.screen={width:window.screen.availWidth*this.device.pixelRatio,height:window.screen.availHeight*this.device.pixelRatio},this.device.iPod=/iPod/i.test(navigator.userAgent),this.device.iPhone=/iPhone/i.test(navigator.userAgent),this.device.iPhone4=this.device.iPhone&&2===this.device.pixelRatio&&920===this.device.screen.height,this.device.iPhone5=this.device.iPhone&&2===this.device.pixelRatio&&1096===this.device.screen.height,this.device.iPad=/iPad/i.test(navigator.userAgent),this.device.iPadRetina=this.device.iPad&&2===this.device.pixelRatio,this.device.iOS=this.device.iPod||this.device.iPhone||this.device.iPad,this.device.iOS5=this.device.iOS&&/OS 5/i.test(navigator.userAgent),this.device.iOS6=this.device.iOS&&/OS 6/i.test(navigator.userAgent),this.device.iOS7=this.device.iOS&&/OS 7/i.test(navigator.userAgent),this.device.iOS71=this.device.iOS&&/OS 7_1/i.test(navigator.userAgent),this.device.iOS8=this.device.iOS&&/OS 8/i.test(navigator.userAgent),this.device.android=/android/i.test(navigator.userAgent),this.device.android2=/android 2/i.test(navigator.userAgent);var t=navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);if(this.device.androidStock=!!(t&&t[1]<537),this.device.ie9=/MSIE 9/i.test(navigator.userAgent),this.device.ie10=/MSIE 10/i.test(navigator.userAgent),this.device.ie11=/rv:11.0/i.test(navigator.userAgent),this.device.ie=this.device.ie10||this.device.ie11||this.device.ie9,this.device.wp7=/Windows Phone OS 7/i.test(navigator.userAgent),this.device.wp8=/Windows Phone 8/i.test(navigator.userAgent),this.device.wp=this.device.wp7||this.device.wp8,this.device.wt=/Windows NT/i.test(navigator.userAgent)&&/Touch/i.test(navigator.userAgent),this.device.opera=/Opera/i.test(navigator.userAgent)||/OPR/i.test(navigator.userAgent),this.device.crosswalk=/Crosswalk/i.test(navigator.userAgent),this.device.cocoonJS=!!navigator.isCocoonJS,this.device.cocoonCanvasPlus=/CocoonJS/i.test(navigator.browser),this.device.ejecta=/Ejecta/i.test(navigator.userAgent),this.device.facebook=/FB/i.test(navigator.userAgent),this.device.wiiu=/Nintendo WiiU/i.test(navigator.userAgent),this.device.firefox=/Firefox\D+(\d+)/.test(navigator.userAgent),this.device.mobile=this.device.iOS||this.device.android||this.device.wp||this.device.wt,void 0===navigator.plugins||0===navigator.plugins.length)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),this.device.flash=!0}catch(t){this.device.flash=!1}else this.device.flash=!!navigator.plugins["Shockwave Flash"]},_loadModules:function(){var t,e,i,n,r,o;for(e=0;e<this._moduleQueue.length;e++){for(n=this._moduleQueue[e],o=!0,i=0;i<n.requires.length;i++)r=n.requires[i],this.modules[r]?this.modules[r].loaded?n.imports[r]=this.modules[r].exports:o=!1:(o=!1,this._loadScript(r,n.name));o&&n.body&&(this._moduleQueue.splice(e,1),n.loaded=!0,this._currentModule=n,n.body(),t=!0,e--,0===this._moduleQueue.length&&this._modulesLoaded())}if(t&&this._moduleQueue.length>0)this._loadModules();else{if(0===this._waitForLoad&&0!==this._moduleQueue.length){var s=[];for(e=0;e<this._moduleQueue.length;e++){var a=[],l=this._moduleQueue[e].requires;for(i=0;i<l.length;i++)(n=this.modules[l[i]])&&n.loaded||a.push(l[i]);s.push(this._moduleQueue[e].name+" (requires: "+a.join(", ")+")")}throw"Unresolved modules:\n"+s.join("\n")}this._loadFinished=!0}},_loadNativeExtensions:function(){Number.prototype.round=function(t){return t=t?Math.pow(10,t):1,Math.round(this*t)/t},Math.clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},Array.prototype.erase=function(t){for(var e=this.length;e>=0;e--)if(this[e]===t)return this.splice(e,1),this;return this},Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]},Array.prototype.shuffle=function(){for(var t=this.length,e=t;e--;){var i=parseInt(Math.random()*t),n=this[e];this[e]=this[i],this[i]=n}return this},Function.prototype.bind=function(t){var e=this,i=[];return Array.prototype.push.apply(i,arguments),i.shift(),function(){var n=[];return Array.prototype.push.apply(n,i),Array.prototype.push.apply(n,arguments),e.apply(t,n)}},String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)}},_loadScript:function(t,e){this.modules[t]=!0,this._waitForLoad++;var i=t.replace(/\./g,"/")+".js"+this._nocache;this.config.sourceFolder&&(i=this.config.sourceFolder+"/"+i);var n=document.createElement("script");n.type="text/javascript",n.src=i,n.onload=this._scriptLoaded.bind(this),n.onerror=function(){throw"Error loading module "+t+" at "+i+" required from "+e},document.getElementsByTagName("head")[0].appendChild(n)},_modulesLoaded:function(){for(var t in this.config){var e=t.ucfirst();if(this[e])for(var i in this.config[t])this[e][i]=this.config[t][i]}!1===this.config.autoStart||this.system?this.ready():this.start()},_normalizeVendorAttribute:function(t,e){if(!t[e]){var i=this._getVendorAttribute(t,e);t[e]=t[e]||i}},_scriptLoaded:function(){this._waitForLoad--,this._loadModules()},_setGameLoop:function(t){if(window.requestAnimationFrame){var e=this._gameLoopId++;this._gameLoops[e]=!0;var i=function(n){game._gameLoops[e]&&(window.requestAnimationFrame(i),t(n))};return window.requestAnimationFrame(i),e}return window.setInterval((function(){t(performance.now())}),1e3/60)},_setVendorAttribute:function(t,e,i){var n=e.ucfirst();t[e]=t["ms"+n]=t["moz"+n]=t["webkit"+n]=t["o"+n]=i},start:function(){if(!(this._moduleQueue.length>0)){for(var t in this.system=new this.System,this.Keyboard&&(this.keyboard=new this.Keyboard),this.Audio&&(this.audio=new this.Audio),this.Pool&&(this.pool=new this.Pool),this.DebugDraw&&this.DebugDraw.enabled&&this.Debug.enabled&&(this.debugDraw=new this.DebugDraw),this.Storage&&this.Storage.id&&(this.storage=new this.Storage),this.Analytics&&this.Analytics.id&&(this.analytics=new this.Analytics),this.plugins)this.plugins[t]=new this.plugins[t];this.pool.create("Timer");for(var e=0;32>e;e++)this.pool.put("Timer",new this.Timer);var i=this.Loader.className;this._loader=new this[i](this.System.startScene),this.system.rotateScreenVisible||this._loader.start(),this.onStart()}}};function turnOffSound(){game.audio.soundVolume=0}function turnOnSound(){game.audio.soundVolume=1}game.Core=game,"undefined"!=typeof exports&&(exports=module.exports=game),game.module("engine.analytics").body((function(){function t(t){if(this.trackId=t||game.Analytics.id,navigator.onLine)if(game.device.cocoonJS){this.clientId=Date.now();var e=new XMLHttpRequest,i="v=1&tid="+this.trackId+"&cid="+this.clientId+"&t=pageview&dp=%2F";e.open("POST","http://www.google-analytics.com/collect",!0),e.send(i)}else n=window,r=document,o="script",s="ga",n.GoogleAnalyticsObject=s,n[s]=n[s]||function(){(n[s].q=n[s].q||[]).push(arguments)},n[s].l=1*new Date,a=r.createElement(o),l=r.getElementsByTagName(o)[0],a.async=1,a.src="//www.google-analytics.com/analytics.js",l.parentNode.insertBefore(a,l),ga("create",t,"auto"),ga("send","pageview");var n,r,o,s,a,l}t.prototype.send=function(t,e,i,n){if(navigator.onLine)if(game.device.cocoonJS){var r=new XMLHttpRequest,o="v=1&tid="+this.trackId+"&cid="+this.clientId+"&t=event&ec="+t+"&ea="+e;void 0!==i&&(o+="&el="+i),void 0!==n&&(o+="&ev="+n),r.open("POST","http://www.google-analytics.com/collect",!0),r.send(o)}else ga("send","event",t,e,i,n)},game.addAttributes(t,{id:""}),game.Analytics=t})),game.module("engine.audio").body((function(){function t(){if(this.currentMusic=null,this.currentMusicName=null,this.formats=[],this.musicMuted=!1,this.pausedSounds=[],this.playingSounds=[],this.soundMuted=!1,this._audioId=1,this._audioObjects={},this._sources={},this._systemPaused=[],game._normalizeVendorAttribute(window,"AudioContext"),game.device.iOS5&&(t.enabled=!1),game.device.wp7&&(t.enabled=!1),game.device.android2&&(t.enabled=!1),t.enabled||(t.webAudio=!1),t.webAudio&&!window.AudioContext&&(t.webAudio=!1),t.enabled)for(var e=new window.Audio,i=0;i<t.formats.length;i++)e.canPlayType(t.formats[i].type)&&this.formats.push(t.formats[i].ext);game.device.opera&&t.webAudio&&this.formats.erase("m4a"),0===this.formats.length&&(t.enabled=!1),t.enabled&&t.webAudio&&(this.context=new AudioContext,this.gainNode=this.context.createGain?this.context.createGain():this.context.createGainNode(),this.gainNode.connect(this.context.destination)),this.musicVolume=t.musicVolume,this.soundVolume=t.soundVolume}t.prototype.fadeIn=function(t,e){return this._fade(t,e,1)},t.prototype.fadeOut=function(t,e){return this._fade(t,e,0)},t.prototype.playSound=function(t,e,i,n){var r=this.soundMuted?0:this.soundVolume,o=this._play(t,e,r,i,n);return o&&this.playingSounds.push(o),o},t.prototype.stopSound=function(t,e){if(t)return this._stop(t,!!e);for(var i=this.playingSounds.length-1;i>=0;i--)this._stop(this.playingSounds[i],!!e);return!0},t.prototype.stopSoundByName=function(t,e){for(var i in this._audioObjects)this._audioObjects[i].name===t&&this.stopSound(i,e)},t.prototype.pauseSound=function(t){if(t){var e=this.playingSounds.indexOf(t);if(-1===e)return!1;this._pause(t),this.playingSounds.splice(e,1),this.pausedSounds.push(t)}else{for(var i=this.playingSounds.length-1;i>=0;i--)this._pause(this.playingSounds[i]),this.pausedSounds.push(this.playingSounds[i]);this.playingSounds.length=0}return!0},t.prototype.resumeSound=function(t){var e=this.pausedSounds.indexOf(t);return-1!==e&&(this._resume(t),this.playingSounds.push(t),this.pausedSounds.splice(e,1),!0)},t.prototype.muteSound=function(t){if(t)return this._mute(t);var e;for(this.soundMuted=!0,e=this.playingSounds.length-1;e>=0;e--)this._mute(this.playingSounds[e]);for(e=this.pausedSounds.length-1;e>=0;e--)this._mute(this.pausedSounds[e]);return!0},t.prototype.unmuteSound=function(t){if(t)return this._unmute(t,this.soundVolume);var e;for(this.soundMuted=!1,e=this.playingSounds.length-1;e>=0;e--)this._unmute(this.playingSounds[e],this.soundVolume);for(e=this.pausedSounds.length-1;e>=0;e--)this._unmute(this.pausedSounds[e],this.soundVolume);return!0},t.prototype.playMusic=function(t,e){var i=this.musicMuted?0:this.musicVolume;return void 0===e&&(e=!0),this.currentMusic&&this._stop(this.currentMusic),this.currentMusic=this._play(t,!!e,i),this.currentMusicName=t,this.currentMusic},t.prototype.stopMusic=function(){var t=this._stop(this.currentMusic);return this.currentMusic=null,this.currentMusicName=null,t},t.prototype.pauseMusic=function(){return this._pause(this.currentMusic)},t.prototype.resumeMusic=function(){return this._resume(this.currentMusic)},t.prototype.muteMusic=function(){this.musicMuted=!0,this.currentMusic&&this._mute(this.currentMusic)},t.prototype.unmuteMusic=function(){this.musicMuted=!1,this.currentMusic&&this._unmute(this.currentMusic,this.musicVolume)},t.prototype.setVolume=function(t,e){var i=this._audioObjects[t];return!!i&&void(this.context?i.gainNode.gain.value=e:i.volume=e)},t.prototype.setSoundVolume=function(t){var e;for(this.soundVolume=t,e=this.playingSounds.length-1;e>=0;e--)this.context?this._audioObjects[this.playingSounds[e]].gainNode.gain.value=this.soundVolume:this.playingSounds[e].volume=this.soundVolume;for(e=this.pausedSounds.length-1;e>=0;e--)this.context?this._audioObjects[this.pausedSounds[e]].gainNode.gain.value=this.soundVolume:this.pausedSounds[e].volume=this.soundVolume},t.prototype.setMusicVolume=function(t){this.musicVolume=t,this.currentMusic&&(this.context?this._audioObjects[this.currentMusic].gainNode.gain.value=this.musicVolume:this.currentMusic.volume=this.musicVolume)},t.prototype.setPlaybackRate=function(t,e){if(this.context){var i=this._audioObjects[t];i&&(i.playbackRate.value=e||1)}},t.prototype.isSoundPlaying=function(t){return-1!==this.playingSounds.indexOf(t)},t.prototype.isMusicPlaying=function(){return!!this.currentMusic},t.prototype.toggleSound=function(){return this.soundMuted=!this.soundMuted,this.soundMuted?this.muteSound():this.unmuteSound(),this.soundMuted},t.prototype.toggleMusic=function(){return this.musicMuted=!this.musicMuted,this.musicMuted?this.muteMusic():this.unmuteMusic(),this.musicMuted},t.prototype._decode=function(t,e,i){this.context.decodeAudioData(t.response,this._loaded.bind(this,e,i),this._error.bind(this,e,i))},t.prototype._load=function(t,e){var i=t.split("?").shift().split(".").pop();-1===this.formats.indexOf(i)&&(i=this.formats[0]);var n=t.replace(/[^\.]+$/,i);if(this.context){var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=this._decode.bind(this,r,t,e),r.send()}else{var o=new window.Audio(n);game.device.ie?this._loaded(t,e,o):(o.loadCallback=this._loaded.bind(this,t,e,o),o.addEventListener("canplaythrough",o.loadCallback),o.addEventListener("error",this._error.bind(this,t,e))),o.preload="auto",o.load()}},t.prototype._error=function(t,e){e("Error loading audio "+t)},t.prototype._loaded=function(t,e,i){for(var n in game.paths)if(game.paths[n]===t){var r=n;break}this._sources[r]={audio:i,path:t},this.context||(i.removeEventListener("canplaythrough",i.loadCallback),i.addEventListener("ended",(function(){this.playing=!1}))),"function"==typeof e&&e(t,{isAudio:!0,name:t,url:t})},t.prototype._onended=function(t){var e=this.playingSounds.indexOf(t);-1!==e&&this.playingSounds.splice(e,1),t===this.currentMusic&&(this.currentMusic=null,this.currentMusicName=null);var i=this._audioObjects[t];return!!i&&("function"==typeof i.callback&&i.callback(),delete this._audioObjects[t])},t.prototype._fade=function(t,e,i){var n=this._audioObjects[t];if(!n)return!1;if(e=(e||1e3)/1e3,!this.context)return!1;var r=this.context.currentTime;1===i&&(n.gainNode.gain.value=0);var o=n.gainNode.gain.value;return n.gainNode.gain.linearRampToValueAtTime(o,r),n.gainNode.gain.linearRampToValueAtTime(i,r+e),!0},t.prototype._play=function(e,i,n,r,o,s,a){if(!t.enabled)return!1;if("number"!=typeof a&&(a=this._audioId++),this.context){(u=this.context.createBufferSource()).buffer=this._sources[e].audio,u.loop=!!i,u.playbackRate.value=o||1,u.callback=r,u.onended=this._onended.bind(this,a);var l=this.context.createGain?this.context.createGain():this.context.createGainNode();l.gain.value="number"==typeof n?n:1,l.connect(this.gainNode),u.connect(l),u.gainNode=l;var h=u.start?"start":"noteOn";s?u[h](0,s):u[h](0),u.startTime=this.context.currentTime-(s||0)}else{var u;(u=this._sources[e].audio).volume="number"==typeof n?n:1,u.loop=!!i,u.playing=!0,u.callback=r,u.onended=this._onended.bind(this,a),game.device.ie||(u.currentTime=0),u.play()}return u.name=e,this._audioObjects[a]=u,a},t.prototype._stop=function(t,e){var i=this._audioObjects[t];if(!i)return!1;if(e&&(i.callback=null),this.context){if(i.pauseTime>=0)return!1;"function"==typeof i.stop?i.stop(0):i.noteOff(0)}else i.pause(),i.playing=!1;return!0},t.prototype._pause=function(t){var e=this._audioObjects[t];return!!e&&(this.context?(e.onended=null,"function"==typeof e.stop?e.stop(0):e.noteOff(0),e.pauseTime=(this.context.currentTime-e.startTime)%e.buffer.duration):(e.currentTime>0&&e.currentTime<e.duration||e.loop)&&e.pause(),!0)},t.prototype._resume=function(t){var e=this._audioObjects[t];if(!e)return!1;if(this.context){if(!(e.pauseTime>=0))return!1;var i=this._getNameForAudio(e);this._play(i,e.loop,e.gainNode.gain.value,e.callback,e.playbackRate.value,e.pauseTime,t)}else{if(!e.playing)return!1;e.play()}return!0},t.prototype._mute=function(t){var e=this._audioObjects[t];return!!e&&(this.context?e.gainNode.gain.value=0:e.volume=0,!0)},t.prototype._unmute=function(t,e){var i=this._audioObjects[t];return!!i&&(this.context?i.gainNode.gain.value=e:i.volume=e,!0)},t.prototype._getNameForAudio=function(t){for(var e in this._sources)if(this._sources[e].audio===t.buffer)return e},t.prototype._systemPause=function(){this.pauseMusic();for(var t=this.playingSounds.length-1;t>=0;t--)this._pause(this.playingSounds[t]),this._systemPaused.push(this.playingSounds[t])},t.prototype._systemResume=function(){this.resumeMusic();for(var t=this._systemPaused.length-1;t>=0;t--)this._resume(this._systemPaused[t]);this._systemPaused.length=0},game.addAttributes(t,{enabled:!0,formats:[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"m4a",type:'audio/mp4; codecs="mp4a.40.5"'},{ext:"wav",type:"audio/wav"}],musicVolume:1,soundVolume:1,stopOnSceneChange:!0,webAudio:!0}),game.Audio=t})),game.module("engine.camera").body((function(){function t(){this.acceleration=3,this.anchor=new game.Vector(.5,.5),this.container=null,this.isShaking=!1,this.maxSpeed=200,this.maxX=null,this.maxY=null,this.minX=null,this.minY=null,this.position=new game.Vector,this.rounding=!1,this.rotation=0,this.speed=new game.Vector,this.target=null,this.threshold=1,this.sensor={x:0,y:0,width:200,height:200,anchor:new game.Vector(.5,.5)},this.zoom=new game.Vector(1,1),this._targetLeft=0,this._targetRight=0,this._targetTop=0,this._targetBottom=0,this._sensorLeft=0,this._sensorRight=0,this._sensorTop=0,this._sensorBottom=0,this._shakeOffset=new game.Vector,this._shakeForce=new game.Vector,this._shakeForward=!1,this._shakeDelay=0,this._shakeCount=0,this._startShake=this._startShake.bind(this),game.scene.addObject(this)}t.prototype.addTo=function(t){return this.container||game.scene.addObject(this),this.container=t,this.position.set(game.System.width,game.System.height).multiply(this.anchor),this.sensor.x=.5*(game.System.width-this.sensor.width),this.sensor.y=.5*(game.System.height-this.sensor.height),this},t.prototype.setTarget=function(t,e){this.target=t;var i=t.getBounds();this.sensor.x=i.x+.5*i.width-.5*this.sensor.width,this.sensor.y=i.y+.5*i.height-.5*this.sensor.height,e||this._setPosition(t.position.x,t.position.y)},t.prototype.setPosition=function(t,e){this._setPosition(t,e),this.sensor.x=t-.5*this.sensor.width,this.sensor.y=e-.5*this.sensor.height},t.prototype._setPosition=function(t,e){this.position.set(t,e),"number"==typeof this.minX&&this.position.x<this.minX?(this.position.x=this.minX,this.speed.x=0):"number"==typeof this.maxX&&this.position.x>this.maxX&&(this.position.x=this.maxX,this.speed.x=0),"number"==typeof this.minY&&this.position.y<this.minY?(this.position.y=this.minY,this.speed.y=0):"number"==typeof this.maxY&&this.position.y>this.maxY&&(this.position.y=this.maxY,this.speed.y=0),this.container&&(this.container.position.set(game.System.width,game.System.height).multiply(this.anchor),this.container.pivot.copy(this.position))},t.prototype.shake=function(t,e,i,n){this._shakeForce="number"==typeof t?this._shakeForce.set(t,t):this._shakeForce.set(t.x,t.y),this._shakeDelay=Math.floor(e/i)||20,this._shakeCount=i||3,this._shakeForward=!!n,this._startShake()},t.prototype._startShake=function(){this.isShaking=!0,this._shakeCount>0?(this._shakeForward?(this._shakeOffset.x=Math.random()*this._shakeForce.x,this._shakeOffset.y=Math.random()*this._shakeForce.y):(this._shakeOffset.x=(2*Math.random()-1)*this._shakeForce.x,this._shakeOffset.y=(2*Math.random()-1)*this._shakeForce.y),this._shakeCount-=1,game.scene.addTimer(this._shakeDelay,this._startShake)):(this._shakeOffset.set(0,0),this._setPosition(this.position.x,this.position.y),this.isShaking=!1)},t.prototype.moveSensor=function(){if(this.target){var t=this.target.getLocalBounds();this.sensor.width<t.width&&(this.sensor.width=t.width),this.sensor.height<t.height&&(this.sensor.height=t.height),this._targetLeft=this.target.position.x+t.x,this._targetRight=this._targetLeft+t.width,this._targetTop=this.target.position.y+t.y,this._targetBottom=this._targetTop+t.height,this._sensorLeft=this.sensor.x,this._sensorRight=this.sensor.x+this.sensor.width,this._sensorTop=this.sensor.y,this._sensorBottom=this.sensor.y+this.sensor.height,this._targetLeft<this._sensorLeft?this.sensor.x=this._targetLeft:this._targetRight>this._sensorRight&&(this.sensor.x=this._targetRight-this.sensor.width),this._targetTop<this._sensorTop?this.sensor.y=this._targetTop:this._targetBottom>this._sensorBottom&&(this.sensor.y=this._targetBottom-this.sensor.height)}},t.prototype.moveCamera=function(){this.speed.x=Math.clamp(this.position.x-(this.sensor.x+this.sensor.width*this.sensor.anchor.x),-this.maxSpeed,this.maxSpeed),this.speed.y=Math.clamp(this.position.y-(this.sensor.y+this.sensor.height*this.sensor.anchor.y),-this.maxSpeed,this.maxSpeed),this.speed.x>this.threshold||this.speed.x<-this.threshold||this.speed.y>this.threshold||this.speed.y<-this.threshold?this._setPosition(this.position.x-this.speed.x*this.acceleration*game.system.delta,this.position.y-this.speed.y*this.acceleration*game.system.delta):this.speed.set(0,0),this.isShaking&&this.container&&(this._setPosition(this.position.x,this.position.y),this.container.pivot.subtract(this._shakeOffset))},t.prototype.remove=function(){this.container=null,game.scene.removeObject(this)},t.prototype.update=function(){this.moveSensor(),this.moveCamera(),this.container.scale.set(1/this.zoom.x,1/this.zoom.y),this.container.rotation=-this.rotation},game.Camera=t})),game.module("engine.geometry").body((function(){function t(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}t.prototype.set=function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.add=function(e,i){return this.x+=e instanceof t?e.x:e,this.y+=e instanceof t?e.y:i||(0!==i?e:0),this},t.prototype.subtract=function(e,i){return this.x-=e instanceof t?e.x:e,this.y-=e instanceof t?e.y:i||(0!==i?e:0),this},t.prototype.scale=function(t){return this.x*=t,this.y*=t,this},t.prototype.multiply=function(e,i){return this.x*=e instanceof t?e.x:e,this.y*=e instanceof t?e.y:i,this},t.prototype.divide=function(e,i){return this.x/=e instanceof t?e.x:e,this.y/=e instanceof t?e.y:i,this},t.prototype.distance=function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},t.prototype.squaredDistance=function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},t.prototype.length=function(){return Math.sqrt(this.squaredLength())},t.prototype.squaredLength=function(){return this.x*this.x+this.y*this.y},t.prototype.dot=function(e){return e instanceof t?this.x*e.x+this.y*e.y:this.x*this.x+this.y*this.y},t.prototype.dotNormalized=function(e){var i=this.length(),n=this.x/i,r=this.y/i;if(e instanceof t){var o=e.length();return n*(e.x/o)+r*(e.y/o)}return n*n+r*r},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*e-this.y*i,r=this.y*e+this.x*i;return this.x=n,this.y=r,this},t.prototype.normalize=function(){var t=this.length();return this.x/=t||1,this.y/=t||1,this},t.prototype.limit=function(t){return this.x=this.x.limit(-t.x,t.x),this.y=this.y.limit(-t.y,t.y),this},t.prototype.angle=function(t){return t?Math.atan2(t.y-this.y,t.x-this.x):Math.atan2(this.y,this.x)},t.prototype.angleFromOrigin=function(t){return Math.atan2(t.y,t.x)-Math.atan2(this.y,this.x)},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},game.Vector=t})),game.module("engine.keyboard").body((function(){function t(){this._keysDown=[],window.addEventListener("keydown",this._keydown.bind(this)),window.addEventListener("keyup",this._keyup.bind(this)),window.addEventListener("blur",this._resetKeys.bind(this))}t.prototype.down=function(t){return!!this._keysDown[t]},t.prototype._keydown=function(e){(e.preventDefault(),e.stopPropagation(),t.keys[e.keyCode]||(t.keys[e.keyCode]=e.keyCode),!this._keysDown[t.keys[e.keyCode]]&&(this._keysDown[t.keys[e.keyCode]]=!0,game.scene&&game.scene.keydown))&&(game.scene.keydown(t.keys[e.keyCode],this.down("SHIFT"),this.down("CTRL"),this.down("ALT"))&&e.preventDefault())},t.prototype._keyup=function(e){this._keysDown[t.keys[e.keyCode]]=!1,game.scene&&game.scene.keyup&&game.scene.keyup(game.Keyboard.keys[e.keyCode])},t.prototype._resetKeys=function(){for(var t in this._keysDown)this._keysDown[t]=!1},game.addAttributes(t,{keys:{8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSE",20:"CAPS_LOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",44:"PRINT_SCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"NUM_ZERO",97:"NUM_ONE",98:"NUM_TWO",99:"NUM_THREE",100:"NUM_FOUR",101:"NUM_FIVE",102:"NUM_SIX",103:"NUM_SEVEN",104:"NUM_EIGHT",105:"NUM_NINE",106:"NUM_MULTIPLY",107:"NUM_PLUS",109:"NUM_MINUS",110:"NUM_PERIOD",111:"NUM_DIVISION",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",186:"SEMICOLON",187:"PLUS",189:"MINUS",192:"GRAVE_ACCENT",222:"SINGLE_QUOTE"}}),game.Keyboard=t})),game.module("engine.loader").body((function(){function t(t){this.loaded=0,this.percent=0,this.assetQueue=[],this.audioQueue=[],this.started=!1,this.dynamic=!0,this.callback=null,this.onComplete(t),this.stage=game.system.stage;for(var e=0;e<game.assetQueue.length;e++)game.TextureCache[game.assetQueue[e]]||this.assetQueue.push(this.getPath(game.assetQueue[e]));if(game.assetQueue.length=0,game.Audio.enabled){for(e=0;e<game.audioQueue.length;e++)this.audioQueue.push(game.audioQueue[e]);game.audioQueue.length=0}this.assetQueue.length>0&&(this.loader=game.PIXI.loader.add(this.assetQueue),this.loader.on("progress",this.progress,this),this.loader.on("complete",this.loadAudio,this),this.loader.on("error",this.error,this)),this.assetQueue.length+this.audioQueue.length===0&&(this.percent=100)}t.prototype.initStage=function(){},t.prototype.onComplete=function(t){return("string"==typeof t||game.System.startScene)&&(this.dynamic=!1),this.callback=t,this},t.prototype.start=function(){if(this.started=!0,!this.dynamic){for(var e=this.stage.children.length-1;e>=0;e--)this.stage.removeChild(this.stage.children[e]);game.tweenEngine&&game.tweenEngine.removeAll(),game.system.renderer.backgroundColor=t.bgColor,this.initStage(),game.scene?game.scene=this:this.loopId=game._setGameLoop(this.run.bind(this),game.system.canvas)}this.startTime=Date.now(),this.assetQueue.length>0?this.loader.load():this.audioQueue.length>0?this.loadAudio():this.dynamic&&this.ready()},t.prototype.error=function(t){throw"loading file "+t},t.prototype.progress=function(e,i){i.isJson&&(game.json[e.url]=i.data),i.isImage&&t.isSpriteAtlas(i)||(this.loaded++,this.percent=Math.round(this.loaded/(this.assetQueue.length+this.audioQueue.length)*100),this.onPercentChange()),this.dynamic&&this.loaded===this.assetQueue.length+this.audioQueue.length&&this.ready()},t.prototype.onPercentChange=function(){EXAPI.loading(this.percent)},t.prototype.loadAudio=function(){if(this.audioQueue.length>0)for(var t=this.audioQueue.length-1;t>=0;t--)game.audio._load(this.audioQueue[t],this.progress.bind(this),this.error.bind(this,this.audioQueue[t]));else this.ready()},t.prototype.ready=function(){runGameHelper=function(){if(game.system.hires||game.system.retina)for(var t in game.TextureCache)-1!==t.indexOf("@"+game.scale+"x")&&(game.TextureCache[t.replace("@"+game.scale+"x","")]=game.TextureCache[t],delete game.TextureCache[t]);"function"==typeof this.callback?this.callback():this.setScene()}.bind(this),EXAPI.loaded()},t.prototype.setScene=function(){if(game.system.timer.last=0,game.Timer.time=Number.MIN_VALUE,this.loopId&&game._clearGameLoop(this.loopId),game.System.startScene){var t=game.System.startScene;game.System.startScene=null,game.system.setScene(t)}else game.system.setScene(this.callback)},t.prototype.run=function(t){this.loopId&&(this.last=game.Timer.time,game.Timer.update(t),game.system.delta=(game.Timer.time-this.last)/1e3),this.update(),this.render()},t.prototype.update=function(){if(game.tweenEngine&&game.tweenEngine.update(),!this._ready)if(this.timeoutTimer)this.timeoutTimer.time()>=0&&(this._ready=!0,this.ready());else if(this.loaded===this.assetQueue.length+this.audioQueue.length){var e=Date.now()-this.startTime,i=Math.max(0,t.time-e);this.timeoutTimer=new game.Timer(i)}},t.prototype.render=function(){game.system.renderer.render(this.stage)},t.prototype.getPath=function(t){return game.system.retina||game.system.hires?t.replace(/\.(?=[^.]*$)/,"@"+game.scale+"x."):t};var e="json_image",i="fnt_image";t.isSpriteAtlas=function(t){return t.name.slice(-10)==e||t.name.slice(-9)==i},game.addAttributes(t,{time:200,bgColor:0,barColor:15132648,barBgColor:5332595,barWidth:200,barHeight:20,crossorigin:!1,className:"Loader"}),game.Loader=t})),game.module("engine.particle").body((function(){function t(){this.position=new game.Vector,this.velocity=new game.Vector,this.accel=new game.Vector}function e(t){this.poolName="emitter",this.particles=[],this.textures=[],this.container=null,this.position=new game.Vector,this.positionVar=new game.Vector,this.angle=0,this.angleVar=0,this.speed=100,this.speedVar=0,this.life=2e3,this.lifeVar=0,this.duration=0,this.durationTimer=0,this.rate=100,this.rateTimer=0,this.count=10,this.active=!0,this.velRotate=0,this.velRotateVar=0,this.rotate=0,this.rotateVar=0,this.startAlpha=1,this.endAlpha=1,this.startScale=1,this.startScaleVar=0,this.endScale=1,this.endScaleVar=0,this.target=new game.Vector,this.targetForce=0,this.accelAngle=Math.PI/2,this.accelAngleVar=0,this.accelSpeed=0,this.accelSpeedVar=0,this.spriteSettings={},this.anchor=new game.Vector(.5,.5),this.velocityLimit=new game.Vector,this.callback=null,game.pool.create(this.poolName),game.merge(this,t)}t.prototype.setVeloctity=function(t,e){this.velocity.x=Math.cos(t)*e,this.velocity.y=Math.sin(t)*e},t.prototype.setAccel=function(t,e){this.accel.x=Math.cos(t)*e,this.accel.y=Math.sin(t)*e},game.Particle=t,e.prototype.onComplete=function(t){this.callback=t},e.prototype.reset=function(t){for(var i in this)"number"==typeof this[i]&&(this[i]=e.prototype[i]),this[i]instanceof game.Vector&&t&&this[i].set(0,0)},e.prototype.getVariance=function(t){return Math.random()*t*(Math.random()>.5?-1:1)},e.prototype.addParticle=function(){var e=game.pool.get(this.poolName);e||(e=new t),e.position.x=this.position.x+this.getVariance(this.positionVar.x),e.position.y=this.position.y+this.getVariance(this.positionVar.y);var i=this.getVariance(this.angleVar),n=this.angle+i,r=this.speed+this.getVariance(this.speedVar);e.setVeloctity(n,r),this.angleVar!==this.accelAngleVar&&(i=this.getVariance(this.accelAngleVar)),n=this.accelAngle+i,r=this.accelSpeed+this.getVariance(this.accelSpeedVar),e.setAccel(n,r),e.life=this.life+this.getVariance(this.lifeVar),e.sprite?(e.sprite.texture=this.textures.random(),e.sprite.position.x=e.position.x,e.sprite.position.y=e.position.y,e.sprite.rotation=0):e.sprite=new game.Sprite(this.textures.random(),e.position.x,e.position.y,this.spriteSettings),e.rotate=this.rotate+this.getVariance(this.rotateVar),e.velRotate=this.velRotate+this.getVariance(this.velRotateVar),this.startAlpha!==this.endAlpha?(e.deltaAlpha=this.endAlpha-this.startAlpha,e.deltaAlpha/=e.life/1e3):e.deltaAlpha=0,e.sprite.alpha=this.startAlpha;var o=this.startScale+this.getVariance(this.startScaleVar);this.startScale!==this.endScale?(e.deltaScale=this.endScale+this.getVariance(this.endScaleVar)-o,e.deltaScale/=e.life/1e3):e.deltaScale=0,e.sprite.scale.x=e.sprite.scale.y=o,this.container&&this.container.addChild(e.sprite),this.particles.push(e)},e.prototype.updateParticle=function(t){if(t.life>0&&(t.life-=1e3*game.system.delta,t.life<=0))return this.removeParticle(t);if(this.targetForce>0){t.accel.set(this.target.x-t.position.x,this.target.y-t.position.y);var e=Math.sqrt(t.accel.x*t.accel.x+t.accel.y*t.accel.y);t.accel.x/=e||1,t.accel.y/=e||1,t.accel.x*=this.targetForce,t.accel.y*=this.targetForce}if(t.velocity.x+=t.accel.x*game.system.delta,t.velocity.y+=t.accel.y*game.system.delta,(this.velocityLimit.x>0||this.velocityLimit.y>0)&&(t.velocity.x=t.velocity.x.limit(-this.velocityLimit.x,this.velocityLimit.x),t.velocity.y=t.velocity.y.limit(-this.velocityLimit.y,this.velocityLimit.y)),t.velRotate){var i=Math.cos(t.velRotate*game.system.delta),n=Math.sin(t.velRotate*game.system.delta),r=t.velocity.x*i-t.velocity.y*n,o=t.velocity.y*i+t.velocity.x*n;t.velocity.set(r,o)}t.position.x+=t.velocity.x*game.scale*game.system.delta,t.position.y+=t.velocity.y*game.scale*game.system.delta,t.deltaAlpha&&(t.sprite.alpha=Math.max(0,t.sprite.alpha+t.deltaAlpha*game.system.delta)),t.deltaScale&&(t.sprite.scale.x=t.sprite.scale.y+=t.deltaScale*game.system.delta),t.sprite.rotation+=t.rotate*game.system.delta,t.sprite.position.x=t.position.x,t.sprite.position.y=t.position.y},e.prototype.removeParticle=function(t){t.sprite.parent&&t.sprite.parent.removeChild(t.sprite),game.pool.put(this.poolName,t),this.particles.erase(t)},e.prototype.emit=function(t){t=t||1;for(var e=0;t>e;e++)this.addParticle()},e.prototype._update=function(){if(this._remove)for(var t=this.particles.length-1;t>=0;t--)this.removeParticle(this.particles[t]);else{this.durationTimer+=1e3*game.system.delta,this.duration>0&&(this.active=this.durationTimer<this.duration,this.active||0!==this.particles.length||"function"!=typeof this.callback||(this.callback(),this.callback=null)),this.rate&&this.active&&(this.rateTimer+=1e3*game.system.delta,this.rateTimer>=this.rate&&(this.rateTimer=0,this.emit(this.count)));for(t=this.particles.length-1;t>=0;t--)this.updateParticle(this.particles[t])}},e.prototype.remove=function(){this._remove=!0},e.prototype.addTo=function(t){this.container=t},game.Emitter=e})),game.module("engine.physics").require("engine.geometry").body((function(){function t(t,i){this.gravity=null,this.solver=null,this.bodies=[],this.collisionGroups={},t="number"==typeof t?t:0,i="number"==typeof i?i:980,this.gravity=new game.Vector(t,i),this.solver=new e}function e(){}function i(t){this.world=null,this.shape=null,this.position=new game.Vector,this.last=new game.Vector,this.velocity=new game.Vector,this.velocityLimit=new game.Vector,this.mass=0,this.collisionGroup=null,this.collideAgainst=[],this.force=new game.Vector,this.damping=0,this._collides=[],game.merge(this,t)}t.prototype.addBody=function(t){t.world=this,t._remove=!1,this.bodies.push(t),this.addBodyCollision(t)},t.prototype.removeBody=function(t){t.world&&(t.world=null,t._remove=!0)},t.prototype.addBodyCollision=function(t){"number"==typeof t.collisionGroup&&(this.collisionGroups[t.collisionGroup]=this.collisionGroups[t.collisionGroup]||[],-1===this.collisionGroups[t.collisionGroup].indexOf(t)&&this.collisionGroups[t.collisionGroup].push(t))},t.prototype.removeBodyCollision=function(t){"number"==typeof t.collisionGroup&&this.collisionGroups[t.collisionGroup]&&-1!==this.collisionGroups[t.collisionGroup].indexOf(t)&&this.collisionGroups[t.collisionGroup].erase(t)},t.prototype.collide=function(t){var e,i,n,r;for(e=0;e<t.collideAgainst.length;e++)if(t._collides.length=0,r=this.collisionGroups[t.collideAgainst[e]]){for(i=r.length-1;i>=0&&r;i--)t!==(n=r[i])&&this.solver.hitTest(t,n)&&t._collides.push(n);for(i=t._collides.length-1;i>=0;i--)this.solver.hitResponse(t,t._collides[i])&&t.afterCollide(t._collides[i])}},t.prototype._update=function(){var t,e;for(t=this.bodies.length-1;t>=0;t--)this.bodies[t]._remove?(this.removeBodyCollision(this.bodies[t]),this.bodies.splice(t,1)):this.bodies[t].update();for(t in this.collisionGroups)if(0!==this.collisionGroups[t].length)for(e=this.collisionGroups[t].length-1;e>=0;e--)this.collisionGroups[t][e]&&this.collisionGroups[t][e].collideAgainst.length>0&&this.collide(this.collisionGroups[t][e]);else delete this.collisionGroups[t]},game.World=t,e.prototype.hitTest=function(t,e){if(t.shape.width&&e.shape.width)return!(t.position.y+t.shape.height/2<=e.position.y-e.shape.height/2||t.position.y-t.shape.height/2>=e.position.y+e.shape.height/2||t.position.x-t.shape.width/2>=e.position.x+e.shape.width/2||t.position.x+t.shape.width/2<=e.position.x-e.shape.width/2);if(t.shape.radius&&e.shape.radius)return t.shape.radius+e.shape.radius>t.position.distance(e.position);if(t.shape.width&&e.shape.radius||t.shape.radius&&e.shape.width){var i=t.shape.width?t:e,n=t.shape.radius?t:e,r=Math.max(i.position.x-i.shape.width/2,Math.min(i.position.x+i.shape.width/2,n.position.x)),o=Math.max(i.position.y-i.shape.height/2,Math.min(i.position.y+i.shape.height/2,n.position.y));return Math.pow(n.position.x-r,2)+Math.pow(n.position.y-o,2)<n.shape.radius*n.shape.radius}return!1},e.prototype.hitResponse=function(t,e){if(t.shape.width&&e.shape.width){if(t.last.y+t.shape.height/2<=e.last.y-e.shape.height/2){if(t.collide(e,"DOWN"))return t.position.y=e.position.y-e.shape.height/2-t.shape.height/2,!0}else if(t.last.y-t.shape.height/2>=e.last.y+e.shape.height/2){if(t.collide(e,"UP"))return t.position.y=e.position.y+e.shape.height/2+t.shape.height/2,!0}else if(t.last.x+t.shape.width/2<=e.last.x-e.shape.width/2){if(t.collide(e,"RIGHT"))return t.position.x=e.position.x-e.shape.width/2-t.shape.width/2,!0}else if(t.last.x-t.shape.width/2>=e.last.x+e.shape.width/2){if(t.collide(e,"LEFT"))return t.position.x=e.position.x+e.shape.width/2+t.shape.width/2,!0}else if(t.collide(e))return!0}else if(t.shape.radius&&e.shape.radius){var i=e.position.angle(t.position);if(t.collide(e,i)){var n=t.shape.radius+e.shape.radius;return t.position.x=e.position.x+Math.cos(i)*n,t.position.y=e.position.y+Math.sin(i)*n,!0}}},game.CollisionSolver=e,i.prototype.addShape=function(t){return this.shape=t,this},i.prototype.collide=function(){return!0},i.prototype.afterCollide=function(){},i.prototype.setCollisionGroup=function(t){this.world&&"number"==typeof this.collisionGroup&&this.world.removeBodyCollision(this),this.collisionGroup=t,this.world&&this.world.addBodyCollision(this)},i.prototype.setCollideAgainst=function(){this.collideAgainst.length=0;for(var t=0;t<arguments.length;t++)this.collideAgainst.push(arguments[t])},i.prototype.addTo=function(t){return this.world?void 0:(t.addBody(this),this)},i.prototype.remove=function(){this.world&&this.world.removeBody(this)},i.prototype.removeCollision=function(){this.world&&this.world.removeBodyCollision(this)},i.prototype.update=function(){this.last.copy(this.position),0!==this.mass&&this.velocity.add(this.world.gravity.x*this.mass*game.system.delta,this.world.gravity.y*this.mass*game.system.delta),this.velocity.add(this.force.x*game.system.delta,this.force.y*game.system.delta),this.damping>0&&this.damping<1&&this.velocity.scale(Math.pow(1-this.damping,game.system.delta)),this.velocityLimit.x>0&&(this.velocity.x=this.velocity.x.limit(-this.velocityLimit.x,this.velocityLimit.x)),this.velocityLimit.y>0&&(this.velocity.y=this.velocity.y.limit(-this.velocityLimit.y,this.velocityLimit.y)),this.position.add(this.velocity.x*game.system.delta,this.velocity.y*game.system.delta)},game.Body=i,game.Rectangle=function(t,e){this.width=t||50,this.height=e||50},game.Circle=function(t){this.radius=t||50}})),game.module("engine.pixi").require("engine.geometry").body((function(){!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{(void 0!==game?game:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}}((function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[s]={exports:{}};e[s][0].call(u.exports,(function(t){var i=e[s][1][t];return r(i||t)}),u,u.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){(function(t,i){!function(){function n(){}function r(t){return t}function o(t){return!!t}function s(t){return!t}function a(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function l(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}function h(t){return I(t)||"number"==typeof t.length&&t.length>=0&&t.length%1==0}function u(t,e){for(var i=-1,n=t.length;++i<n;)e(t[i],i,t)}function c(t,e){for(var i=-1,n=t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}function d(t){return c(Array(t),(function(t,e){return e}))}function p(t,e){u(N(t),(function(i){e(t[i],i)}))}function f(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}function m(t){var e,i,n=-1;return h(t)?(e=t.length,function(){return n++,e>n?n:null}):(i=N(t),e=i.length,function(){return n++,e>n?i[n]:null})}function g(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),r=0;i>r;r++)n[r]=arguments[r+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n)}}}function v(t){return function(e,i,n){return t(e,n)}}function y(t){return function(e,i,r){r=l(r||n);var o=m(e=e||[]);if(0>=t)return r(null);var s=!1,h=0,u=!1;!function n(){if(s&&0>=h)return r(null);for(;t>h&&!u;){var l=o();if(null===l)return s=!0,void(0>=h&&r(null));h+=1,i(e[l],l,a((function(t){h-=1,t?(r(t),u=!0):n()})))}}()}}function b(t){return function(e,i,n){return t(G.eachOf,e,i,n)}}function _(t){return function(e,i,n,r){return t(y(i),e,n,r)}}function x(t){return function(e,i,n){return t(G.eachOfSeries,e,i,n)}}function w(t,e,i,r){r=l(r||n);var o=[];t(e,(function(t,e,n){i(t,(function(t,i){o[e]=i,n(t)}))}),(function(t){r(t,o)}))}function T(t,e,i,n){var r=[];t(e,(function(t,e,n){i(t,(function(i){i&&r.push({index:e,value:t}),n()}))}),(function(){n(c(r.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))}function S(t,e,i,n){T(t,e,(function(t,e){i(t,(function(t){e(!t)}))}),n)}function E(t,e,i){return function(n,r,o,s){function a(){s&&s(i(!1,void 0))}function l(t,n,r){return s?void o(t,(function(n){s&&e(n)&&(s(i(!0,t)),s=o=!1),r()})):r()}arguments.length>3?t(n,r,l,a):(s=o,o=r,t(n,l,a))}}function C(t,e){return e}function A(t,e,i){i=i||n;var r=h(e)?[]:{};t(e,(function(t,e,i){t(g((function(t,n){n.length<=1&&(n=n[0]),r[e]=n,i(t)})))}),(function(t){i(t,r)}))}function j(t,e,i,n){var r=[];t(e,(function(t,e,n){i(t,(function(t,e){r=r.concat(e||[]),n(t)}))}),(function(t){n(t,r)}))}function R(t,e,i){function r(t,e,i,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return t.started=!0,I(e)||(e=[e]),0===e.length&&t.idle()?G.setImmediate((function(){t.drain()})):(u(e,(function(e){var o={data:e,callback:r||n};i?t.tasks.unshift(o):t.tasks.push(o),t.tasks.length===t.concurrency&&t.saturated()})),void G.setImmediate(t.process))}function o(t,e){return function(){s-=1;var i=arguments;u(e,(function(t){t.callback.apply(t,i)})),t.tasks.length+s===0&&t.drain(),t.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=0,l={tasks:[],concurrency:e,payload:i,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function(t,e){r(l,t,!1,e)},kill:function(){l.drain=n,l.tasks=[]},unshift:function(t,e){r(l,t,!0,e)},process:function(){if(!l.paused&&s<l.concurrency&&l.tasks.length)for(;s<l.concurrency&&l.tasks.length;){var e=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),i=c(e,(function(t){return t.data}));0===l.tasks.length&&l.empty(),s+=1;var n=a(o(l,e));t(i,n)}},length:function(){return l.tasks.length},running:function(){return s},idle:function(){return l.tasks.length+s===0},pause:function(){l.paused=!0},resume:function(){if(!1!==l.paused){l.paused=!1;for(var t=Math.min(l.concurrency,l.tasks.length),e=1;t>=e;e++)G.setImmediate(l.process)}}};return l}function M(t){return g((function(e,i){e.apply(null,i.concat([g((function(e,i){"object"==typeof console&&(e?console.error:console[t]&&u(i,(function(t){})))}))]))}))}function O(t){return function(e,i,n){t(d(e),i,n)}}function D(t){return g((function(e,i){var n=g((function(i){var n=this,r=i.pop();return t(e,(function(t,e,r){t.apply(n,i.concat([r]))}),r)}));return i.length?n.apply(this,i):n}))}function P(t){return g((function(e){var i=e.pop();e.push((function(){var t=arguments;n?G.setImmediate((function(){i.apply(null,t)})):i.apply(null,t)}));var n=!0;t.apply(this,e),n=!1}))}var F,G={},L="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i||this;null!=L&&(F=L.async),G.noConflict=function(){return L.async=F,G};var B=Object.prototype.toString,I=Array.isArray||function(t){return"[object Array]"===B.call(t)},N=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},k="function"==typeof setImmediate&&setImmediate,U=k?function(t){k(t)}:function(t){setTimeout(t,0)};"object"==typeof t&&"function"==typeof t.nextTick?G.nextTick=t.nextTick:G.nextTick=U,G.setImmediate=k?U:G.nextTick,G.forEach=G.each=function(t,e,i){return G.eachOf(t,v(e),i)},G.forEachSeries=G.eachSeries=function(t,e,i){return G.eachOfSeries(t,v(e),i)},G.forEachLimit=G.eachLimit=function(t,e,i,n){return y(e)(t,v(i),n)},G.forEachOf=G.eachOf=function(t,e,i){function r(t){t?i(t):(s+=1)>=o&&i(null)}i=l(i||n);var o=h(t=t||[])?t.length:N(t).length,s=0;return o?void function(t,e){h(t)?u(t,e):p(t,e)}(t,(function(i,n){e(t[n],n,a(r))})):i(null)},G.forEachOfSeries=G.eachOfSeries=function(t,e,i){i=l(i||n);var r=m(t=t||[]),o=r();!function n(){var s=!0;return null===o?i(null):(e(t[o],o,a((function(t){if(t)i(t);else{if(null===(o=r()))return i(null);s?G.nextTick(n):n()}}))),void(s=!1))}()},G.forEachOfLimit=G.eachOfLimit=function(t,e,i,n){y(e)(t,i,n)},G.map=b(w),G.mapSeries=x(w),G.mapLimit=_(w),G.inject=G.foldl=G.reduce=function(t,e,i,n){G.eachOfSeries(t,(function(t,n,r){i(e,t,(function(t,i){e=i,r(t)}))}),(function(t){n(t||null,e)}))},G.foldr=G.reduceRight=function(t,e,i,n){var o=c(t,r).reverse();G.reduce(o,e,i,n)},G.select=G.filter=b(T),G.selectLimit=G.filterLimit=_(T),G.selectSeries=G.filterSeries=x(T),G.reject=b(S),G.rejectLimit=_(S),G.rejectSeries=x(S),G.any=G.some=E(G.eachOf,o,r),G.someLimit=E(G.eachOfLimit,o,r),G.all=G.every=E(G.eachOf,s,s),G.everyLimit=E(G.eachOfLimit,s,s),G.detect=E(G.eachOf,r,C),G.detectSeries=E(G.eachOfSeries,r,C),G.detectLimit=E(G.eachOfLimit,r,C),G.sortBy=function(t,e,i){function n(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0}G.map(t,(function(t,i){e(t,(function(e,n){e?i(e):i(null,{value:t,criteria:n})}))}),(function(t,e){return t?i(t):void i(null,c(e.sort(n),(function(t){return t.value})))}))},G.auto=function(t,e){function i(t){h.unshift(t)}function r(){s--,u(h.slice(0),(function(t){t()}))}e=l(e||n);var o=N(t),s=o.length;if(!s)return e(null);var a={},h=[];i((function(){s||e(null,a)})),u(o,(function(n){function o(){return t=function(t,e){return t&&a.hasOwnProperty(e)},e=!0,u(d,(function(i,n,r){e=t(e,i,n,r)})),e&&!a.hasOwnProperty(n);var t,e}for(var s,l=I(t[n])?t[n]:[t[n]],c=g((function(t,i){if(i.length<=1&&(i=i[0]),t){var o={};p(a,(function(t,e){o[e]=t})),o[n]=i,e(t,o)}else a[n]=i,G.setImmediate(r)})),d=l.slice(0,l.length-1),m=d.length;m--;){if(!(s=t[d[m]]))throw new Error("Has inexistant dependency");if(I(s)&&f(s,n)>=0)throw new Error("Has cyclic dependencies")}o()?l[l.length-1](c,a):i((function t(){var e;o()&&((e=f(h,t))>=0&&h.splice(e,1),l[l.length-1](c,a))}))}))},G.retry=function(t,e,i){function n(t,e){function i(t,i){return function(n){t((function(t,e){n(!t||i,{err:t,result:e})}),e)}}function n(t){return function(e){setTimeout((function(){e(null)}),t)}}for(;a.times;){var r=!(a.times-=1);s.push(i(a.task,r)),!r&&a.interval>0&&s.push(n(a.interval))}G.series(s,(function(e,i){i=i[i.length-1],(t||a.callback)(i.err,i.result)}))}var r=5,o=0,s=[],a={times:r,interval:o},l=arguments.length;if(1>l||l>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=l&&"function"==typeof t&&(i=e,e=t),"function"!=typeof t&&function(t,e){if("number"==typeof e)t.times=parseInt(e,10)||r;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||r,t.interval=parseInt(e.interval,10)||o}}(a,t),a.callback=i,a.task=e,a.callback?n():n},G.waterfall=function(t,e){if(e=l(e||n),!I(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}return t.length?void function t(i){return g((function(n,r){if(n)e.apply(null,[n].concat(r));else{var o=i.next();o?r.push(t(o)):r.push(e),P(i).apply(null,r)}}))}(G.iterator(t))():e()},G.parallel=function(t,e){A(G.eachOf,t,e)},G.parallelLimit=function(t,e,i){A(y(e),t,i)},G.series=function(t,e){A(G.eachOfSeries,t,e)},G.iterator=function(t){return function e(i){function n(){return t.length&&t[i].apply(null,arguments),n.next()}return n.next=function(){return i<t.length-1?e(i+1):null},n}(0)},G.apply=g((function(t,e){return g((function(i){return t.apply(null,e.concat(i))}))})),G.concat=b(j),G.concatSeries=x(j),G.whilst=function(t,e,i){if(i=i||n,t()){var r=g((function(n,o){n?i(n):t.apply(this,o)?e(r):i(null)}));e(r)}else i(null)},G.doWhilst=function(t,e,i){var n=0;return G.whilst((function(){return++n<=1||e.apply(this,arguments)}),t,i)},G.until=function(t,e,i){return G.whilst((function(){return!t.apply(this,arguments)}),e,i)},G.doUntil=function(t,e,i){return G.doWhilst(t,(function(){return!e.apply(this,arguments)}),i)},G.during=function(t,e,i){i=i||n;var r=g((function(e,n){e?i(e):(n.push(o),t.apply(this,n))})),o=function(t,n){t?i(t):n?e(r):i(null)};t(o)},G.doDuring=function(t,e,i){var n=0;G.during((function(t){n++<1?t(null,!0):e.apply(this,arguments)}),t,i)},G.queue=function(t,e){return R((function(e,i){t(e[0],i)}),e,1)},G.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}var r=G.queue(t,e);return r.push=function(t,e,o){!function(t,e,r,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");t.started=!0,I(e)||(e=[e]),0===e.length?G.setImmediate((function(){t.drain()})):u(e,(function(e){var s={data:e,priority:r,callback:"function"==typeof o?o:n};t.tasks.splice(function(t,e,i){for(var n=-1,r=t.length-1;r>n;){var o=n+(r-n+1>>>1);i(e,t[o])>=0?n=o:r=o-1}return n}(t.tasks,s,i)+1,0,s),t.tasks.length===t.concurrency&&t.saturated(),G.setImmediate(t.process)}))}(r,t,e,o)},delete r.unshift,r},G.cargo=function(t,e){return R(t,1,e)},G.log=M("log"),G.dir=M("dir"),G.memoize=function(t,e){var i={},n={};e=e||r;var o=g((function(r){var o=r.pop(),s=e.apply(null,r);s in i?G.nextTick((function(){o.apply(null,i[s])})):s in n?n[s].push(o):(n[s]=[o],t.apply(null,r.concat([g((function(t){i[s]=t;var e=n[s];delete n[s];for(var r=0,o=e.length;o>r;r++)e[r].apply(null,t)}))])))}));return o.memo=i,o.unmemoized=t,o},G.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},G.times=O(G.map),G.timesSeries=O(G.mapSeries),G.timesLimit=function(t,e,i,n){return G.mapLimit(d(t),e,i,n)},G.seq=function(){var t=arguments;return g((function(e){var i=this,r=e[e.length-1];"function"==typeof r?e.pop():r=n,G.reduce(t,e,(function(t,e,n){e.apply(i,t.concat([g((function(t,e){n(t,e)}))]))}),(function(t,e){r.apply(i,[t].concat(e))}))}))},G.compose=function(){return G.seq.apply(null,Array.prototype.reverse.call(arguments))},G.applyEach=D(G.eachOf),G.applyEachSeries=D(G.eachOfSeries),G.forever=function(t,e){var i=a(e||n),r=P(t);!function t(e){return e?i(e):void r(t)}()},G.ensureAsync=P,G.constant=g((function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}})),G.wrapSync=G.asyncify=function(t){return g((function(e){var i,n,r,o=e.pop();try{i=t.apply(this,e)}catch(t){return o(t)}("function"===(r=typeof(n=i))||"object"===r&&n)&&"function"==typeof i.then?i.then((function(t){o(null,t)})).catch((function(t){o(t.message?t:new Error(t))})):o(null,i)}))},"object"==typeof e&&e.exports?e.exports=G:L.async=G}()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],2:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};i.resolve=function(){for(var i="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(i=s+"/"+i,r="/"===s.charAt(0))}return(r?"/":"")+(i=e(n(i.split("/"),(function(t){return!!t})),!r).join("/"))||"."},i.normalize=function(t){var r=i.isAbsolute(t),o="/"===s(t,-1);return(t=e(n(t.split("/"),(function(t){return!!t})),!r).join("/"))||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(n(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var r=n(t.split("/")),o=n(e.split("/")),s=Math.min(r.length,o.length),a=s,l=0;s>l;l++)if(r[l]!==o[l]){a=l;break}var h=[];for(l=a;l<r.length;l++)h.push("..");return(h=h.concat(o.slice(a))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=o(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=o(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:3}],3:[function(t,e,i){function n(){u=!1,a.length?h=a.concat(h):c=-1,h.length&&r()}function r(){if(!u){var t=setTimeout(n);u=!0;for(var e=h.length;e;){for(a=h,h=[];++c<e;)a&&a[c].run();c=-1,e=h.length}a=null,u=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,l=e.exports={},h=[],u=!1,c=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new o(t,e)),1!==h.length||u||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=s,l.addListener=s,l.once=s,l.off=s,l.removeListener=s,l.removeAllListeners=s,l.emit=s,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],4:[function(t,e,i){(function(t){!function(n){function r(t){throw RangeError(M[t])}function o(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function s(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+o((t=t.replace(R,".")).split("."),e).join(".")}function a(t){for(var e,i,n=[],r=0,o=t.length;o>r;)(e=t.charCodeAt(r++))>=55296&&56319>=e&&o>r?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function l(t){return o(t,(function(t){var e="";return t>65535&&(e+=P((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+P(t)})).join("")}function h(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function u(t,e,i){var n=0;for(t=i?D(t/T):t>>1,t+=D(t/e);t>O*x>>1;n+=b)t=D(t/O);return D(n+(O+1)*t/(t+w))}function c(t){var e,i,n,o,s,a,h,c,d,p,f,m=[],g=t.length,v=0,w=E,T=S;for(0>(i=t.lastIndexOf(C))&&(i=0),n=0;i>n;++n)t.charCodeAt(n)>=128&&r("not-basic"),m.push(t.charCodeAt(n));for(o=i>0?i+1:0;g>o;){for(s=v,a=1,h=b;o>=g&&r("invalid-input"),((c=10>(f=t.charCodeAt(o++))-48?f-22:26>f-65?f-65:26>f-97?f-97:b)>=b||c>D((y-v)/a))&&r("overflow"),v+=c*a,!((d=T>=h?_:h>=T+x?x:h-T)>c);h+=b)a>D(y/(p=b-d))&&r("overflow"),a*=p;T=u(v-s,e=m.length+1,0==s),D(v/e)>y-w&&r("overflow"),w+=D(v/e),v%=e,m.splice(v++,0,w)}return l(m)}function d(t){var e,i,n,o,s,l,c,d,p,f,m,g,v,w,T,A=[];for(g=(t=a(t)).length,e=E,i=0,s=S,l=0;g>l;++l)128>(m=t[l])&&A.push(P(m));for(n=o=A.length,o&&A.push(C);g>n;){for(c=y,l=0;g>l;++l)(m=t[l])>=e&&c>m&&(c=m);for(c-e>D((y-i)/(v=n+1))&&r("overflow"),i+=(c-e)*v,e=c,l=0;g>l;++l)if(e>(m=t[l])&&++i>y&&r("overflow"),m==e){for(d=i,p=b;!((f=s>=p?_:p>=s+x?x:p-s)>d);p+=b)T=d-f,w=b-f,A.push(P(h(f+T%w,0))),d=D(T/w);A.push(P(h(d,0))),s=u(i,v,n==o),i=0,++n}++i,++e}return A.join("")}var p="object"==typeof i&&i&&!i.nodeType&&i,f="object"==typeof e&&e&&!e.nodeType&&e,m="object"==typeof t&&t;(m.global===m||m.window===m||m.self===m)&&(n=m);var g,v,y=2147483647,b=36,_=1,x=26,w=38,T=700,S=72,E=128,C="-",A=/^xn--/,j=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=b-_,D=Math.floor,P=String.fromCharCode;if(g={version:"1.3.2",ucs2:{decode:a,encode:l},decode:c,encode:d,toASCII:function(t){return s(t,(function(t){return j.test(t)?"xn--"+d(t):t}))},toUnicode:function(t){return s(t,(function(t){return A.test(t)?c(t.slice(4).toLowerCase()):t}))}},p&&f)if(e.exports==p)f.exports=g;else for(v in g)g.hasOwnProperty(v)&&(p[v]=g[v]);else n.punycode=g}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,i){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,o){e=e||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var h=t.length;l>0&&h>l&&(h=l);for(var u=0;h>u;++u){var c,d,p,f,m=t[u].replace(a,"%20"),g=m.indexOf(i);g>=0?(c=m.substr(0,g),d=m.substr(g+1)):(c=m,d=""),p=decodeURIComponent(c),f=decodeURIComponent(d),n(s,p)?r(s[p])?s[p].push(f):s[p]=[s[p],f]:s[p]=f}return s};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],6:[function(t,e,i){function n(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),(function(s){var a=encodeURIComponent(r(s))+i;return o(t[s])?n(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+i+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],7:[function(t,e,i){i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":5,"./encode":6}],8:[function(t,e,i){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(t,e,i){if(t&&s(t)&&t instanceof n)return t;var r=new n;return r.parse(t,e,i),r}function o(t){return"string"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return null===t}var l=t("punycode");i.parse=r,i.resolve=function(t,e){return r(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?r(t,!1,!0).resolveObject(e):e},i.format=function(t){return o(t)&&(t=r(t)),t instanceof n?t.format():n.prototype.format.call(t)},i.Url=n;var h=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),p=["%","/","?",";","#"].concat(d),f=["/","?","#"],m=/^[a-z0-9A-Z_-]{0,63}$/,g=/^([a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=t("querystring");n.prototype.parse=function(t,e,i){if(!o(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t;n=n.trim();var r=h.exec(n);if(r){var s=(r=r[0]).toLowerCase();this.protocol=s,n=n.substr(r.length)}if(i||r||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===n.substr(0,2);!a||r&&y[r]||(n=n.substr(2),this.slashes=!0)}if(!y[r]&&(a||r&&!b[r])){for(var u=-1,c=0;c<f.length;c++){-1!==(T=n.indexOf(f[c]))&&(-1===u||u>T)&&(u=T)}var x,w;-1!==(w=-1===u?n.lastIndexOf("@"):n.lastIndexOf("@",u))&&(x=n.slice(0,w),n=n.slice(w+1),this.auth=decodeURIComponent(x)),u=-1;for(c=0;c<p.length;c++){var T;-1!==(T=n.indexOf(p[c]))&&(-1===u||u>T)&&(u=T)}-1===u&&(u=n.length),this.host=n.slice(0,u),n=n.slice(u),this.parseHost(),this.hostname=this.hostname||"";var S="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!S)for(var E=this.hostname.split(/\./),C=(c=0,E.length);C>c;c++){var A=E[c];if(A&&!A.match(m)){for(var j="",R=0,M=A.length;M>R;R++)j+=A.charCodeAt(R)>127?"x":A[R];if(!j.match(m)){var O=E.slice(0,c),D=E.slice(c+1),P=A.match(g);P&&(O.push(P[1]),D.unshift(P[2])),D.length&&(n="/"+D.join(".")+n),this.hostname=O.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!S){var F=this.hostname.split("."),G=[];for(c=0;c<F.length;++c){var L=F[c];G.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+l.encode(L):L)}this.hostname=G.join(".")}var B=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+B,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!v[s])for(c=0,C=d.length;C>c;c++){var N=d[c],k=encodeURIComponent(N);k===N&&(k=escape(N)),n=n.split(N).join(k)}var U=n.indexOf("#");-1!==U&&(this.hash=n.substr(U),n=n.slice(0,U));var V=n.indexOf("?");if(-1!==V?(this.search=n.substr(V),this.query=n.substr(V+1),e&&(this.query=_.parse(this.query)),n=n.slice(0,V)):e&&(this.search="",this.query={}),n&&(this.pathname=n),b[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"",L=this.search||"";this.path=B+L}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||b[e])&&!1!==r?(r="//"+(r||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):r||(r=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+r+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+n},n.prototype.resolve=function(t){return this.resolveObject(r(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(o(t)){var e=new n;e.parse(t,!1,!0),t=e}var i=new n;if(Object.keys(this).forEach((function(t){i[t]=this[t]}),this),i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol)return Object.keys(t).forEach((function(e){"protocol"!==e&&(i[e]=t[e])})),b[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(t.protocol&&t.protocol!==i.protocol){if(!b[t.protocol])return Object.keys(t).forEach((function(e){i[e]=t[e]})),i.href=i.format(),i;if(i.protocol=t.protocol,t.host||y[t.protocol])i.pathname=t.pathname;else{for(var r=(t.pathname||"").split("/");r.length&&!(t.host=r.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),i.pathname=r.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var s=i.pathname||"",l=i.search||"";i.path=s+l}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var h=i.pathname&&"/"===i.pathname.charAt(0),u=t.host||t.pathname&&"/"===t.pathname.charAt(0),c=u||h||i.host&&t.pathname,d=c,p=i.pathname&&i.pathname.split("/")||[],f=(r=t.pathname&&t.pathname.split("/")||[],i.protocol&&!b[i.protocol]);if(f&&(i.hostname="",i.port=null,i.host&&(""===p[0]?p[0]=i.host:p.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===r[0]?r[0]=t.host:r.unshift(t.host)),t.host=null),c=c&&(""===r[0]||""===p[0])),u)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,p=r;else if(r.length)p||(p=[]),p.pop(),p=p.concat(r),i.search=t.search,i.query=t.query;else if(null!=t.search){if(f)i.hostname=i.host=p.shift(),(x=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=x.shift(),i.host=i.hostname=x.shift());return i.search=t.search,i.query=t.query,a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!p.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var m=p.slice(-1)[0],g=(i.host||t.host)&&("."===m||".."===m)||""===m,v=0,_=p.length;_>=0;_--)"."==(m=p[_])?p.splice(_,1):".."===m?(p.splice(_,1),v++):v&&(p.splice(_,1),v--);if(!c&&!d)for(;v--;v)p.unshift("..");!c||""===p[0]||p[0]&&"/"===p[0].charAt(0)||p.unshift(""),g&&"/"!==p.join("/").substr(-1)&&p.push("");var x,w=""===p[0]||p[0]&&"/"===p[0].charAt(0);f&&(i.hostname=i.host=w?"":p.length?p.shift():"",(x=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=x.shift(),i.host=i.hostname=x.shift()));return(c=c||i.host&&p.length)&&!w&&p.unshift(""),p.length?i.pathname=p.join("/"):(i.pathname=null,i.path=null),a(i.pathname)&&a(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:4,querystring:7}],9:[function(t,e,i){function n(t,e,i,n,r){var o,s,a,l=0;for(o=e,s=i-n;i>o;o+=n)l+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;if(r===l>0)for(o=e;i>o;o+=n)a=y(o,a);else for(o=i-n;o>=e;o-=n)a=y(o,a);return a}function r(t,e,i){i||(i=e);var n,r=e;do{if(n=!1,r.steiner||!f(t,r.i,r.next.i)&&0!==p(t,r.prev.i,r.i,r.next.i))r=r.next;else{if(r.prev.next=r.next,r.next.prev=r.prev,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ),(r=i=r.prev)===r.next)return null;n=!0}}while(n||r!==i);return i}function o(t,e,i,n,h,c,d,p){if(e){p||void 0===h||function(t,e,i,n,r){var o=e;do{null===o.z&&(o.z=u(t[o.i],t[o.i+1],i,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,i,n,r,o,s,a,l,h=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,n=i,a=0,e=0;h>e&&(a++,n=n.nextZ);e++);for(l=h;a>0||l>0&&n;)0===a?(r=n,n=n.nextZ,l--):0!==l&&n?i.z<=n.z?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--):(r=i,i=i.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,h*=2}while(s>1)}(o)}(t,e,h,c,d);for(var f,m,g=e;e.prev!==e.next;)if(f=e.prev,m=e.next,s(t,e,h,c,d))i.push(f.i/n),i.push(e.i/n),i.push(m.i/n),m.prev=f,f.next=m,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ),e=m.next,g=m.next;else if((e=m)===g){p?1===p?o(t,e=a(t,e,i,n),i,n,h,c,d,2):2===p&&l(t,e,i,n,h,c,d):o(t,r(t,e),i,n,h,c,d,1);break}}}function s(t,e,i,n,r){var o=e.prev.i,s=e.i,a=e.next.i,l=t[o],h=t[o+1],c=t[s],d=t[s+1],p=t[a],f=t[a+1],m=l*d-h*c,g=l*f-h*p,v=m-g-(p*d-f*c);if(0>=v)return!1;var y,b,_,x,w,T,S,E=f-h,C=l-p,A=h-d,j=c-l;if(void 0!==i){var R=l>c?l>p?l:p:c>p?c:p,M=h>d?h>f?h:f:d>f?d:f,O=u(c>l?p>l?l:p:p>c?c:p,d>h?f>h?h:f:f>d?d:f,i,n,r),D=u(R,M,i,n,r);for(S=e.nextZ;S&&S.z<=D;)if(y=S.i,S=S.nextZ,y!==o&&y!==a&&((x=E*(b=t[y])+C*(_=t[y+1])-g)>=0&&((w=A*b+j*_+m)>=0&&((T=v-x-w)>=0&&(x&&w||x&&T||w&&T)))))return!1;for(S=e.prevZ;S&&S.z>=O;)if(y=S.i,S=S.prevZ,y!==o&&y!==a&&((x=E*(b=t[y])+C*(_=t[y+1])-g)>=0&&((w=A*b+j*_+m)>=0&&((T=v-x-w)>=0&&(x&&w||x&&T||w&&T)))))return!1}else for(S=e.next.next;S!==e.prev;)if(y=S.i,S=S.next,(x=E*(b=t[y])+C*(_=t[y+1])-g)>=0&&((w=A*b+j*_+m)>=0&&((T=v-x-w)>=0&&(x&&w||x&&T||w&&T))))return!1;return!0}function a(t,e,i,n){var r=e;do{var o=r.prev,s=r.next.next;if(o.i!==s.i&&m(t,o.i,r.i,r.next.i,s.i)&&g(t,o,s)&&g(t,s,o)){i.push(o.i/n),i.push(r.i/n),i.push(s.i/n),o.next=s,s.prev=o;var a=r.prevZ,l=r.nextZ&&r.nextZ.nextZ;a&&(a.nextZ=l),l&&(l.prevZ=a),r=e=s}r=r.next}while(r!==e);return r}function l(t,e,i,n,s,a,l){var h=e;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&d(t,h,u)){var c=v(h,u);return h=r(t,h,h.next),c=r(t,c,c.next),o(t,h,i,n,s,a,l),void o(t,c,i,n,s,a,l)}u=u.next}h=h.next}while(h!==e)}function h(t,e,i){if(i=function(t,e,i){var n,r,o,s=i,a=e.i,l=t[a],h=t[a+1],u=-1/0;do{if(r=s.i,o=s.next.i,h<=t[r+1]&&h>=t[o+1]){var c=t[r]+(h-t[r+1])*(t[o]-t[r])/(t[o+1]-t[r+1]);l>=c&&c>u&&(u=c,n=t[r]<t[o]?s:s.next)}s=s.next}while(s!==i);if(!n)return null;var d,p,f,m,v,y,b=t[n.i],_=t[n.i+1],x=l*_-h*b,w=l*h-h*u,T=h-h,S=l-u,E=h-_,C=b-l,A=x-w-(u*_-h*b),j=0>=A?-1:1,R=n,M=1/0;for(s=n.next;s!==R;)d=t[s.i],p=t[s.i+1],(f=l-d)>=0&&d>=b&&(m=(T*d+S*p-w)*j)>=0&&(v=(E*d+C*p+x)*j)>=0&&A*j-m-v>=0&&(y=Math.abs(h-p)/f,M>y&&g(t,s,e)&&(n=s,M=y)),s=s.next;return n}(t,e,i)){var n=v(i,e);r(t,n,n.next)}}function u(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=1e3*(t-i)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=1e3*(e-n)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function c(t,e){var i=e,n=e;do{t[i.i]<t[n.i]&&(n=i),i=i.next}while(i!==e);return n}function d(t,e,i){return e.next.i!==i.i&&e.prev.i!==i.i&&!function(t,e,i,n){var r=e;do{var o=r.i,s=r.next.i;if(o!==i&&s!==i&&o!==n&&s!==n&&m(t,o,s,i,n))return!0;r=r.next}while(r!==e);return!1}(t,e,e.i,i.i)&&g(t,e,i)&&g(t,i,e)&&function(t,e,i,n){var r=e,o=!1,s=(t[i]+t[n])/2,a=(t[i+1]+t[n+1])/2;do{var l=r.i,h=r.next.i;t[l+1]>a!=t[h+1]>a&&s<(t[h]-t[l])*(a-t[l+1])/(t[h+1]-t[l+1])+t[l]&&(o=!o),r=r.next}while(r!==e);return o}(t,e,e.i,i.i)}function p(t,e,i,n){var r=(t[i+1]-t[e+1])*(t[n]-t[i])-(t[i]-t[e])*(t[n+1]-t[i+1]);return r>0?1:0>r?-1:0}function f(t,e,i){return t[e]===t[i]&&t[e+1]===t[i+1]}function m(t,e,i,n,r){return p(t,e,i,n)!==p(t,e,i,r)&&p(t,n,r,e)!==p(t,n,r,i)}function g(t,e,i){return-1===p(t,e.prev.i,e.i,e.next.i)?-1!==p(t,e.i,i.i,e.next.i)&&-1!==p(t,e.i,e.prev.i,i.i):-1===p(t,e.i,i.i,e.prev.i)||-1===p(t,e.i,e.next.i,i.i)}function v(t,e){var i=new b(t.i),n=new b(e.i),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function y(t,e){var i=new b(t);return e?(i.next=e.next,i.prev=e,e.next.prev=i,e.next=i):(i.prev=i,i.next=i),i}function b(t){this.i=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}e.exports=function(t,e,i){i=i||2;var s,a,l,u,d,p,f,m=e&&e.length,g=m?e[0]*i:t.length,v=r(t,n(t,0,g,i,!0)),y=[];if(!v)return y;if(m&&(v=function(t,e,i,o){var s,a,l,u,d,p=[];for(s=0,a=e.length;a>s;s++)l=e[s]*o,u=a-1>s?e[s+1]*o:t.length,(d=n(t,l,u,o,!1))===d.next&&(d.steiner=!0),(d=r(t,d))&&p.push(c(t,d));for(p.sort((function(e,i){return t[e.i]-t[i.i]})),s=0;s<p.length;s++)h(t,p[s],i),i=r(t,i,i.next);return i}(t,e,v,i)),t.length>80*i){s=l=t[0],a=u=t[1];for(var b=i;g>b;b+=i)s>(d=t[b])&&(s=d),a>(p=t[b+1])&&(a=p),d>l&&(l=d),p>u&&(u=p);f=Math.max(l-s,u-a)}return o(t,v,y,i,s,a,f),y}},{}],10:[function(t,e,i){function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(){}var o="function"!=typeof Object.create&&"~";r.prototype._events=void 0,r.prototype.listeners=function(t,e){var i=o?o+t:t,n=this._events&&this._events[i];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var r=0,s=n.length,a=new Array(s);s>r;r++)a[r]=n[r].fn;return a},r.prototype.emit=function(t,e,i,n,r,s){var a=o?o+t:t;if(!this._events||!this._events[a])return!1;var l,h,u=this._events[a],c=arguments.length;if("function"==typeof u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,n),!0;case 5:return u.fn.call(u.context,e,i,n,r),!0;case 6:return u.fn.call(u.context,e,i,n,r,s),!0}for(h=1,l=new Array(c-1);c>h;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var d,p=u.length;for(h=0;p>h;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),c){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,i);break;default:if(!l)for(d=1,l=new Array(c-1);c>d;d++)l[d-1]=arguments[d];u[h].fn.apply(u[h].context,l)}}return!0},r.prototype.on=function(t,e,i){var r=new n(e,i||this),s=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):this._events[s]=r,this},r.prototype.once=function(t,e,i){var r=new n(e,i||this,!0),s=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):this._events[s]=r,this},r.prototype.removeListener=function(t,e,i,n){var r=o?o+t:t;if(!this._events||!this._events[r])return this;var s=this._events[r],a=[];if(e)if(s.fn)(s.fn!==e||n&&!s.once||i&&s.context!==i)&&a.push(s);else for(var l=0,h=s.length;h>l;l++)(s[l].fn!==e||n&&!s[l].once||i&&s[l].context!==i)&&a.push(s[l]);return a.length?this._events[r]=1===a.length?a[0]:a:delete this._events[r],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[o?o+t:t]:this._events=o?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=o,void 0!==e&&(e.exports=r)},{}],11:[function(t,e,i){var n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(t,e){for(var i,o,s=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),a=1;a<arguments.length;a++){for(var l in i=Object(arguments[a]))n.call(i,l)&&(s[l]=i[l]);if(Object.getOwnPropertySymbols){o=Object.getOwnPropertySymbols(i);for(var h=0;h<o.length;h++)r.call(i,o[h])&&(s[o[h]]=i[o[h]])}}return s}},{}],12:[function(t,e,i){(function(t){!function(){function i(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(n,arguments)}}var n,r,o={};null!=(n=this)&&(r=n.async),o.noConflict=function(){return n.async=r,o};var s=Object.prototype.toString,a=Array.isArray||function(t){return"[object Array]"===s.call(t)},l=function(t,e){for(var i=0;i<t.length;i+=1)e(t[i],i,t)},h=function(t,e){if(t.map)return t.map(e);var i=[];return l(t,(function(t,n,r){i.push(e(t,n,r))})),i},u=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};void 0!==t&&t.nextTick?(o.nextTick=t.nextTick,"undefined"!=typeof setImmediate?o.setImmediate=function(t){setImmediate(t)}:o.setImmediate=o.nextTick):"function"==typeof setImmediate?(o.nextTick=function(t){setImmediate(t)},o.setImmediate=o.nextTick):(o.nextTick=function(t){setTimeout(t,0)},o.setImmediate=o.nextTick),o.each=function(t,e,n){function r(e){e?(n(e),n=function(){}):(o+=1)>=t.length&&n()}if(n=n||function(){},!t.length)return n();var o=0;l(t,(function(t){e(t,i(r))}))},o.forEach=o.each,o.eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var n=0,r=function(){e(t[n],(function(e){e?(i(e),i=function(){}):(n+=1)>=t.length?i():r()}))};r()},o.forEachSeries=o.eachSeries,o.eachLimit=function(t,e,i,n){c(e).apply(null,[t,i,n])},o.forEachLimit=o.eachLimit;var c=function(t){return function(e,i,n){if(n=n||function(){},!e.length||0>=t)return n();var r=0,o=0,s=0;!function a(){if(r>=e.length)return n();for(;t>s&&o<e.length;)s+=1,i(e[(o+=1)-1],(function(t){t?(n(t),n=function(){}):(s-=1,(r+=1)>=e.length?n():a())}))}()}},d=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.each].concat(e))}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.eachSeries].concat(e))}},f=function(t,e,i,n){if(e=h(e,(function(t,e){return{index:e,value:t}})),n){var r=[];t(e,(function(t,e){i(t.value,(function(i,n){r[t.index]=n,e(i)}))}),(function(t){n(t,r)}))}else t(e,(function(t,e){i(t.value,(function(t){e(t)}))}))};o.map=d(f),o.mapSeries=p(f),o.mapLimit=function(t,e,i,n){return m(e)(t,i,n)};var m=function(t){return function(t,e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[c(t)].concat(i))}}(t,f)};o.reduce=function(t,e,i,n){o.eachSeries(t,(function(t,n){i(e,t,(function(t,i){e=i,n(t)}))}),(function(t){n(t,e)}))},o.inject=o.reduce,o.foldl=o.reduce,o.reduceRight=function(t,e,i,n){var r=h(t,(function(t){return t})).reverse();o.reduce(r,e,i,n)},o.foldr=o.reduceRight;var g=function(t,e,i,n){var r=[];t(e=h(e,(function(t,e){return{index:e,value:t}})),(function(t,e){i(t.value,(function(i){i&&r.push(t),e()}))}),(function(t){n(h(r.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))};o.filter=d(g),o.filterSeries=p(g),o.select=o.filter,o.selectSeries=o.filterSeries;var v=function(t,e,i,n){var r=[];t(e=h(e,(function(t,e){return{index:e,value:t}})),(function(t,e){i(t.value,(function(i){i||r.push(t),e()}))}),(function(t){n(h(r.sort((function(t,e){return t.index-e.index})),(function(t){return t.value})))}))};o.reject=d(v),o.rejectSeries=p(v);var y=function(t,e,i,n){t(e,(function(t,e){i(t,(function(i){i?(n(t),n=function(){}):e()}))}),(function(t){n()}))};o.detect=d(y),o.detectSeries=p(y),o.some=function(t,e,i){o.each(t,(function(t,n){e(t,(function(t){t&&(i(!0),i=function(){}),n()}))}),(function(t){i(!1)}))},o.any=o.some,o.every=function(t,e,i){o.each(t,(function(t,n){e(t,(function(t){t||(i(!1),i=function(){}),n()}))}),(function(t){i(!0)}))},o.all=o.every,o.sortBy=function(t,e,i){o.map(t,(function(t,i){e(t,(function(e,n){e?i(e):i(null,{value:t,criteria:n})}))}),(function(t,e){if(t)return i(t);i(null,h(e.sort((function(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0})),(function(t){return t.value})))}))},o.auto=function(t,e){e=e||function(){};var i=u(t),n=i.length;if(!n)return e();var r={},s=[],h=function(t){s.unshift(t)},c=function(){n--,l(s.slice(0),(function(t){t()}))};h((function(){if(!n){var t=e;e=function(){},t(null,r)}})),l(i,(function(i){var n=a(t[i])?t[i]:[t[i]],d=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),t){var s={};l(u(r),(function(t){s[t]=r[t]})),s[i]=n,e(t,s),e=function(){}}else r[i]=n,o.setImmediate(c)},p=n.slice(0,Math.abs(n.length-1))||[],f=function(){return e=function(t,e){return t&&r.hasOwnProperty(e)},n=!0,((t=p).reduce?t.reduce(e,n):(l(t,(function(t,i,r){n=e(n,t,i,r)})),n))&&!r.hasOwnProperty(i);var t,e,n};if(f())n[n.length-1](d,r);else{var m=function(){f()&&(function(t){for(var e=0;e<s.length;e+=1)if(s[e]===t)return void s.splice(e,1)}(m),n[n.length-1](d,r))};h(m)}}))},o.retry=function(t,e,i){var n=[];"function"==typeof t&&(i=e,e=t,t=5),t=parseInt(t,10)||5;var r=function(r,s){for(var a=function(t,e){return function(i){t((function(t,n){i(!t||e,{err:t,result:n})}),s)}};t;)n.push(a(e,!(t-=1)));o.series(n,(function(t,e){e=e[e.length-1],(r||i)(e.err,e.result)}))};return i?r():r},o.waterfall=function(t,e){if(e=e||function(){},!a(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();var n=function(t){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var r=Array.prototype.slice.call(arguments,1),s=t.next();s?r.push(n(s)):r.push(e),o.setImmediate((function(){t.apply(null,r)}))}}};n(o.iterator(t))()};var b=function(t,e,i){if(i=i||function(){},a(e))t.map(e,(function(t,e){t&&t((function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)}))}),i);else{var n={};t.each(u(e),(function(t,i){e[t]((function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[t]=r,i(e)}))}),(function(t){i(t,n)}))}};o.parallel=function(t,e){b({map:o.map,each:o.each},t,e)},o.parallelLimit=function(t,e,i){b({map:m(e),each:c(e)},t,i)},o.series=function(t,e){if(e=e||function(){},a(t))o.mapSeries(t,(function(t,e){t&&t((function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)}))}),e);else{var i={};o.eachSeries(u(t),(function(e,n){t[e]((function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[e]=r,n(t)}))}),(function(t){e(t,i)}))}},o.iterator=function(t){var e=function(i){var n=function(){return t.length&&t[i].apply(null,arguments),n.next()};return n.next=function(){return i<t.length-1?e(i+1):null},n};return e(0)},o.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var _=function(t,e,i,n){var r=[];t(e,(function(t,e){i(t,(function(t,i){r=r.concat(i||[]),e(t)}))}),(function(t){n(t,r)}))};o.concat=d(_),o.concatSeries=p(_),o.whilst=function(t,e,i){t()?e((function(n){return n?i(n):void o.whilst(t,e,i)})):i()},o.doWhilst=function(t,e,i){t((function(n){if(n)return i(n);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?o.doWhilst(t,e,i):i()}))},o.until=function(t,e,i){t()?i():e((function(n){return n?i(n):void o.until(t,e,i)}))},o.doUntil=function(t,e,i){t((function(n){if(n)return i(n);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?i():o.doUntil(t,e,i)}))},o.queue=function(t,e){function n(t,e,i,n){return t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?o.setImmediate((function(){t.drain&&t.drain()})):void l(e,(function(e){var r={data:e,callback:"function"==typeof n?n:null};i?t.tasks.unshift(r):t.tasks.push(r),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),o.setImmediate(t.process)}))}void 0===e&&(e=1);var r=0,s={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){n(s,t,!1,e)},kill:function(){s.drain=null,s.tasks=[]},unshift:function(t,e){n(s,t,!0,e)},process:function(){if(!s.paused&&r<s.concurrency&&s.tasks.length){var e=s.tasks.shift();s.empty&&0===s.tasks.length&&s.empty(),r+=1;var n=i((function(){r-=1,e.callback&&e.callback.apply(e,arguments),s.drain&&s.tasks.length+r===0&&s.drain(),s.process()}));t(e.data,n)}},length:function(){return s.tasks.length},running:function(){return r},idle:function(){return s.tasks.length+r===0},pause:function(){!0!==s.paused&&(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var t=1;t<=s.concurrency;t++)o.setImmediate(s.process)}}};return s},o.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}var n=o.queue(t,e);return n.push=function(t,e,r){!function(t,e,n,r){t.started||(t.started=!0),a(e)||(e=[e]),0==e.length?o.setImmediate((function(){t.drain&&t.drain()})):l(e,(function(e){var s={data:e,priority:n,callback:"function"==typeof r?r:null};t.tasks.splice(function(t,e,i){for(var n=-1,r=t.length-1;r>n;){var o=n+(r-n+1>>>1);i(e,t[o])>=0?n=o:r=o-1}return n}(t.tasks,s,i)+1,0,s),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),o.setImmediate(t.process)}))}(n,t,e,r)},delete n.unshift,n},o.cargo=function(t,e){var i=!1,n=[],r={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,i){a(t)||(t=[t]),l(t,(function(t){n.push({data:t,callback:"function"==typeof i?i:null}),r.drained=!1,r.saturated&&n.length===e&&r.saturated()})),o.setImmediate(r.process)},process:function o(){if(!i){if(0===n.length)return r.drain&&!r.drained&&r.drain(),void(r.drained=!0);var s="number"==typeof e?n.splice(0,e):n.splice(0,n.length),a=h(s,(function(t){return t.data}));r.empty&&r.empty(),i=!0,t(a,(function(){i=!1;var t=arguments;l(s,(function(e){e.callback&&e.callback.apply(null,t)})),o()}))}},length:function(){return n.length},running:function(){return i}};return r};var x=function(t){return function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(null,i.concat([function(e){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error:console[t]&&l(i,(function(t){})))}]))}};o.log=x("log"),o.dir=x("dir"),o.memoize=function(t,e){var i={},n={};e=e||function(t){return t};var r=function(){var r=Array.prototype.slice.call(arguments),s=r.pop(),a=e.apply(null,r);a in i?o.nextTick((function(){s.apply(null,i[a])})):a in n?n[a].push(s):(n[a]=[s],t.apply(null,r.concat([function(){i[a]=arguments;var t=n[a];delete n[a];for(var e=0,r=t.length;r>e;e++)t[e].apply(null,arguments)}])))};return r.memo=i,r.unmemoized=t,r},o.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},o.times=function(t,e,i){for(var n=[],r=0;t>r;r++)n.push(r);return o.map(n,e,i)},o.timesSeries=function(t,e,i){for(var n=[],r=0;t>r;r++)n.push(r);return o.mapSeries(n,e,i)},o.seq=function(){var t=arguments;return function(){var e=this,i=Array.prototype.slice.call(arguments),n=i.pop();o.reduce(t,i,(function(t,i,n){i.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))}),(function(t,i){n.apply(e,[t].concat(i))}))}},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(t,e){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),r=n.pop();return t(e,(function(t,e){t.apply(i,n.concat([e]))}),r)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};o.applyEach=d(w),o.applyEachSeries=p(w),o.forever=function(t,e){!function i(n){if(n){if(e)return e(n);throw n}t(i)}()},void 0!==e&&e.exports?e.exports=o:n.async=o}()}).call(this,t("_process"))},{_process:3}],13:[function(t,e,i){function n(t,e){a.call(this),e=e||10,this.baseUrl=t||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=r.queue(this._boundLoadResource,e),this.resources={}}var r=t("async"),o=t("url"),s=t("./Resource"),a=t("eventemitter3");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.add=n.prototype.enqueue=function(t,e,i,n){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this}if("object"==typeof t&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.resources[t])throw new Error('Resource with name "'+t+'" already exists.');return e=this._handleBaseUrl(e),this.resources[t]=new s(t,e,i),"function"==typeof n&&this.resources[t].once("afterMiddleware",n),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[t]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[t]),this._progressChunk=100/this._buffer.length),this},n.prototype._handleBaseUrl=function(t){var e=o.parse(t);return e.protocol||0===e.pathname.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.lastIndexOf("/")!==t.length-1?this.baseUrl+"/"+t:this.baseUrl+t},n.prototype.before=n.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},n.prototype.after=n.prototype.use=function(t){return this._afterMiddleware.push(t),this},n.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},n.prototype.load=function(t){if("function"==typeof t&&this.once("complete",t),this._queue.started)return this;this.emit("start",this);for(var e=0;e<this._buffer.length;++e)this._queue.push(this._buffer[e]);return this._buffer.length=0,this},n.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,this._runMiddleware(t,this._beforeMiddleware,(function(){t.load(i._boundOnLoad)}))},n.prototype._onComplete=function(){this.emit("complete",this,this.resources)},n.prototype._onLoad=function(t){this.progress+=this._progressChunk,this.emit("progress",this,t),this._runMiddleware(t,this._afterMiddleware,(function(){t.emit("afterMiddleware",t),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),t.error?this.emit("error",t.error,this,t):this.emit("load",this,t)})),t._dequeue()},n.prototype._runMiddleware=function(t,e,i){var n=this;r.eachSeries(e,(function(e,i){e.call(n,t,i)}),i.bind(this,t))},n.LOAD_TYPE=s.LOAD_TYPE,n.XHR_READY_STATE=s.XHR_READY_STATE,n.XHR_RESPONSE_TYPE=s.XHR_RESPONSE_TYPE},{"./Resource":14,async:12,eventemitter3:10,url:8}],14:[function(t,e,i){function n(t,e,i){if(s.call(this),i=i||{},"string"!=typeof t||"string"!=typeof e)throw new Error("Both name and url are required for constructing a resource.");this.name=t,this.url=e,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":null,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function r(t){return t.toString().replace("object ","")}function o(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}var s=t("eventemitter3"),a=t("url"),l=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),h=null;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},n.prototype.load=function(t){switch(this.emit("start",this),t&&this.once("complete",t),"string"!=typeof this.crossOrigin&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case n.LOAD_TYPE.IMAGE:this._loadImage();break;case n.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case n.LOAD_TYPE.VIDEO:this._loadElement("video");break;case n.LOAD_TYPE.XHR:default:l&&this.crossOrigin?this._loadXdr():this._loadXhr()}},n.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},n.prototype._loadElement=function(t){if("audio"===t&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return this.error=new Error("Unsupported element "+t),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this["is"+t[0].toUpperCase()+t.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},n.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),this.xhrType===n.XHR_RESPONSE_TYPE.JSON||this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=n.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},n.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){t.send()}),0)},n.prototype._createSource=function(t,e,i){i||(i=t+"/"+e.substr(e.lastIndexOf(".")+1));var n=document.createElement("source");return n.src=e,n.type=i,n},n.prototype._onError=function(t){this.error=new Error("Failed to load element using "+t.target.nodeName),this.complete()},n.prototype._onProgress=function(t){t&&t.lengthComputable&&this.emit("progress",this,t.loaded/t.total)},n.prototype._xhrOnError=function(){this.error=new Error(r(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},n.prototype._xhrOnAbort=function(){this.error=new Error(r(this.xhr)+" Request was aborted by the user."),this.complete()},n.prototype._xdrOnTimeout=function(){this.error=new Error(r(this.xhr)+" Request timed out."),this.complete()},n.prototype._xhrOnLoad=function(){var t=this.xhr,e=void 0!==t.status?t.status:200;if(200===e||204===e||0===e&&t.responseText.length>0)if(this.xhrType===n.XHR_RESPONSE_TYPE.TEXT)this.data=t.responseText;else if(this.xhrType===n.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(t.responseText),this.isJson=!0}catch(t){this.error=new Error("Error trying to parse loaded json:",t)}else if(this.xhrType===n.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(t.responseText,"text/xml")}else{var r=document.createElement("div");r.innerHTML=t.responseText,this.data=r}this.isXml=!0}catch(t){this.error=new Error("Error trying to parse loaded xml:",t)}else this.data=t.response||t.responseText;else this.error=new Error("["+t.status+"]"+t.statusText+":"+t.responseURL);this.complete()},n.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,h||(h=document.createElement("a")),h.href=t;var i=!(t=a.parse(h.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"},n.prototype._determineXhrType=function(){return n._xhrTypeMap[this._getExtension()]||n.XHR_RESPONSE_TYPE.TEXT},n.prototype._determineLoadType=function(){return n._loadTypeMap[this._getExtension()]||n.LOAD_TYPE.XHR},n.prototype._getExtension=function(){var t,e=this.url;if(this.isDataUrl){var i=e.indexOf("/");t=e.substring(i+1,e.indexOf(";",i))}else{var n=e.indexOf("?");-1!==n&&(e=e.substring(0,n)),t=e.substring(e.lastIndexOf(".")+1)}return t},n.prototype._getMimeFromXhrType=function(t){switch(t){case n.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case n.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case n.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case n.XHR_RESPONSE_TYPE.JSON:return"application/json";case n.XHR_RESPONSE_TYPE.DEFAULT:case n.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},n.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},n.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},n.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},n._loadTypeMap={gif:n.LOAD_TYPE.IMAGE,png:n.LOAD_TYPE.IMAGE,bmp:n.LOAD_TYPE.IMAGE,jpg:n.LOAD_TYPE.IMAGE,jpeg:n.LOAD_TYPE.IMAGE,tif:n.LOAD_TYPE.IMAGE,tiff:n.LOAD_TYPE.IMAGE,webp:n.LOAD_TYPE.IMAGE,tga:n.LOAD_TYPE.IMAGE},n._xhrTypeMap={xhtml:n.XHR_RESPONSE_TYPE.DOCUMENT,html:n.XHR_RESPONSE_TYPE.DOCUMENT,htm:n.XHR_RESPONSE_TYPE.DOCUMENT,xml:n.XHR_RESPONSE_TYPE.DOCUMENT,tmx:n.XHR_RESPONSE_TYPE.DOCUMENT,tsx:n.XHR_RESPONSE_TYPE.DOCUMENT,svg:n.XHR_RESPONSE_TYPE.DOCUMENT,gif:n.XHR_RESPONSE_TYPE.BLOB,png:n.XHR_RESPONSE_TYPE.BLOB,bmp:n.XHR_RESPONSE_TYPE.BLOB,jpg:n.XHR_RESPONSE_TYPE.BLOB,jpeg:n.XHR_RESPONSE_TYPE.BLOB,tif:n.XHR_RESPONSE_TYPE.BLOB,tiff:n.XHR_RESPONSE_TYPE.BLOB,webp:n.XHR_RESPONSE_TYPE.BLOB,tga:n.XHR_RESPONSE_TYPE.BLOB,json:n.XHR_RESPONSE_TYPE.JSON,text:n.XHR_RESPONSE_TYPE.TEXT,txt:n.XHR_RESPONSE_TYPE.TEXT},n.setExtensionLoadType=function(t,e){o(n._loadTypeMap,t,e)},n.setExtensionXhrType=function(t,e){o(n._xhrTypeMap,t,e)}},{eventemitter3:10,url:8}],15:[function(t,e,i){e.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(t){for(var e,i="",n=new Array(4),r=0,o=0;r<t.length;){for(e=new Array(3),o=0;o<e.length;o++)r<t.length?e[o]=255&t.charCodeAt(r++):e[o]=0;switch(n[0]=e[0]>>2,n[1]=(3&e[0])<<4|e[1]>>4,n[2]=(15&e[1])<<2|e[2]>>6,n[3]=63&e[2],r-(t.length-1)){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64}for(o=0;o<n.length;o++)i+=this._keyStr.charAt(n[o])}return i}}},{}],16:[function(t,e,i){e.exports=t("./Loader"),e.exports.Resource=t("./Resource"),e.exports.middleware={caching:{memory:t("./middlewares/caching/memory")},parsing:{blob:t("./middlewares/parsing/blob")}}},{"./Loader":13,"./Resource":14,"./middlewares/caching/memory":17,"./middlewares/parsing/blob":18}],17:[function(t,e,i){var n={};e.exports=function(){return function(t,e){n[t.url]?(t.data=n[t.url],t.complete()):(t.once("complete",(function(){n[this.url]=this.data})),e())}}},{}],18:[function(t,e,i){var n=t("../../Resource"),r=t("../../b64");window.URL=window.URL||window.webkitURL,e.exports=function(){return function(t,e){if(!t.data)return e();if(t.xhr&&t.xhrType===n.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=URL.createObjectURL(t.data);t.blob=t.data,t.data=new Image,t.data.src=i,t.isImage=!0,t.data.onload=function(){URL.revokeObjectURL(i),t.data.onload=null,e()}}}else{var o=t.xhr.getResponseHeader("content-type");o&&0===o.indexOf("image")&&(t.data=new Image,t.data.src="data:"+o+";base64,"+r.encodeBinary(t.xhr.responseText),t.isImage=!0,t.data.onload=function(){t.data.onload=null,e()})}else e()}}},{"../../Resource":14,"../../b64":15}],19:[function(t,e,i){e.exports={name:"pixi.js",version:"3.0.8-dev",description:"Pixi.js is a fast lightweight 2D library that works across all devices.",author:"Mat Groves",contributors:["Chad Engler <chad@pantherdev.com>","Richard Davey <rdavey@gmail.com>"],main:"./src/index.js",homepage:"http://goodboydigital.com/",bugs:"https://github.com/GoodBoyDigital/pixi.js/issues",license:"MIT",repository:{type:"git",url:"https://github.com/GoodBoyDigital/pixi.js.git"},scripts:{start:"gulp && gulp watch",test:"gulp && testem ci",build:"gulp",docs:"jsdoc -c ./gulp/util/jsdoc.conf.json -R README.md"},files:["bin/","src/","CONTRIBUTING.md","LICENSE","package.json","README.md"],dependencies:{async:"^1.4.2",brfs:"^1.4.1",earcut:"^2.0.2",eventemitter3:"^1.1.1","gulp-header":"^1.7.1","object-assign":"^4.0.1","resource-loader":"^1.6.2"},devDependencies:{browserify:"^11.1.0",chai:"^3.2.0",del:"^2.0.2",gulp:"^3.9.0","gulp-cached":"^1.1.0","gulp-concat":"^2.6.0","gulp-debug":"^2.1.0","gulp-jshint":"^1.11.2","gulp-mirror":"^0.4.0","gulp-plumber":"^1.0.1","gulp-rename":"^1.2.2","gulp-sourcemaps":"^1.5.2","gulp-uglify":"^1.4.1","gulp-util":"^3.0.6","jaguarjs-jsdoc":"git+https://github.com/davidshimjs/jaguarjs-jsdoc.git",jsdoc:"^3.3.2","jshint-summary":"^0.4.0",minimist:"^1.2.0",mocha:"^2.3.2","require-dir":"^0.3.0","run-sequence":"^1.1.2",testem:"^0.9.4","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",watchify:"^3.4.0"},browserify:{transform:["brfs"]}}},{}],20:[function(t,e,i){var n={VERSION:t("../../package.json").version,PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};e.exports=n},{"../../package.json":19}],21:[function(t,e,i){function n(){o.call(this),this.children=[]}var r=t("../math"),o=t("./DisplayObject"),s=t("../textures/RenderTexture"),a=new r.Matrix;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}}),n.prototype.onChildrenChange=function(){},n.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},n.prototype.addChildAt=function(t,e){if(t===this)return t;if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.onChildrenChange(e),t.emit("added",this),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},n.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);if(0>i||0>n)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[i]=e,this.children[n]=t,this.onChildrenChange(n>i?i:n)}},n.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},n.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},n.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},n.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},n.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,this.children.splice(t,1),this.onChildrenChange(t),e.emit("removed",this),e},n.prototype.removeChildren=function(t,e){var i,n,r=t||0,o="number"==typeof e?e:this.children.length,s=o-r;if(s>0&&o>=s){for(i=this.children.splice(r,s),n=0;n<i.length;++n)i[n].parent=null;for(this.onChildrenChange(t),n=0;n<i.length;++n)i[n].emit("removed",this);return i}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.generateTexture=function(t,e,i){var n=this.getLocalBounds(),r=new s(t,0|n.width,0|n.height,i,e);return a.tx=-n.x,a.ty=-n.y,r.render(this,a),r},n.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()}},n.prototype.containerUpdateTransform=n.prototype.updateTransform,n.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return r.Rectangle.EMPTY;for(var t,e,i,n=1/0,o=1/0,s=-1/0,a=-1/0,l=!1,h=0,u=this.children.length;u>h;++h){this.children[h].visible&&(l=!0,n=n<(t=this.children[h].getBounds()).x?n:t.x,o=o<t.y?o:t.y,s=s>(e=t.width+t.x)?s:e,a=a>(i=t.height+t.y)?a:i)}if(!l)return r.Rectangle.EMPTY;var c=this._bounds;c.x=n,c.y=o,c.width=s-n,c.height=a-o,this._currentBounds=c}return this._currentBounds},n.prototype.containerGetBounds=n.prototype.getBounds,n.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=r.Matrix.IDENTITY;for(var e=0,i=this.children.length;i>e;++e)this.children[e].updateTransform();return this.worldTransform=t,this._currentBounds=null,this.getBounds(r.Matrix.IDENTITY)},n.prototype.renderWebGL=function(t){var e,i;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&this._filters.length&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,i=this.children.length;i>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,i=this.children.length;i>e;++e)this.children[e].renderWebGL(t)},n.prototype._renderWebGL=function(t){},n.prototype._renderCanvas=function(t){},n.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask,t),this._renderCanvas(t);for(var e=0,i=this.children.length;i>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},n.prototype.destroy=function(t){if(o.prototype.destroy.call(this),t)for(var e=0,i=this.children.length;i>e;++e)this.children[e].destroy(t);this.removeChildren(),this.children=null}},{"../math":30,"../textures/RenderTexture":68,"./DisplayObject":22}],22:[function(t,e,i){function n(){s.call(this),this.position=new r.Point,this.scale=new r.Point(1,1),this.pivot=new r.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new r.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new r.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var r=t("../math"),o=t("../textures/RenderTexture"),s=t("eventemitter3"),a=t("../const"),l=new r.Matrix;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),n.prototype.updateTransform=function(){var t,e,i,n,r,o,s=this.parent.worldTransform,l=this.worldTransform;this.rotation%a.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,i=-this._sr*this.scale.y,n=this._cr*this.scale.y,r=this.position.x,o=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*t+this.pivot.y*i,o-=this.pivot.x*e+this.pivot.y*n),l.a=t*s.a+e*s.c,l.b=t*s.b+e*s.d,l.c=i*s.a+n*s.c,l.d=i*s.b+n*s.d,l.tx=r*s.a+o*s.c+s.tx,l.ty=r*s.b+o*s.d+s.ty):(t=this.scale.x,n=this.scale.y,r=this.position.x-this.pivot.x*t,o=this.position.y-this.pivot.y*n,l.a=t*s.a,l.b=t*s.b,l.c=n*s.c,l.d=n*s.d,l.tx=r*s.a+o*s.c+s.tx,l.ty=r*s.b+o*s.d+s.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},n.prototype.displayObjectUpdateTransform=n.prototype.updateTransform,n.prototype.getBounds=function(t){return r.Rectangle.EMPTY},n.prototype.getLocalBounds=function(){return this.getBounds(r.Matrix.IDENTITY)},n.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},n.prototype.toLocal=function(t,e){return e&&(t=e.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},n.prototype.renderWebGL=function(t){},n.prototype.renderCanvas=function(t){},n.prototype.generateTexture=function(t,e,i){var n=this.getLocalBounds(),r=new o(t,0|n.width,0|n.height,e,i);return l.tx=-n.x,l.ty=-n.y,r.render(this,l),r},n.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},n.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../const":20,"../math":30,"../textures/RenderTexture":68,eventemitter3:10}],23:[function(t,e,i){function n(){r.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=u.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new h.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var r=t("../display/Container"),o=t("../textures/Texture"),s=t("../renderers/canvas/utils/CanvasBuffer"),a=t("../renderers/canvas/utils/CanvasGraphics"),l=t("./GraphicsData"),h=t("../math"),u=t("../const"),c=new h.Point;n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){var t=new n;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=!0,t.glDirty=!0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},n.prototype.lineStyle=function(t,e,i){if(this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=void 0===i?1:i,this.currentPath)if(this.currentPath.shape.points.length){var n=new h.Polygon(this.currentPath.shape.points.slice(-2));n.closed=!1,this.drawShape(n)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},n.prototype.moveTo=function(t,e){var i=new h.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},n.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},n.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r,o,s=this.currentPath.shape.points;0===s.length&&this.moveTo(0,0);for(var a=s[s.length-2],l=s[s.length-1],h=0,u=1;20>=u;++u)r=a+(t-a)*(h=u/20),o=l+(e-l)*h,s.push(r+(t+(i-t)*h-r)*h,o+(e+(n-e)*h-o)*h);return this.dirty=this.boundsDirty=!0,this},n.prototype.bezierCurveTo=function(t,e,i,n,r,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var s,a,l,h,u,c=this.currentPath.shape.points,d=c[c.length-2],p=c[c.length-1],f=0,m=1;20>=m;++m)l=(a=(s=1-(f=m/20))*s)*s,u=(h=f*f)*f,c.push(l*d+3*a*f*t+3*s*h*i+u*r,l*p+3*a*f*e+3*s*h*n+u*o);return this.dirty=this.boundsDirty=!0,this},n.prototype.arcTo=function(t,e,i,n,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,s=o[o.length-2],a=o[o.length-1]-e,l=s-t,h=n-e,u=i-t,c=Math.abs(a*u-l*h);if(1e-8>c||0===r)(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e);else{var d=a*a+l*l,p=h*h+u*u,f=a*h+l*u,m=r*Math.sqrt(d)/c,g=r*Math.sqrt(p)/c,v=m*f/d,y=g*f/p,b=m*u+g*l,_=m*h+g*a,x=l*(g+v),w=a*(g+v),T=u*(m+y),S=h*(m+y),E=Math.atan2(w-_,x-b),C=Math.atan2(S-_,T-b);this.arc(b+t,_+e,r,E,C,l*h>u*a)}return this.dirty=this.boundsDirty=!0,this},n.prototype.arc=function(t,e,i,n,r,o){if(n===r)return this;!(o=o||!1)&&n>=r?r+=2*Math.PI:o&&r>=n&&(n+=2*Math.PI);var s=o?-1*(n-r):r-n,a=40*Math.ceil(Math.abs(s)/(2*Math.PI));if(0===s)return this;var l=t+Math.cos(n)*i,h=e+Math.sin(n)*i;this.currentPath?this.currentPath.shape.points.push(l,h):this.moveTo(l,h);for(var u=this.currentPath.shape.points,c=s/(2*a),d=2*c,p=Math.cos(c),f=Math.sin(c),m=a-1,g=m%1/m,v=0;m>=v;v++){var y=c+n+d*(v+g*v),b=Math.cos(y),_=-Math.sin(y);u.push((p*b+f*_)*i+t,(p*-_+f*b)*i+e)}return this.dirty=this.boundsDirty=!0,this},n.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},n.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},n.prototype.drawRect=function(t,e,i,n){return this.drawShape(new h.Rectangle(t,e,i,n)),this},n.prototype.drawRoundedRect=function(t,e,i,n,r){return this.drawShape(new h.RoundedRectangle(t,e,i,n,r)),this},n.prototype.drawCircle=function(t,e,i){return this.drawShape(new h.Circle(t,e,i)),this},n.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new h.Ellipse(t,e,i,n)),this},n.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof h.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var r=new h.Polygon(e);return r.closed=i,this.drawShape(r),this},n.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},n.prototype.generateTexture=function(t,e,i){e=e||1;var n=this.getLocalBounds(),r=new s(n.width*e,n.height*e),l=o.fromCanvas(r.canvas,i);return l.baseTexture.resolution=e,r.context.scale(e,e),r.context.translate(-n.x,-n.y),a.renderGraphics(this,r.context),l},n.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1),t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this)},n.prototype._renderCanvas=function(t){if(!0!==this.isMask){this._prevTint!==this.tint&&(this.dirty=!0);var e=t.context,i=this.worldTransform,n=t.blendModes[this.blendMode];n!==e.globalCompositeOperation&&(e.globalCompositeOperation=n);var r=t.resolution;e.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r,i.ty*r),a.renderGraphics(this,e)}},n.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return h.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var e=this._localBounds,i=e.x,n=e.width+e.x,r=e.y,o=e.height+e.y,s=t||this.worldTransform,a=s.a,l=s.b,u=s.c,c=s.d,d=s.tx,p=s.ty,f=a*n+u*o+d,m=c*o+l*n+p,g=a*i+u*o+d,v=c*o+l*i+p,y=a*i+u*r+d,b=c*r+l*i+p,_=a*n+u*r+d,x=c*r+l*n+p,w=f,T=m,S=f,E=m;S=(S=(S=S>g?g:S)>y?y:S)>_?_:S,E=(E=(E=E>v?v:E)>b?b:E)>x?x:E,w=_>(w=y>(w=g>w?g:w)?y:w)?_:w,T=x>(T=b>(T=v>T?v:T)?b:T)?x:T,this._bounds.x=S,this._bounds.width=w-S,this._bounds.y=E,this._bounds.height=T-E,this._currentBounds=this._bounds}return this._currentBounds},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,c);for(var e=this.graphicsData,i=0;i<e.length;i++){var n=e[i];if(n.fill&&n.shape&&n.shape.contains(c.x,c.y))return!0}return!1},n.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var r,o,s,a,l,h,c=0;c<this.graphicsData.length;c++){var d=this.graphicsData[c],p=d.type,f=d.lineWidth;if(r=d.shape,p===u.SHAPES.RECT||p===u.SHAPES.RREC)s=r.x-f/2,a=r.y-f/2,t=t>s?s:t,e=s+(l=r.width+f)>e?s+l:e,i=i>a?a:i,n=a+(h=r.height+f)>n?a+h:n;else if(p===u.SHAPES.CIRC)s=r.x,a=r.y,t=t>s-(l=r.radius+f/2)?s-l:t,e=s+l>e?s+l:e,i=i>a-(h=r.radius+f/2)?a-h:i,n=a+h>n?a+h:n;else if(p===u.SHAPES.ELIP)s=r.x,a=r.y,t=t>s-(l=r.width+f/2)?s-l:t,e=s+l>e?s+l:e,i=i>a-(h=r.height+f/2)?a-h:i,n=a+h>n?a+h:n;else{o=r.points;for(var m=0;m<o.length;m+=2)t=t>(s=o[m])-f?s-f:t,e=s+f>e?s+f:e,i=i>(a=o[m+1])-f?a-f:i,n=a+f>n?a+f:n}}else t=0,e=0,i=0,n=0;var g=this.boundsPadding;this._localBounds.x=t-g,this._localBounds.width=e-t+2*g,this._localBounds.y=i-g,this._localBounds.height=n-i+2*g},n.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new l(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty=this.boundsDirty=!0,e},n.prototype.destroy=function(){r.prototype.destroy.apply(this,arguments);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webgl)for(var i=0;i<this._webgl[e].data.length;++i)this._webgl[e].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":20,"../display/Container":21,"../math":30,"../renderers/canvas/utils/CanvasBuffer":42,"../renderers/canvas/utils/CanvasGraphics":43,"../textures/Texture":69,"./GraphicsData":24}],24:[function(t,e,i){function n(t,e,i,n,r,o,s){this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this._lineTint=e,this.fillColor=n,this.fillAlpha=r,this._fillTint=n,this.fill=o,this.shape=s,this.type=s.type}n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},n.prototype.destroy=function(){this.shape=null}},{}],25:[function(t,e,i){function n(t){a.call(this,t),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var r=t("../../utils"),o=t("../../math"),s=t("../../const"),a=t("../../renderers/webgl/utils/ObjectRenderer"),l=t("../../renderers/webgl/WebGLRenderer"),h=t("./WebGLGraphicsData"),u=t("earcut");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,l.registerPlugin("graphics",n),n.prototype.onContextChange=function(){},n.prototype.destroy=function(){a.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},n.prototype.render=function(t){var e,i=this.renderer,n=i.gl,o=i.shaderManager.plugins.primitiveShader;t.dirty&&this.updateGraphics(t);var s=t._webGL[n.id];i.blendModeManager.setBlendMode(t.blendMode);for(var a=0,l=s.data.length;l>a;a++)e=s.data[a],1===s.data[a].mode?(i.stencilManager.pushStencil(t,e),n.uniform1f(i.shaderManager.complexPrimitiveShader.uniforms.alpha._location,t.worldAlpha*e.alpha),n.drawElements(n.TRIANGLE_FAN,4,n.UNSIGNED_SHORT,2*(e.indices.length-4)),i.stencilManager.popStencil(t,e)):(o=i.shaderManager.primitiveShader,i.shaderManager.setShader(o),n.uniformMatrix3fv(o.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(o.uniforms.projectionMatrix._location,!1,i.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(o.uniforms.tint._location,r.hex2rgb(t.tint)),n.uniform1f(o.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(o.attributes.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(o.attributes.aColor,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer),n.drawElements(n.TRIANGLE_STRIP,e.indices.length,n.UNSIGNED_SHORT,0)),i.drawCount++},n.prototype.updateGraphics=function(t){var e,i,n=this.renderer.gl,r=t._webGL[n.id];if(r||(r=t._webGL[n.id]={lastIndex:0,data:[],gl:n}),t.dirty=!1,t.clearDirty){for(t.clearDirty=!1,e=0;e<r.data.length;e++){var o=r.data[e];o.reset(),this.graphicsDataPool.push(o)}r.data=[],r.lastIndex=0}for(e=r.lastIndex;e<t.graphicsData.length;e++){var a=t.graphicsData[e];if(a.type===s.SHAPES.POLY){if(a.points=a.shape.points.slice(),a.shape.closed&&(a.points[0]!==a.points[a.points.length-2]||a.points[1]!==a.points[a.points.length-1])&&a.points.push(a.points[0],a.points[1]),a.fill&&a.points.length>=6)if(a.points.length<2*this.maximumSimplePolySize){i=this.switchMode(r,0),this.buildPoly(a,i)||(i=this.switchMode(r,1),this.buildComplexPoly(a,i))}else i=this.switchMode(r,1),this.buildComplexPoly(a,i);a.lineWidth>0&&(i=this.switchMode(r,0),this.buildLine(a,i))}else i=this.switchMode(r,0),a.type===s.SHAPES.RECT?this.buildRectangle(a,i):a.type===s.SHAPES.CIRC||a.type===s.SHAPES.ELIP?this.buildCircle(a,i):a.type===s.SHAPES.RREC&&this.buildRoundedRectangle(a,i);r.lastIndex++}for(e=0;e<r.data.length;e++)(i=r.data[e]).dirty&&i.upload()},n.prototype.switchMode=function(t,e){var i;return t.data.length?((i=t.data[t.data.length-1]).points.length>32e4||i.mode!==e||1===e)&&((i=this.graphicsDataPool.pop()||new h(t.gl)).mode=e,t.data.push(i)):((i=this.graphicsDataPool.pop()||new h(t.gl)).mode=e,t.data.push(i)),i.dirty=!0,i},n.prototype.buildRectangle=function(t,e){var i=t.shape,n=i.x,o=i.y,s=i.width,a=i.height;if(t.fill){var l=r.hex2rgb(t.fillColor),h=t.fillAlpha,u=l[0]*h,c=l[1]*h,d=l[2]*h,p=e.points,f=e.indices,m=p.length/6;p.push(n,o),p.push(u,c,d,h),p.push(n+s,o),p.push(u,c,d,h),p.push(n,o+a),p.push(u,c,d,h),p.push(n+s,o+a),p.push(u,c,d,h),f.push(m,m,m+1,m+2,m+3,m+3)}if(t.lineWidth){var g=t.points;t.points=[n,o,n+s,o,n+s,o+a,n,o+a,n,o],this.buildLine(t,e),t.points=g}},n.prototype.buildRoundedRectangle=function(t,e){var i=t.shape,n=i.x,o=i.y,s=i.width,a=i.height,l=i.radius,h=[];if(h.push(n,o+l),this.quadraticBezierCurve(n,o+a-l,n,o+a,n+l,o+a,h),this.quadraticBezierCurve(n+s-l,o+a,n+s,o+a,n+s,o+a-l,h),this.quadraticBezierCurve(n+s,o+l,n+s,o,n+s-l,o,h),this.quadraticBezierCurve(n+l,o,n,o,n,o+l+1e-10,h),t.fill){var c=r.hex2rgb(t.fillColor),d=t.fillAlpha,p=c[0]*d,f=c[1]*d,m=c[2]*d,g=e.points,v=e.indices,y=g.length/6,b=u(h,null,2),_=0;for(_=0;_<b.length;_+=3)v.push(b[_]+y),v.push(b[_]+y),v.push(b[_+1]+y),v.push(b[_+2]+y),v.push(b[_+2]+y);for(_=0;_<h.length;_++)g.push(h[_],h[++_],p,f,m,d)}if(t.lineWidth){var x=t.points;t.points=h,this.buildLine(t,e),t.points=x}},n.prototype.quadraticBezierCurve=function(t,e,i,n,r,o,s){function a(t,e,i){return t+(e-t)*i}for(var l,h,u,c,d,p,f=s||[],m=0,g=0;20>=g;g++)l=a(t,i,m=g/20),h=a(e,n,m),u=a(i,r,m),c=a(n,o,m),d=a(l,u,m),p=a(h,c,m),f.push(d,p);return f},n.prototype.buildCircle=function(t,e){var i,n,o=t.shape,a=o.x,l=o.y;t.type===s.SHAPES.CIRC?(i=o.radius,n=o.radius):(i=o.width,n=o.height);var h=Math.floor(30*Math.sqrt(o.radius))||Math.floor(15*Math.sqrt(o.width+o.height)),u=2*Math.PI/h,c=0;if(t.fill){var d=r.hex2rgb(t.fillColor),p=t.fillAlpha,f=d[0]*p,m=d[1]*p,g=d[2]*p,v=e.points,y=e.indices,b=v.length/6;for(y.push(b),c=0;h+1>c;c++)v.push(a,l,f,m,g,p),v.push(a+Math.sin(u*c)*i,l+Math.cos(u*c)*n,f,m,g,p),y.push(b++,b++);y.push(b-1)}if(t.lineWidth){var _=t.points;for(t.points=[],c=0;h+1>c;c++)t.points.push(a+Math.sin(u*c)*i,l+Math.cos(u*c)*n);this.buildLine(t,e),t.points=_}},n.prototype.buildLine=function(t,e){var i=0,n=t.points;if(0!==n.length){var s=new o.Point(n[0],n[1]),a=new o.Point(n[n.length-2],n[n.length-1]);if(s.x===a.x&&s.y===a.y){(n=n.slice()).pop(),n.pop();var l=(a=new o.Point(n[n.length-2],n[n.length-1])).x+.5*(s.x-a.x),h=a.y+.5*(s.y-a.y);n.unshift(l,h),n.push(l,h)}var u,c,d,p,f,m,g,v,y,b,_,x,w,T,S,E,C,A,j,R,M,O,D=e.points,P=e.indices,F=n.length/2,G=n.length,L=D.length/6,B=t.lineWidth/2,I=r.hex2rgb(t.lineColor),N=t.lineAlpha,k=I[0]*N,U=I[1]*N,V=I[2]*N;for(d=n[0],p=n[1],f=n[2],y=-(p-(m=n[3])),b=d-f,y/=O=Math.sqrt(y*y+b*b),b/=O,y*=B,b*=B,D.push(d-y,p-b,k,U,V,N),D.push(d+y,p+b,k,U,V,N),i=1;F-1>i;i++)d=n[2*(i-1)],p=n[2*(i-1)+1],f=n[2*i],m=n[2*i+1],g=n[2*(i+1)],v=n[2*(i+1)+1],y=-(p-m),b=d-f,y/=O=Math.sqrt(y*y+b*b),b/=O,y*=B,b*=B,_=-(m-v),x=f-g,_/=O=Math.sqrt(_*_+x*x),x/=O,C=(-y+d)*(-b+m)-(-y+f)*(-b+p),R=(-(_*=B)+g)*(-(x*=B)+m)-(-_+f)*(-x+v),M=(S=-b+p-(-b+m))*(j=-_+f-(-_+g))-(A=-x+v-(-x+m))*(E=-y+f-(-y+d)),Math.abs(M)<.1?(M+=10.1,D.push(f-y,m-b,k,U,V,N),D.push(f+y,m+b,k,U,V,N)):((u=(E*R-j*C)/M)-f)*(u-f)+((c=(A*C-S*R)/M)-m)+(c-m)>19600?(w=y-_,T=b-x,w/=O=Math.sqrt(w*w+T*T),T/=O,w*=B,T*=B,D.push(f-w,m-T),D.push(k,U,V,N),D.push(f+w,m+T),D.push(k,U,V,N),D.push(f-w,m-T),D.push(k,U,V,N),G++):(D.push(u,c),D.push(k,U,V,N),D.push(f-(u-f),m-(c-m)),D.push(k,U,V,N));for(d=n[2*(F-2)],p=n[2*(F-2)+1],f=n[2*(F-1)],y=-(p-(m=n[2*(F-1)+1])),b=d-f,y/=O=Math.sqrt(y*y+b*b),b/=O,y*=B,b*=B,D.push(f-y,m-b),D.push(k,U,V,N),D.push(f+y,m+b),D.push(k,U,V,N),P.push(L),i=0;G>i;i++)P.push(L++);P.push(L-1)}},n.prototype.buildComplexPoly=function(t,e){var i=t.points.slice();if(!(i.length<6)){var n=e.indices;e.points=i,e.alpha=t.fillAlpha,e.color=r.hex2rgb(t.fillColor);for(var o,s,a=1/0,l=-1/0,h=1/0,u=-1/0,c=0;c<i.length;c+=2)a=a>(o=i[c])?o:a,l=o>l?o:l,h=h>(s=i[c+1])?s:h,u=s>u?s:u;i.push(a,h,l,h,l,u,a,u);var d=i.length/2;for(c=0;d>c;c++)n.push(c)}},n.prototype.buildPoly=function(t,e){var i=t.points;if(!(i.length<6)){var n=e.points,o=e.indices,s=i.length/2,a=r.hex2rgb(t.fillColor),l=t.fillAlpha,h=a[0]*l,c=a[1]*l,d=a[2]*l,p=u(i,null,2);if(!p)return!1;var f=n.length/6,m=0;for(m=0;m<p.length;m+=3)o.push(p[m]+f),o.push(p[m]+f),o.push(p[m+1]+f),o.push(p[m+2]+f),o.push(p[m+2]+f);for(m=0;s>m;m++)n.push(i[2*m],i[2*m+1],h,c,d,l);return!0}}},{"../../const":20,"../../math":30,"../../renderers/webgl/WebGLRenderer":46,"../../renderers/webgl/utils/ObjectRenderer":60,"../../utils":74,"./WebGLGraphicsData":26,earcut:9}],26:[function(t,e,i){function n(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}n.prototype.constructor=n,e.exports=n,n.prototype.reset=function(){this.points.length=0,this.indices.length=0},n.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW),this.dirty=!1},n.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{}],27:[function(t,e,i){var n=e.exports=Object.assign(t("./const"),t("./math"),{utils:t("./utils"),ticker:t("./ticker"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Sprite:t("./sprites/Sprite"),ParticleContainer:t("./particles/ParticleContainer"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),ParticleRenderer:t("./particles/webgl/ParticleRenderer"),Text:t("./text/Text"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),TextureUvs:t("./textures/TextureUvs"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasGraphics:t("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:t("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),ShaderManager:t("./renderers/webgl/managers/ShaderManager"),Shader:t("./renderers/webgl/shaders/Shader"),ObjectRenderer:t("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:t("./renderers/webgl/utils/RenderTarget"),AbstractFilter:t("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:t("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:t("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(t,e,i,r){return t=t||800,e=e||600,!r&&n.utils.isWebGLSupported()?new n.WebGLRenderer(t,e,i):new n.CanvasRenderer(t,e,i)}})},{"./const":20,"./display/Container":21,"./display/DisplayObject":22,"./graphics/Graphics":23,"./graphics/GraphicsData":24,"./graphics/webgl/GraphicsRenderer":25,"./math":30,"./particles/ParticleContainer":36,"./particles/webgl/ParticleRenderer":38,"./renderers/canvas/CanvasRenderer":41,"./renderers/canvas/utils/CanvasBuffer":42,"./renderers/canvas/utils/CanvasGraphics":43,"./renderers/webgl/WebGLRenderer":46,"./renderers/webgl/filters/AbstractFilter":47,"./renderers/webgl/filters/FXAAFilter":48,"./renderers/webgl/filters/SpriteMaskFilter":49,"./renderers/webgl/managers/ShaderManager":53,"./renderers/webgl/shaders/Shader":58,"./renderers/webgl/utils/ObjectRenderer":60,"./renderers/webgl/utils/RenderTarget":62,"./sprites/Sprite":64,"./sprites/webgl/SpriteRenderer":65,"./text/Text":66,"./textures/BaseTexture":67,"./textures/RenderTexture":68,"./textures/Texture":69,"./textures/TextureUvs":70,"./textures/VideoBaseTexture":71,"./ticker":73,"./utils":74}],28:[function(t,e,i){function n(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var r=t("./Point");n.prototype.constructor=n,e.exports=n,n.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},n.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},n.prototype.apply=function(t,e){e=e||new r;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},n.prototype.applyInverse=function(t,e){e=e||new r;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return e.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},n.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},n.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},n.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,o=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},n.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this},n.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},n.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,o=t*n-e*i;return this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-n*r)/o,this.ty=-(t*this.ty-e*r)/o,this},n.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.prototype.clone=function(){var t=new n;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n.IDENTITY=new n,n.TEMP_MATRIX=new n},{"./Point":29}],29:[function(t,e,i){function n(t,e){this.x=t||0,this.y=e||0}n.prototype.constructor=n,e.exports=game.Vector||n,n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copy=function(t){this.set(t.x,t.y)},n.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},n.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}},{}],30:[function(t,e,i){e.exports={Point:t("./Point"),Matrix:t("./Matrix"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./Matrix":28,"./Point":29,"./shapes/Circle":31,"./shapes/Ellipse":32,"./shapes/Polygon":33,"./shapes/Rectangle":34,"./shapes/RoundedRectangle":35}],31:[function(t,e,i){function n(t,e,i){this.x=t||0,this.y=e||0,this.radius=i||0,this.type=o.SHAPES.CIRC}var r=t("./Rectangle"),o=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.radius)},n.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,n=this.y-e;return this.radius*this.radius>=(i*=i)+(n*=n)},n.prototype.getBounds=function(){return new r(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":20,"./Rectangle":34}],32:[function(t,e,i){function n(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.type=o.SHAPES.ELIP}var r=t("./Rectangle"),o=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return 1>=(i*=i)+(n*=n)},n.prototype.getBounds=function(){return new r(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":20,"./Rectangle":34}],33:[function(t,e,i){function n(t){var e=t;if(!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}if(e[0]instanceof r){for(var n=[],s=0,a=e.length;a>s;s++)n.push(e[s].x,e[s].y);e=n}this.closed=!0,this.points=e,this.type=o.SHAPES.POLY}var r=t("../Point"),o=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.points.slice())},n.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,r=0,o=n-1;n>r;o=r++){var s=this.points[2*r],a=this.points[2*r+1],l=this.points[2*o],h=this.points[2*o+1];a>e!=h>e&&(l-s)*(e-a)/(h-a)+s>t&&(i=!i)}return i}},{"../../const":20,"../Point":29}],34:[function(t,e,i){function n(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.type=r.SHAPES.RECT}var r=t("../../const");n.prototype.constructor=n,e.exports=n,n.EMPTY=new n(0,0,0,0),n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}},{"../../const":20}],35:[function(t,e,i){function n(t,e,i,n,o){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this.radius=o||20,this.type=r.SHAPES.RREC}var r=t("../../const");n.prototype.constructor=n,e.exports=n,n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)},n.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height)}},{"../../const":20}],36:[function(t,e,i){function n(t,e,i){r.call(this);(i=i||15e3)>16384&&(i=16384),i>(t=t||15e3)&&(i=t),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=o.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(e)}var r=t("../display/Container"),o=t("../const");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},n.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},n.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},n.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,n=!0,r=0,o=0,s=0,a=0;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible){var u=h.texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),n=!1),r=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,o=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,s=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var c=h.worldTransform;t.roundPixels?e.setTransform(c.a,c.b,c.c,c.d,0|c.tx,0|c.ty):e.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),r=h.anchor.x*-u.width+.5,o=h.anchor.y*-u.height+.5,s=u.width,a=u.height}e.drawImage(h.texture.baseTexture.source,u.x,u.y,u.width,u.height,r,o,s,a)}}}},n.prototype.destroy=function(){if(r.prototype.destroy.apply(this,arguments),this._buffers)for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._properties=null,this._buffers=null}},{"../const":20,"../display/Container":21}],37:[function(t,e,i){function n(t,e,i,n){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<e.length;r++){var o=e[r];i[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}n.prototype.constructor=n,e.exports=n,n.prototype.initBuffers=function(){var t,e,i=this.gl,n=0;for(this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)(e=this.dynamicProperties[t]).offset=n,n+=e.size,this.dynamicStride+=e.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),i.bufferData(i.ARRAY_BUFFER,this.dynamicData,i.DYNAMIC_DRAW);var r=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)(e=this.staticProperties[t]).offset=r,r+=e.size,this.staticStride+=e.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),i.bufferData(i.ARRAY_BUFFER,this.staticData,i.DYNAMIC_DRAW)},n.prototype.uploadDynamic=function(t,e,i){for(var n=this.gl,r=0;r<this.dynamicProperties.length;r++){var o=this.dynamicProperties[r];o.uploadFunction(t,e,i,this.dynamicData,this.dynamicStride,o.offset)}n.bindBuffer(n.ARRAY_BUFFER,this.dynamicBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.dynamicData)},n.prototype.uploadStatic=function(t,e,i){for(var n=this.gl,r=0;r<this.staticProperties.length;r++){var o=this.staticProperties[r];o.uploadFunction(t,e,i,this.staticData,this.staticStride,o.offset)}n.bindBuffer(n.ARRAY_BUFFER,this.staticBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.staticData)},n.prototype.bind=function(){var t,e,i=this.gl;for(i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],i.vertexAttribPointer(e.attribute,e.size,i.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],i.vertexAttribPointer(e.attribute,e.size,i.FLOAT,!1,4*this.staticStride,4*e.offset)},n.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)}},{}],38:[function(t,e,i){function n(t){r.call(this,t);this.indices=new Uint16Array(98304);for(var e=0,i=0;98304>e;e+=6,i+=4)this.indices[e+0]=i+0,this.indices[e+1]=i+1,this.indices[e+2]=i+2,this.indices[e+3]=i+0,this.indices[e+4]=i+2,this.indices[e+5]=i+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new l.Matrix}var r=t("../../renderers/webgl/utils/ObjectRenderer"),o=t("../../renderers/webgl/WebGLRenderer"),s=t("./ParticleShader"),a=t("./ParticleBuffer"),l=t("../../math");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,o.registerPlugin("particle",n),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new s(this.renderer.shaderManager),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},n.prototype.start=function(){var t=this.renderer.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shader;this.renderer.shaderManager.setShader(e)},n.prototype.render=function(t){var e=t.children,i=e.length,n=t._maxSize,r=t._batchSize;if(0!==i){i>n&&(i=n),t._buffers||(t._buffers=this.generateBuffers(t)),this.renderer.blendModeManager.setBlendMode(t.blendMode);var o=this.renderer.gl,s=t.worldTransform.copy(this.tempMatrix);s.prepend(this.renderer.currentRenderTarget.projectionMatrix),o.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,s.toArray(!0)),o.uniform1f(this.shader.uniforms.uAlpha._location,t.worldAlpha);var a=e[0]._texture.baseTexture;if(a._glTextures[o.id])o.bindTexture(o.TEXTURE_2D,a._glTextures[o.id]);else{if(!this.renderer.updateTexture(a))return;t._properties[0]&&t._properties[3]||(t._bufferToUpdate=0)}for(var l=0,h=0;i>l;l+=r,h+=1){var u=i-l;u>r&&(u=r);var c=t._buffers[h];c.uploadDynamic(e,l,u),t._bufferToUpdate===h&&(c.uploadStatic(e,l,u),t._bufferToUpdate=h+1),c.bind(this.shader),o.drawElements(o.TRIANGLES,6*u,o.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},n.prototype.generateBuffers=function(t){var e,i=this.renderer.gl,n=[],r=t._maxSize,o=t._batchSize,s=t._properties;for(e=0;r>e;e+=o)n.push(new a(i,this.properties,s,o));return n},n.prototype.uploadVertices=function(t,e,i,n,r,o){for(var s,a,l,h,u,c,d,p,f,m=0;i>m;m++)a=(s=t[e+m])._texture,h=s.scale.x,u=s.scale.y,a.trim?(c=(d=(l=a.trim).x-s.anchor.x*l.width)+a.crop.width,p=(f=l.y-s.anchor.y*l.height)+a.crop.height):(c=a._frame.width*(1-s.anchor.x),d=a._frame.width*-s.anchor.x,p=a._frame.height*(1-s.anchor.y),f=a._frame.height*-s.anchor.y),n[o]=d*h,n[o+1]=f*u,n[o+r]=c*h,n[o+r+1]=f*u,n[o+2*r]=c*h,n[o+2*r+1]=p*u,n[o+3*r]=d*h,n[o+3*r+1]=p*u,o+=4*r},n.prototype.uploadPosition=function(t,e,i,n,r,o){for(var s=0;i>s;s++){var a=t[e+s].position;n[o]=a.x,n[o+1]=a.y,n[o+r]=a.x,n[o+r+1]=a.y,n[o+2*r]=a.x,n[o+2*r+1]=a.y,n[o+3*r]=a.x,n[o+3*r+1]=a.y,o+=4*r}},n.prototype.uploadRotation=function(t,e,i,n,r,o){for(var s=0;i>s;s++){var a=t[e+s].rotation;n[o]=a,n[o+r]=a,n[o+2*r]=a,n[o+3*r]=a,o+=4*r}},n.prototype.uploadUvs=function(t,e,i,n,r,o){for(var s=0;i>s;s++){var a=t[e+s]._texture._uvs;a?(n[o]=a.x0,n[o+1]=a.y0,n[o+r]=a.x1,n[o+r+1]=a.y1,n[o+2*r]=a.x2,n[o+2*r+1]=a.y2,n[o+3*r]=a.x3,n[o+3*r+1]=a.y3,o+=4*r):(n[o]=0,n[o+1]=0,n[o+r]=0,n[o+r+1]=0,n[o+2*r]=0,n[o+2*r+1]=0,n[o+3*r]=0,n[o+3*r+1]=0,o+=4*r)}},n.prototype.uploadAlpha=function(t,e,i,n,r,o){for(var s=0;i>s;s++){var a=t[e+s].alpha;n[o]=a,n[o+r]=a,n[o+2*r]=a,n[o+3*r]=a,o+=4*r}},n.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../math":30,"../../renderers/webgl/WebGLRenderer":46,"../../renderers/webgl/utils/ObjectRenderer":60,"./ParticleBuffer":37,"./ParticleShader":39}],39:[function(t,e,i){function n(t){r.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var r=t("../../renderers/webgl/shaders/TextureShader");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n},{"../../renderers/webgl/shaders/TextureShader":59}],40:[function(t,e,i){function n(t,e,i,n){if(a.call(this),r.sayHello(t),n)for(var l in s.DEFAULT_RENDER_OPTIONS)void 0===n[l]&&(n[l]=s.DEFAULT_RENDER_OPTIONS[l]);else n=s.DEFAULT_RENDER_OPTIONS;this.type=s.RENDERER_TYPE.UNKNOWN,this.width=e||800,this.height=i||600,this.view=n.view||document.createElement("canvas"),this.resolution=n.resolution,this.transparent=n.transparent,this.autoResize=n.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=n.preserveDrawingBuffer,this.clearBeforeRender=n.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=n.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new o.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var r=t("../utils"),o=t("../math"),s=t("../const"),a=t("eventemitter3");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=r.hex2string(t),r.hex2rgb(t,this._backgroundColorRgb)}}}),n.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},n.prototype.destroy=function(t){t&&this.view.parent&&this.view.parent.removeChild(this.view),this.type=s.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":20,"../math":30,"../utils":74,eventemitter3:10}],41:[function(t,e,i){function n(t,e,i){i=i||{},r.call(this,"Canvas",t,e,i),this.type=l.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new o,this.roundPixels=i.roundPixels,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new a.Matrix,worldAlpha:1},this.resize(t,e)}var r=t("../SystemRenderer"),o=t("./utils/CanvasMaskManager"),s=t("../../utils"),a=t("../../math"),l=t("../../const");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,s.pluginTarget.mixin(n),n.prototype.render=function(t){var e=t.parent;this._lastObjectRendered=t,t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[l.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t,this.context)},n.prototype.destroy=function(t){this.destroyPlugins(),r.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.roundPixels=!1,this.smoothProperty=null},n.prototype.renderDisplayObject=function(t,e){var i=this.context;this.context=e,t.renderCanvas(this),this.context=i},n.prototype.resize=function(t,e){r.prototype.resize.call(this,t,e),this.smoothProperty&&(this.context[this.smoothProperty]=l.SCALE_MODES.DEFAULT===l.SCALE_MODES.LINEAR)},n.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},s.canUseNewCanvasBlendModes()?(this.blendModes[l.BLEND_MODES.NORMAL]="source-over",this.blendModes[l.BLEND_MODES.ADD]="lighter",this.blendModes[l.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[l.BLEND_MODES.SCREEN]="screen",this.blendModes[l.BLEND_MODES.OVERLAY]="overlay",this.blendModes[l.BLEND_MODES.DARKEN]="darken",this.blendModes[l.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[l.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[l.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[l.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[l.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[l.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[l.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[l.BLEND_MODES.HUE]="hue",this.blendModes[l.BLEND_MODES.SATURATION]="saturate",this.blendModes[l.BLEND_MODES.COLOR]="color",this.blendModes[l.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[l.BLEND_MODES.NORMAL]="source-over",this.blendModes[l.BLEND_MODES.ADD]="lighter",this.blendModes[l.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[l.BLEND_MODES.SCREEN]="source-over",this.blendModes[l.BLEND_MODES.OVERLAY]="source-over",this.blendModes[l.BLEND_MODES.DARKEN]="source-over",this.blendModes[l.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[l.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[l.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[l.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[l.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[l.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[l.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[l.BLEND_MODES.HUE]="source-over",this.blendModes[l.BLEND_MODES.SATURATION]="source-over",this.blendModes[l.BLEND_MODES.COLOR]="source-over",this.blendModes[l.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":20,"../../math":30,"../../utils":74,"../SystemRenderer":40,"./utils/CanvasMaskManager":44}],42:[function(t,e,i){function n(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e}n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),n.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e},n.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],43:[function(t,e,i){var n=t("../../../const"),r={};e.exports=r,r.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],s=o.shape,a=o._fillTint,l=o._lineTint;if(e.lineWidth=o.lineWidth,o.type===n.SHAPES.POLY){e.beginPath();var h=s.points;e.moveTo(h[0],h[1]);for(var u=1;u<h.length/2;u++)e.lineTo(h[2*u],h[2*u+1]);s.closed&&e.lineTo(h[0],h[1]),h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|l).toString(16)).substr(-6),e.stroke())}else if(o.type===n.SHAPES.RECT)(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fillRect(s.x,s.y,s.width,s.height)),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|l).toString(16)).substr(-6),e.strokeRect(s.x,s.y,s.width,s.height));else if(o.type===n.SHAPES.CIRC)e.beginPath(),e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|l).toString(16)).substr(-6),e.stroke());else if(o.type===n.SHAPES.ELIP){var c=2*s.width,d=2*s.height,p=s.x-c/2,f=s.y-d/2;e.beginPath();var m=.5522848,g=c/2*m,v=d/2*m,y=p+c,b=f+d,_=p+c/2,x=f+d/2;e.moveTo(p,x),e.bezierCurveTo(p,x-v,_-g,f,_,f),e.bezierCurveTo(_+g,f,y,x-v,y,x),e.bezierCurveTo(y,x+v,_+g,b,_,b),e.bezierCurveTo(_-g,b,p,x+v,p,x),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|l).toString(16)).substr(-6),e.stroke())}else if(o.type===n.SHAPES.RREC){var w=s.x,T=s.y,S=s.width,E=s.height,C=s.radius,A=Math.min(S,E)/2|0;C=C>A?A:C,e.beginPath(),e.moveTo(w,T+C),e.lineTo(w,T+E-C),e.quadraticCurveTo(w,T+E,w+C,T+E),e.lineTo(w+S-C,T+E),e.quadraticCurveTo(w+S,T+E,w+S,T+E-C),e.lineTo(w+S,T+C),e.quadraticCurveTo(w+S,T,w+S-C,T),e.lineTo(w+C,T),e.quadraticCurveTo(w,T,w,T+C),e.closePath(),(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|l).toString(16)).substr(-6),e.stroke())}}},r.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var r=0;i>r;r++){var o=t.graphicsData[r],s=o.shape;if(o.type===n.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var l=1;l<a.length/2;l++)e.lineTo(a[2*l],a[2*l+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(o.type===n.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(o.type===n.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(o.type===n.SHAPES.ELIP){var h=2*s.width,u=2*s.height,c=s.x-h/2,d=s.y-u/2,p=.5522848,f=h/2*p,m=u/2*p,g=c+h,v=d+u,y=c+h/2,b=d+u/2;e.moveTo(c,b),e.bezierCurveTo(c,b-m,y-f,d,y,d),e.bezierCurveTo(y+f,d,g,b-m,g,b),e.bezierCurveTo(g,b+m,y+f,v,y,v),e.bezierCurveTo(y-f,v,c,b+m,c,b),e.closePath()}else if(o.type===n.SHAPES.RREC){var _=s.x,x=s.y,w=s.width,T=s.height,S=s.radius,E=Math.min(w,T)/2|0;S=S>E?E:S,e.moveTo(_,x+S),e.lineTo(_,x+T-S),e.quadraticCurveTo(_,x+T,_+S,x+T),e.lineTo(_+w-S,x+T),e.quadraticCurveTo(_+w,x+T,_+w,x+T-S),e.lineTo(_+w,x+S),e.quadraticCurveTo(_+w,x,_+w-S,x),e.lineTo(_+S,x),e.quadraticCurveTo(_,x,_,x+S),e.closePath()}}}},r.updateGraphicsTint=function(t){if(16777215!==t.tint||t._prevTint!==t.tint){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,r=0;r<t.graphicsData.length;r++){var o=t.graphicsData[r],s=0|o.fillColor,a=0|o.lineColor;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}}}},{"../../../const":20}],44:[function(t,e,i){function n(){}var r=t("./CanvasGraphics");n.prototype.constructor=n,e.exports=n,n.prototype.pushMask=function(t,e){e.context.save();var i=t.alpha,n=t.worldTransform,o=e.resolution;e.context.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t.texture||(r.renderGraphicsMask(t,e.context),e.context.clip()),t.worldAlpha=i},n.prototype.popMask=function(t){t.context.restore()},n.prototype.destroy=function(){}},{"./CanvasGraphics":43}],45:[function(t,e,i){var n=t("../../../utils"),r={};e.exports=r,r.getTintedTexture=function(t,e){var i=t.texture,n="#"+("00000"+(0|(e=r.roundColor(e))).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[n])return i.tintCache[n];var o=r.canvas||document.createElement("canvas");if(r.tintMethod(i,e,o),r.convertTintToImage){var s=new Image;s.src=o.toDataURL(),i.tintCache[n]=s}else i.tintCache[n]=o,r.canvas=null;return o},r.tintWithMultiply=function(t,e,i){var n=i.getContext("2d"),r=t.baseTexture.resolution,o=t.crop.clone();o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=o.width,i.height=o.height,n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},r.tintWithOverlay=function(t,e,i){var n=i.getContext("2d"),r=t.baseTexture.resolution,o=t.crop.clone();o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=o.width,i.height=o.height,n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},r.tintWithPerPixel=function(t,e,i){var r=i.getContext("2d"),o=t.baseTexture.resolution,s=t.crop.clone();s.x*=o,s.y*=o,s.width*=o,s.height*=o,i.width=s.width,i.height=s.height,r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height);for(var a=n.hex2rgb(e),l=a[0],h=a[1],u=a[2],c=r.getImageData(0,0,s.width,s.height),d=c.data,p=0;p<d.length;p+=4)d[p+0]*=l,d[p+1]*=h,d[p+2]*=u;r.putImageData(c,0,0)},r.roundColor=function(t){var e=r.cacheStepsPerColorChannel,i=n.hex2rgb(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),n.rgb2hex(i)},r.cacheStepsPerColorChannel=8,r.convertTintToImage=!1,r.canUseMultiply=n.canUseNewCanvasBlendModes(),r.tintMethod=r.canUseMultiply?r.tintWithMultiply:r.tintWithPerPixel},{"../../../utils":74}],46:[function(t,e,i){function n(t,e,i){i=i||{},r.call(this,"WebGL",t,e,i),this.type=f.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!i.forceFXAA&&i.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new o(this),this.maskManager=new s(this),this.stencilManager=new a(this),this.filterManager=new l(this),this.blendModeManager=new h(this),this.currentRenderTarget=null,this.currentRenderer=new c(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._renderTargetStack=[]}var r=t("../SystemRenderer"),o=t("./managers/ShaderManager"),s=t("./managers/MaskManager"),a=t("./managers/StencilManager"),l=t("./managers/FilterManager"),h=t("./managers/BlendModeManager"),u=t("./utils/RenderTarget"),c=t("./utils/ObjectRenderer"),d=t("./filters/FXAAFilter"),p=t("../../utils"),f=t("../../const");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,p.pluginTarget.mixin(n),n.glContextId=0,n.prototype._createContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=n.glContextId++,t.id=this.glContextId,t.renderer=this},n.prototype._initContext=function(){var t=this.gl;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.renderTarget=new u(t,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",t),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!t.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new d])},n.prototype.render=function(t){if(!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=t,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,t.filterArea=this.renderTarget.size,t.filters=this._FXAAFilter);var e=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e;var i=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?i.clearColor(0,0,0,0):i.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),i.clear(i.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.renderTarget)}},n.prototype.renderDisplayObject=function(t,e,i){this.setRenderTarget(e),i&&e.clear(),this.filterManager.setFilterStack(e.filterStack),t.renderWebGL(this),this.currentRenderer.flush()},n.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},n.prototype.setRenderTarget=function(t){this.currentRenderTarget!==t&&(this.currentRenderTarget=t,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(t.stencilMaskStack))},n.prototype.resize=function(t,e){r.prototype.resize.call(this,t,e),this.filterManager.resize(t,e),this.renderTarget.resize(t,e),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},n.prototype.updateTexture=function(t){if((t=t.baseTexture||t).hasLoaded){var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture(),t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this)),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===f.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._glTextures[e.id]}},n.prototype.destroyTexture=function(t){(t=t.baseTexture||t).hasLoaded&&t._glTextures[this.gl.id]&&this.gl.deleteTexture(t._glTextures[this.gl.id])},n.prototype.handleContextLost=function(t){t.preventDefault()},n.prototype.handleContextRestored=function(){for(var t in this._initContext(),p.BaseTextureCache)p.BaseTextureCache[t]._glTextures.length=0},n.prototype.destroy=function(t){for(var e in this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),p.BaseTextureCache){var i=p.BaseTextureCache[e];i.off("update",this.updateTexture,this),i.off("dispose",this.destroyTexture,this)}r.prototype.destroy.call(this,t),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.drawCount=0,this.gl=null},n.prototype._mapGlModes=function(){var t=this.gl;this.blendModes||(this.blendModes={},this.blendModes[f.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],this.blendModes[f.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SCREEN]=[t.SRC_ALPHA,t.ONE],this.blendModes[f.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[f.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[f.DRAW_MODES.POINTS]=t.POINTS,this.drawModes[f.DRAW_MODES.LINES]=t.LINES,this.drawModes[f.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,this.drawModes[f.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,this.drawModes[f.DRAW_MODES.TRIANGLES]=t.TRIANGLES,this.drawModes[f.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,this.drawModes[f.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN)}},{"../../const":20,"../../utils":74,"../SystemRenderer":40,"./filters/FXAAFilter":48,"./managers/BlendModeManager":50,"./managers/FilterManager":51,"./managers/MaskManager":52,"./managers/ShaderManager":53,"./managers/StencilManager":54,"./utils/ObjectRenderer":60,"./utils/RenderTarget":62}],47:[function(t,e,i){function n(t,e,i){this.shaders=[],this.padding=0,this.uniforms=i||{},this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=e||r.defaultFragmentSrc}var r=t("../shaders/TextureShader");n.prototype.constructor=n,e.exports=n,n.prototype.getShader=function(t){var e=t.gl,i=this.shaders[e.id];return i||(i=new r(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[e.id]=i),i},n.prototype.applyFilter=function(t,e,i,n){var r=this.getShader(t);t.filterManager.applyFilter(r,e,i,n)},n.prototype.syncUniform=function(t){for(var e=0,i=this.shaders.length;i>e;++e)this.shaders[e].syncUniform(t)}},{"../shaders/TextureShader":59}],48:[function(t,e,i){function n(){r.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var r=t("./AbstractFilter");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager,r=this.getShader(t);n.applyFilter(r,e,i)}},{"./AbstractFilter":47}],49:[function(t,e,i){function n(t){var e=new o.Matrix;r.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:t._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:e.toArray(!0)}}),this.maskSprite=t,this.maskMatrix=e}var r=t("./AbstractFilter"),o=t("../../../math");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture,n.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var r=this.getShader(t);n.applyFilter(r,e,i)},Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})},{"../../../math":30,"./AbstractFilter":47}],50:[function(t,e,i){function n(t){r.call(this,t),this.currentBlendMode=99999}var r=t("./WebGLManager");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(e[0],e[1]),!0}},{"./WebGLManager":55}],51:[function(t,e,i){function n(t){r.call(this,t),this.filterStack=[],this.filterStack.push({renderTarget:t.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new l.Rectangle(0,0,t.width,t.height),this.currentFrame=null}var r=t("./WebGLManager"),o=t("../utils/RenderTarget"),s=t("../../../const"),a=t("../utils/Quad"),l=t("../../../math");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.onContextChange=function(){this.texturePool.length=0;var t=this.renderer.gl;this.quad=new a(t)},n.prototype.setFilterStack=function(t){this.filterStack=t},n.prototype.pushFilter=function(t,e){var i=t.filterArea?t.filterArea.clone():t.getBounds();i.x=0|i.x,i.y=0|i.y,i.width=0|i.width,i.height=0|i.height;var n=0|e[0].padding;if(i.x-=n,i.y-=n,i.width+=2*n,i.height+=2*n,this.renderer.currentRenderTarget.transform){var r=this.renderer.currentRenderTarget.transform;i.x+=r.tx,i.y+=r.ty,this.capFilterArea(i),i.x-=r.tx,i.y-=r.ty}else this.capFilterArea(i);if(i.width>0&&i.height>0){this.currentFrame=i;var o=this.getRenderTarget();this.renderer.setRenderTarget(o),o.clear(),this.filterStack.push({renderTarget:o,filter:e})}else this.filterStack.push({renderTarget:null,filter:e})},n.prototype.popFilter=function(){var t=this.filterStack.pop(),e=this.filterStack[this.filterStack.length-1],i=t.renderTarget;if(t.renderTarget){var n=e.renderTarget,r=this.renderer.gl;this.currentFrame=i.frame,this.quad.map(this.textureSize,i.frame),r.bindBuffer(r.ARRAY_BUFFER,this.quad.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var o=t.filter;if(r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,r.FLOAT,!1,0,0),r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,r.FLOAT,!1,0,32),r.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,r.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(s.BLEND_MODES.NORMAL),1===o.length)o[0].uniforms.dimensions&&(o[0].uniforms.dimensions.value[0]=this.renderer.width,o[0].uniforms.dimensions.value[1]=this.renderer.height,o[0].uniforms.dimensions.value[2]=this.quad.vertices[0],o[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),o[0].applyFilter(this.renderer,i,n),this.returnRenderTarget(i);else{for(var a=i,l=this.getRenderTarget(!0),h=0;h<o.length-1;h++){var u=o[h];u.uniforms.dimensions&&(u.uniforms.dimensions.value[0]=this.renderer.width,u.uniforms.dimensions.value[1]=this.renderer.height,u.uniforms.dimensions.value[2]=this.quad.vertices[0],u.uniforms.dimensions.value[3]=this.quad.vertices[5]),u.applyFilter(this.renderer,a,l);var c=a;a=l,l=c}o[o.length-1].applyFilter(this.renderer,a,n),this.returnRenderTarget(a),this.returnRenderTarget(l)}return t.filter}},n.prototype.getRenderTarget=function(t){var e=this.texturePool.pop()||new o(this.renderer.gl,this.textureSize.width,this.textureSize.height,s.SCALE_MODES.LINEAR,this.renderer.resolution*s.FILTER_RESOLUTION);return e.frame=this.currentFrame,t&&e.clear(!0),e},n.prototype.returnRenderTarget=function(t){this.texturePool.push(t)},n.prototype.applyFilter=function(t,e,i,n){var r=this.renderer.gl;this.renderer.setRenderTarget(i),n&&i.clear(),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.texture),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),this.renderer.drawCount++},n.prototype.calculateMappedMatrix=function(t,e,i){var n=e.worldTransform.copy(l.Matrix.TEMP_MATRIX),r=e._texture.baseTexture,o=i.identity(),s=this.textureSize.height/this.textureSize.width;o.translate(t.x/this.textureSize.width,t.y/this.textureSize.height),o.scale(1,s);var a=this.textureSize.width/r.width,h=this.textureSize.height/r.height;return n.tx/=r.width*a,n.ty/=r.width*a,n.invert(),o.prepend(n),o.scale(1,1/s),o.scale(a,h),o.translate(e.anchor.x,e.anchor.y),o},n.prototype.capFilterArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.textureSize.width&&(t.width=this.textureSize.width-t.x),t.y+t.height>this.textureSize.height&&(t.height=this.textureSize.height-t.y)},n.prototype.resize=function(t,e){this.textureSize.width=t,this.textureSize.height=e;for(var i=0;i<this.texturePool.length;i++)this.texturePool[i].resize(t,e)},n.prototype.destroy=function(){r.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null}},{"../../../const":20,"../../../math":30,"../utils/Quad":61,"../utils/RenderTarget":62,"./WebGLManager":55}],52:[function(t,e,i){function n(t){r.call(this,t),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var r=t("./WebGLManager"),o=t("../filters/SpriteMaskFilter");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.pushMask=function(t,e){e.texture?this.pushSpriteMask(t,e):this.pushStencilMask(t,e)},n.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.popStencilMask(t,e)},n.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool.pop();i||(i=[new o(e)]),i[0].maskSprite=e,this.renderer.filterManager.pushFilter(t,i)},n.prototype.popSpriteMask=function(){var t=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(t)},n.prototype.pushStencilMask=function(t,e){this.renderer.stencilManager.pushMask(e)},n.prototype.popStencilMask=function(t,e){this.renderer.stencilManager.popMask(e)}},{"../filters/SpriteMaskFilter":49,"./WebGLManager":55}],53:[function(t,e,i){function n(t){r.call(this,t),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var r=t("./WebGLManager"),o=t("../shaders/TextureShader"),s=t("../shaders/ComplexPrimitiveShader"),a=t("../shaders/PrimitiveShader"),l=t("../../../utils");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,l.pluginTarget.mixin(n),e.exports=n,n.prototype.onContextChange=function(){this.initPlugins();var t=this.renderer.gl;this.maxAttibs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.defaultShader=new o(this),this.primitiveShader=new a(this),this.complexPrimitiveShader=new s(this)},n.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(var i in t)this.tempAttribState[t[i]]=!0;var n=this.renderer.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.attribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},n.prototype.setShader=function(t){return this._currentId!==t.uid&&(this._currentId=t.uid,this.currentShader=t,this.renderer.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},n.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),r.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":74,"../shaders/ComplexPrimitiveShader":56,"../shaders/PrimitiveShader":57,"../shaders/TextureShader":59,"./WebGLManager":55}],54:[function(t,e,i){function n(t){r.call(this,t),this.stencilMaskStack=null}var r=t("./WebGLManager"),o=t("../../../utils");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.stencilStack.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},n.prototype.pushStencil=function(t,e){this.renderer.currentRenderTarget.attachStencilBuffer();var i=this.renderer.gl,n=this.stencilMaskStack;this.bindGraphics(t,e),0===n.stencilStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),n.reverse=!0,n.count=0),n.stencilStack.push(e);var r=n.count;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),1===e.mode?(i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),n.reverse?(i.stencilFunc(i.EQUAL,255-r,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,r,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),n.reverse?i.stencilFunc(i.EQUAL,255-(r+1),255):i.stencilFunc(i.EQUAL,r+1,255),n.reverse=!n.reverse):(n.reverse?(i.stencilFunc(i.EQUAL,r,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,255-r,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),n.reverse?i.stencilFunc(i.EQUAL,r+1,255):i.stencilFunc(i.EQUAL,255-(r+1),255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),n.count++},n.prototype.bindGraphics=function(t,e){var i,n=this.renderer.gl;1===e.mode?(i=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(i),n.uniformMatrix3fv(i.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(i.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(i.uniforms.tint._location,o.hex2rgb(t.tint)),n.uniform3fv(i.uniforms.color._location,e.color),n.uniform1f(i.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(i.attributes.aVertexPosition,2,n.FLOAT,!1,8,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(i=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(i),n.uniformMatrix3fv(i.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),n.uniformMatrix3fv(i.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),n.uniform3fv(i.uniforms.tint._location,o.hex2rgb(t.tint)),n.uniform1f(i.uniforms.alpha._location,t.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,e.buffer),n.vertexAttribPointer(i.attributes.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(i.attributes.aColor,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},n.prototype.popStencil=function(t,e){var i=this.renderer.gl,n=this.stencilMaskStack;if(n.stencilStack.pop(),n.count--,0===n.stencilStack.length)i.disable(i.STENCIL_TEST);else{var r=n.count;this.bindGraphics(t,e),i.colorMask(!1,!1,!1,!1),1===e.mode?(n.reverse=!n.reverse,n.reverse?(i.stencilFunc(i.EQUAL,255-(r+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,r+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(e.indices.length-4)),i.stencilFunc(i.ALWAYS,0,255),i.stencilOp(i.KEEP,i.KEEP,i.INVERT),i.drawElements(i.TRIANGLE_FAN,e.indices.length-4,i.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,n.reverse?i.stencilFunc(i.EQUAL,r,255):i.stencilFunc(i.EQUAL,255-r,255)):(n.reverse?(i.stencilFunc(i.EQUAL,r+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)):(i.stencilFunc(i.EQUAL,255-(r+1),255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)),i.drawElements(i.TRIANGLE_STRIP,e.indices.length,i.UNSIGNED_SHORT,0),this.renderer.drawCount++,n.reverse?i.stencilFunc(i.EQUAL,r,255):i.stencilFunc(i.EQUAL,255-r,255)),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}},n.prototype.destroy=function(){r.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},n.prototype.pushMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),t.dirty&&this.renderer.plugins.graphics.updateGraphics(t,this.renderer.gl),t._webGL[this.renderer.gl.id].data.length&&this.pushStencil(t,t._webGL[this.renderer.gl.id].data[0])},n.prototype.popMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(t,t._webGL[this.renderer.gl.id].data[0])}},{"../../../utils":74,"./WebGLManager":55}],55:[function(t,e,i){function n(t){this.renderer=t,this.renderer.on("context",this.onContextChange,this)}n.prototype.constructor=n,e.exports=n,n.prototype.onContextChange=function(){},n.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],56:[function(t,e,i){function n(t){r.call(this,t,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var r=t("./Shader");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n},{"./Shader":58}],57:[function(t,e,i){function n(t){r.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var r=t("./Shader");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n},{"./Shader":58}],58:[function(t,e,i){function n(t,e,i,n,o){if(!e||!i)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=r.uid(),this.gl=t.renderer.gl,this.shaderManager=t,this.program=null,this.uniforms=n||{},this.attributes=o||{},this.textureCount=1,this.vertexSrc=e,this.fragmentSrc=i,this.init()}var r=t("../../../utils");n.prototype.constructor=n,e.exports=n,n.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},n.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e)this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])},n.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e)this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])},n.prototype.compile=function(){var t=this.gl,e=this._glCompile(t.VERTEX_SHADER,this.vertexSrc),i=this._glCompile(t.FRAGMENT_SHADER,this.fragmentSrc),n=t.createProgram();return t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||(t.getProgramInfoLog(n),t.deleteProgram(n),n=null),t.deleteShader(e),t.deleteShader(i),this.program=n},n.prototype.syncUniform=function(t){var e,i,n=t._location,o=t.value,s=this.gl;switch(t.type){case"b":case"bool":case"boolean":s.uniform1i(n,o?1:0);break;case"i":case"1i":s.uniform1i(n,o);break;case"f":case"1f":s.uniform1f(n,o);break;case"2f":s.uniform2f(n,o[0],o[1]);break;case"3f":s.uniform3f(n,o[0],o[1],o[2]);break;case"4f":s.uniform4f(n,o[0],o[1],o[2],o[3]);break;case"v2":s.uniform2f(n,o.x,o.y);break;case"v3":s.uniform3f(n,o.x,o.y,o.z);break;case"v4":s.uniform4f(n,o.x,o.y,o.z,o.w);break;case"1iv":case"iv1":s.uniform1iv(n,o);break;case"2iv":s.uniform2iv(n,o);break;case"3iv":case"iv":s.uniform3iv(n,o);break;case"4iv":s.uniform4iv(n,o);break;case"1fv":case"fv1":s.uniform1fv(n,o);break;case"2fv":s.uniform2fv(n,o);break;case"3fv":case"fv":s.uniform3fv(n,o);break;case"4fv":s.uniform4fv(n,o);break;case"m2":case"mat2":case"Matrix2fv":s.uniformMatrix2fv(n,t.transpose,o);break;case"m3":case"mat3":case"Matrix3fv":s.uniformMatrix3fv(n,t.transpose,o);break;case"m4":case"mat4":case"Matrix4fv":s.uniformMatrix4fv(n,t.transpose,o);break;case"c":"number"==typeof o&&(o=r.hex2rgb(o)),s.uniform3f(n,o[0],o[1],o[2]);break;case"v2v":for(t._array||(t._array=new Float32Array(2*o.length)),e=0,i=o.length;i>e;++e)t._array[2*e]=o[e].x,t._array[2*e+1]=o[e].y;s.uniform2fv(n,t._array);break;case"v3v":for(t._array||(t._array=new Float32Array(3*o.length)),e=0,i=o.length;i>e;++e)t._array[3*e]=o[e].x,t._array[3*e+1]=o[e].y,t._array[3*e+2]=o[e].z;s.uniform3fv(n,t._array);break;case"v4v":for(t._array||(t._array=new Float32Array(4*o.length)),e=0,i=o.length;i>e;++e)t._array[4*e]=o[e].x,t._array[4*e+1]=o[e].y,t._array[4*e+2]=o[e].z,t._array[4*e+3]=o[e].w;s.uniform4fv(n,t._array);break;case"t":case"sampler2D":if(!t.value||!t.value.baseTexture.hasLoaded)break;s.activeTexture(s["TEXTURE"+this.textureCount]);var a=t.value.baseTexture._glTextures[s.id];a||(this.initSampler2D(t),a=t.value.baseTexture._glTextures[s.id]),s.bindTexture(s.TEXTURE_2D,a),s.uniform1i(t._location,this.textureCount),this.textureCount++}},n.prototype.syncUniforms=function(){for(var t in this.textureCount=1,this.uniforms)this.syncUniform(this.uniforms[t])},n.prototype.initSampler2D=function(t){var e=this.gl,i=t.value.baseTexture;if(i.hasLoaded)if(t.textureData){var n=t.textureData;i._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,i._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,n.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n.magFilter?n.magFilter:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n.wrapS?n.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,n.wrapS?n.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,n.wrapT?n.wrapT:e.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(i)},n.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},n.prototype._glCompile=function(t,e){var i=this.gl.createShader(t);return this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:null}},{"../../../utils":74}],59:[function(t,e,i){function n(t,e,i,o,s){var a={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(o)for(var l in o)a[l]=o[l];var h={aVertexPosition:0,aTextureCoord:0,aColor:0};if(s)for(var u in s)h[u]=s[u];e=e||n.defaultVertexSrc,i=i||n.defaultFragmentSrc,r.call(this,t,e,i,a,h)}var r=t("./Shader");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),n.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":58}],60:[function(t,e,i){function n(t){r.call(this,t)}var r=t("../managers/WebGLManager");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.start=function(){},n.prototype.stop=function(){this.flush()},n.prototype.flush=function(){},n.prototype.render=function(t){}},{"../managers/WebGLManager":55}],61:[function(t,e,i){function n(t){this.gl=t,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.upload()}n.prototype.constructor=n,n.prototype.map=function(t,e){var i=0,n=0;this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this.upload()},n.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)},e.exports=n},{}],62:[function(t,e,i){var n=t("../../../math"),r=t("../../../utils"),o=t("../../../const"),s=t("./StencilMaskStack"),a=function(t,e,i,a,l,h){(this.gl=t,this.frameBuffer=null,this.texture=null,this.size=new n.Rectangle(0,0,1,1),this.resolution=l||o.RESOLUTION,this.projectionMatrix=new n.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new s,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=a||o.SCALE_MODES.DEFAULT,this.root=h,this.root)||(this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),r.isPowerOfTwo(e,i)?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0));this.resize(e,i)};a.prototype.constructor=a,e.exports=a,a.prototype.clear=function(t){var e=this.gl;t&&e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},a.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var t=this.gl;this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},a.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=this.frame||this.size;this.calculateProjection(e),this.transform&&this.projectionMatrix.append(this.transform),t.viewport(0,0,e.width*this.resolution,e.height*this.resolution)},a.prototype.calculateProjection=function(t){var e=this.projectionMatrix;e.identity(),this.root?(e.a=1/t.width*2,e.d=-1/t.height*2,e.tx=-1-t.x*e.a,e.ty=1-t.y*e.d):(e.a=1/t.width*2,e.d=1/t.height*2,e.tx=-1-t.x*e.a,e.ty=-1-t.y*e.d)},a.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){if(this.size.width=t,this.size.height=e,!this.root){var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t*this.resolution,e*this.resolution,0,i.RGBA,i.UNSIGNED_BYTE,null),this.stencilBuffer&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencilBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t*this.resolution,e*this.resolution))}var n=this.frame||this.size;this.calculateProjection(n)}},a.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":20,"../../../math":30,"../../../utils":74,"./StencilMaskStack":63}],63:[function(t,e,i){function n(){this.stencilStack=[],this.reverse=!0,this.count=0}n.prototype.constructor=n,e.exports=n},{}],64:[function(t,e,i){function n(t){s.call(this),this.anchor=new r.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=h.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||o.EMPTY}var r=t("../math"),o=t("../textures/Texture"),s=t("../display/Container"),a=t("../renderers/canvas/utils/CanvasTinter"),l=t("../utils"),h=t("../const"),u=new r.Point;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(t){this.scale.x=l.sign(this.scale.x)*t/this.texture._frame.width,this._width=t}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(t){this.scale.y=l.sign(this.scale.y)*t/this.texture._frame.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),n.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=l.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=l.sign(this.scale.y)*this._height/this.texture.frame.height)},n.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},n.prototype.getBounds=function(t){if(!this._currentBounds){var e,i,n,r,o=this._texture._frame.width,s=this._texture._frame.height,a=o*(1-this.anchor.x),l=o*-this.anchor.x,h=s*(1-this.anchor.y),u=s*-this.anchor.y,c=t||this.worldTransform,d=c.a,p=c.b,f=c.c,m=c.d,g=c.tx,v=c.ty;if(0===p&&0===f)0>d&&(d*=-1),0>m&&(m*=-1),e=d*l+g,i=d*a+g,n=m*u+v,r=m*h+v;else{var y=d*l+f*u+g,b=m*u+p*l+v,_=d*a+f*u+g,x=m*u+p*a+v,w=d*a+f*h+g,T=m*h+p*a+v,S=d*l+f*h+g,E=m*h+p*l+v;e=(e=(e=(e=y)>_?_:e)>w?w:e)>S?S:e,n=(n=(n=(n=b)>x?x:n)>T?T:n)>E?E:n,i=S>(i=w>(i=_>(i=y)?_:i)?w:i)?S:i,r=E>(r=T>(r=x>(r=b)?x:r)?T:r)?E:r}if(this.children.length){var C=this.containerGetBounds();a=C.x,l=C.x+C.width,e=a>e?e:a,n=(h=C.y)>n?n:h,i=i>l?i:l,r=r>(u=C.y+C.height)?r:u}var A=this._bounds;A.x=e,A.width=i-e,A.y=n,A.height=r-n,this._currentBounds=A}return this._currentBounds},n.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e,i=this._texture._frame.width,n=this._texture._frame.height,r=-i*this.anchor.x;return u.x>r&&u.x<r+i&&(e=-n*this.anchor.y,u.y>e&&u.y<e+n)},n.prototype._renderCanvas=function(t){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var e=t.blendModes[this.blendMode];if(e!==t.context.globalCompositeOperation&&(t.context.globalCompositeOperation=e),this.texture.valid){var i,n,r,o,s=this._texture,l=this.worldTransform;t.context.globalAlpha=this.worldAlpha;var u=s.baseTexture.scaleMode===h.SCALE_MODES.LINEAR;if(t.smoothProperty&&t.context[t.smoothProperty]!==u&&(t.context[t.smoothProperty]=u),s.rotate){var c=l.a,d=l.b;l.a=-l.c,l.b=-l.d,l.c=c,l.d=d,r=s.crop.height,o=s.crop.width,i=s.trim?s.trim.y-this.anchor.y*s.trim.height:this.anchor.y*-s._frame.height,n=s.trim?s.trim.x-this.anchor.x*s.trim.width:this.anchor.x*-s._frame.width}else r=s.crop.width,o=s.crop.height,i=s.trim?s.trim.x-this.anchor.x*s.trim.width:this.anchor.x*-s._frame.width,n=s.trim?s.trim.y-this.anchor.y*s.trim.height:this.anchor.y*-s._frame.height;t.roundPixels?(t.context.setTransform(l.a,l.b,l.c,l.d,l.tx*t.resolution|0,l.ty*t.resolution|0),i|=0,n|=0):t.context.setTransform(l.a,l.b,l.c,l.d,l.tx*t.resolution,l.ty*t.resolution);var p=s.baseTexture.resolution;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=a.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,r*p,o*p,i*t.resolution,n*t.resolution,r*t.resolution,o*t.resolution)):t.context.drawImage(s.baseTexture.source,s.crop.x*p,s.crop.y*p,r*p,o*p,i*t.resolution,n*t.resolution,r*t.resolution,o*t.resolution)}}},n.prototype.destroy=function(t,e){s.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},n.fromFrame=function(t){var e=l.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new n(e)},n.fromImage=function(t,e,i){return new n(o.fromImage(t,e,i))}},{"../const":20,"../display/Container":21,"../math":30,"../renderers/canvas/utils/CanvasTinter":45,"../textures/Texture":69,"../utils":74}],65:[function(t,e,i){function n(t){r.call(this,t),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=s.SPRITE_BATCH_SIZE;var e=4*this.size*this.vertByteSize,i=6*this.size;this.vertices=new ArrayBuffer(e),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(i);for(var n=0,o=0;i>n;n+=6,o+=4)this.indices[n+0]=o+0,this.indices[n+1]=o+1,this.indices[n+2]=o+2,this.indices[n+3]=o+0,this.indices[n+4]=o+2,this.indices[n+5]=o+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var r=t("../../renderers/webgl/utils/ObjectRenderer"),o=t("../../renderers/webgl/WebGLRenderer"),s=t("../../const");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,o.registerPlugin("sprite",n),n.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},n.prototype.render=function(t){var e=t._texture;this.currentBatchSize>=this.size&&this.flush();var i=e._uvs;if(i){var n,r,o,s,a=t.anchor.x,l=t.anchor.y;if(e.trim&&void 0===t.tileScale){var h=e.trim;n=(r=h.x-a*h.width)+e.crop.width,o=(s=h.y-l*h.height)+e.crop.height}else n=e._frame.width*(1-a),r=e._frame.width*-a,o=e._frame.height*(1-l),s=e._frame.height*-l;var u=this.currentBatchSize*this.vertByteSize,c=t.worldTransform,d=c.a,p=c.b,f=c.c,m=c.d,g=c.tx,v=c.ty,y=this.colors,b=this.positions;this.renderer.roundPixels?(b[u]=d*r+f*s+g|0,b[u+1]=m*s+p*r+v|0,b[u+5]=d*n+f*s+g|0,b[u+6]=m*s+p*n+v|0,b[u+10]=d*n+f*o+g|0,b[u+11]=m*o+p*n+v|0,b[u+15]=d*r+f*o+g|0,b[u+16]=m*o+p*r+v|0):(b[u]=d*r+f*s+g,b[u+1]=m*s+p*r+v,b[u+5]=d*n+f*s+g,b[u+6]=m*s+p*n+v,b[u+10]=d*n+f*o+g,b[u+11]=m*o+p*n+v,b[u+15]=d*r+f*o+g,b[u+16]=m*o+p*r+v),b[u+2]=i.x0,b[u+3]=i.y0,b[u+7]=i.x1,b[u+8]=i.y1,b[u+12]=i.x2,b[u+13]=i.y2,b[u+17]=i.x3,b[u+18]=i.y3;var _=t.tint;y[u+4]=y[u+9]=y[u+14]=y[u+19]=(_>>16)+(65280&_)+((255&_)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t}},n.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e=this.renderer.gl;if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var i=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);e.bufferSubData(e.ARRAY_BUFFER,0,i)}for(var n,r,o,s,a=0,l=0,h=null,u=this.renderer.blendModeManager.currentBlendMode,c=null,d=!1,p=!1,f=0,m=this.currentBatchSize;m>f;f++)n=(s=this.sprites[f])._texture.baseTexture,d=u!==(r=s.blendMode),p=c!==(o=s.shader||this.shader),(h!==n||d||p)&&(this.renderBatch(h,a,l),l=f,a=0,h=n,d&&(u=r,this.renderer.blendModeManager.setBlendMode(u)),p&&((t=(c=o).shaders?c.shaders[e.id]:c)||(t=c.getShader(this.renderer)),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),e.activeTexture(e.TEXTURE0))),a++;this.renderBatch(h,a,l),this.currentBatchSize=0}},n.prototype.renderBatch=function(t,e,i){if(0!==e){var n=this.renderer.gl;t._glTextures[n.id]?n.bindTexture(n.TEXTURE_2D,t._glTextures[n.id]):this.renderer.updateTexture(t),n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,6*i*2),this.renderer.drawCount++}},n.prototype.start=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.vertByteSize;t.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.attributes.aColor,4,t.UNSIGNED_BYTE,!0,e,16)},n.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null}},{"../../const":20,"../../renderers/webgl/WebGLRenderer":46,"../../renderers/webgl/utils/ObjectRenderer":60}],66:[function(t,e,i){function n(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||l.RESOLUTION,this._text=null,this._style=null;var n=o.fromCanvas(this.canvas);n.trim=new s.Rectangle,r.call(this,n),this.text=t,this.style=e}var r=t("../sprites/Sprite"),o=t("../textures/Texture"),s=t("../math"),a=t("../utils"),l=t("../const");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.fontPropertiesCache={},n.fontPropertiesCanvas=document.createElement("canvas"),n.fontPropertiesContext=n.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(n.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(t){this.scale.x=t/this._texture._frame.width,this._width=t}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(t){this.scale.y=t/this._texture._frame.height,this._height=t}},style:{get:function(){return this._style},set:function(t){"number"==typeof(t=t||{}).fill&&(t.fill=a.hex2string(t.fill)),"number"==typeof t.stroke&&(t.stroke=a.hex2string(t.stroke)),"number"==typeof t.dropShadowColor&&(t.dropShadowColor=a.hex2string(t.dropShadowColor)),t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowColor=t.dropShadowColor||"#000000",t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||5,t.padding=t.padding||0,t.textBaseline=t.textBaseline||"alphabetic",t.lineJoin=t.lineJoin||"miter",t.miterLimit=t.miterLimit||10,this._style=t,this.dirty=!0}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),n.prototype.updateText=function(){var t=this._style;this.context.font=t.font;for(var e=(t.wordWrap?this.wordWrap(this._text):this._text).split(/(?:\r\n|\r|\n)/),i=new Array(e.length),n=0,r=this.determineFontProperties(t.font),o=0;o<e.length;o++){var s=this.context.measureText(e[o]).width;i[o]=s,n=Math.max(n,s)}var a=n+t.strokeThickness;t.dropShadow&&(a+=t.dropShadowDistance),this.canvas.width=(a+this.context.lineWidth)*this.resolution;var l,h,u=this.style.lineHeight||r.fontSize+t.strokeThickness,c=u*e.length;if(t.dropShadow&&(c+=t.dropShadowDistance),this.canvas.height=(c+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=t.font,this.context.strokeStyle=t.stroke,this.context.lineWidth=t.strokeThickness,this.context.textBaseline=t.textBaseline,this.context.lineJoin=t.lineJoin,this.context.miterLimit=t.miterLimit,t.dropShadow){this.context.fillStyle=t.dropShadowColor;var d=Math.cos(t.dropShadowAngle)*t.dropShadowDistance,p=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(o=0;o<e.length;o++)l=t.strokeThickness/2,h=t.strokeThickness/2+o*u+r.ascent,"right"===t.align?l+=n-i[o]:"center"===t.align&&(l+=(n-i[o])/2),t.fill&&this.context.fillText(e[o],l+d,h+p+this._style.padding)}for(this.context.fillStyle=t.fill,o=0;o<e.length;o++)l=t.strokeThickness/2,h=t.strokeThickness/2+o*u+r.ascent,"right"===t.align?l+=n-i[o]:"center"===t.align&&(l+=(n-i[o])/2),t.stroke&&t.strokeThickness&&this.context.strokeText(e[o],l,h+this._style.padding),t.fill&&this.context.fillText(e[o],l,h+this._style.padding);this.updateTexture()},n.prototype.updateTexture=function(){var t=this._texture;t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.crop.width=t._frame.width=this.canvas.width/this.resolution,t.crop.height=t._frame.height=this.canvas.height/this.resolution,t.trim.x=0,t.trim.y=-this._style.padding,t.trim.width=t._frame.width,t.trim.height=t._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},n.prototype.renderWebGL=function(t){this.dirty&&this.updateText(),r.prototype.renderWebGL.call(this,t)},n.prototype._renderCanvas=function(t){this.dirty&&this.updateText(),r.prototype._renderCanvas.call(this,t)},n.prototype.determineFontProperties=function(t){var e=n.fontPropertiesCache[t];if(!e){e={};var i=n.fontPropertiesCanvas,r=n.fontPropertiesContext;r.font=t;var o=Math.ceil(r.measureText("|MÉq").width),s=Math.ceil(r.measureText("M").width),a=2*s;s=1.4*s|0,i.width=o,i.height=a,r.fillStyle="#f00",r.fillRect(0,0,o,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText("|MÉq",0,s);var l,h,u=r.getImageData(0,0,o,a).data,c=u.length,d=4*o,p=0,f=!1;for(l=0;s>l;l++){for(h=0;d>h;h+=4)if(255!==u[p+h]){f=!0;break}if(f)break;p+=d}for(e.ascent=s-l,p=c-d,f=!1,l=a;l>s;l--){for(h=0;d>h;h+=4)if(255!==u[p+h]){f=!0;break}if(f)break;p-=d}e.descent=l-s,e.fontSize=e.ascent+e.descent,n.fontPropertiesCache[t]=e}return e},n.prototype.wordWrap=function(t){for(var e="",i=t.split("\n"),n=this._style.wordWrapWidth,r=0;r<i.length;r++){for(var o=n,s=i[r].split(" "),a=0;a<s.length;a++){var l=this.context.measureText(s[a]).width,h=l+this.context.measureText(" ").width;0===a||h>o?(a>0&&(e+="\n"),e+=s[a],o=n-l):(o-=h,e+=" "+s[a])}r<i.length-1&&(e+="\n")}return e},n.prototype.getBounds=function(t){return this.dirty&&this.updateText(),r.prototype.getBounds.call(this,t)},n.prototype.destroy=function(t){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===t||t)}},{"../const":20,"../math":30,"../sprites/Sprite":64,"../textures/Texture":69,"../utils":74}],67:[function(t,e,i){function n(t,e,i){s.call(this),this.uid=r.uid(),this.resolution=i||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=e||o.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],t&&this.loadSource(t)}var r=t("../utils"),o=t("../const"),s=t("eventemitter3");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=r.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},n.prototype.loadSource=function(t){var e=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var i=this;t.onload=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i._sourceLoaded(),i.emit("loaded",i))},t.onerror=function(){t.onload=null,t.onerror=null,i.isLoading&&(i.isLoading=!1,i.emit("error",i))},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this))}},n.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},n.prototype.destroy=function(){this.imageUrl?(delete r.BaseTextureCache[this.imageUrl],delete r.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete r.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},n.prototype.dispose=function(){this.emit("dispose",this),this._glTextures.length=0},n.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},n.fromImage=function(t,e,i){var o=r.BaseTextureCache[t];if(void 0===e&&0!==t.indexOf("data:")&&(e=!0),!o){var s=new Image;e&&(s.crossOrigin=""),(o=new n(s,i)).imageUrl=t,s.src=t,r.BaseTextureCache[t]=o,o.resolution=r.getResolutionOfUrl(t)}return o},n.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+r.uid());var i=r.BaseTextureCache[t._pixiId];return i||(i=new n(t,e),r.BaseTextureCache[t._pixiId]=i),i}},{"../const":20,"../utils":74,eventemitter3:10}],68:[function(t,e,i){function n(t,e,i,n,c){if(!t)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");e=e||100,i=i||100,c=c||u.RESOLUTION;var d=new r;if(d.width=e,d.height=i,d.resolution=c,d.scaleMode=n||u.SCALE_MODES.DEFAULT,d.hasLoaded=!0,o.call(this,d,new h.Rectangle(0,0,e,i)),this.width=e,this.height=i,this.resolution=c,this.render=null,this.renderer=t,this.renderer.type===u.RENDERER_TYPE.WEBGL){var p=this.renderer.gl;this.textureBuffer=new s(p,this.width,this.height,d.scaleMode,this.resolution),this.baseTexture._glTextures[p.id]=this.textureBuffer.texture,this.filterManager=new a(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(e,i),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new l(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var r=t("./BaseTexture"),o=t("./Texture"),s=t("../renderers/webgl/utils/RenderTarget"),a=t("../renderers/webgl/managers/FilterManager"),l=t("../renderers/canvas/utils/CanvasBuffer"),h=t("../math"),u=t("../const"),c=new h.Matrix;n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.resize=function(t,e,i){(t!==this.width||e!==this.height)&&(this.valid=t>0&&e>0,this.width=this._frame.width=this.crop.width=t,this.height=this._frame.height=this.crop.height=e,i&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width,this.height),this.filterManager&&this.filterManager.resize(this.width,this.height)))},n.prototype.clear=function(){this.valid&&(this.renderer.type===u.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},n.prototype.renderWebGL=function(t,e,i,n){if(this.valid){if(n=void 0===n||n,this.textureBuffer.transform=e,this.textureBuffer.activate(),t.worldAlpha=1,n){t.worldTransform.identity(),t.currentBounds=null;var r,o,s=t.children;for(r=0,o=s.length;o>r;++r)s[r].updateTransform()}var a=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(t,this.textureBuffer,i),this.renderer.filterManager=a}},n.prototype.renderCanvas=function(t,e,i,n){if(this.valid){n=!!n;var r=c;r.identity(),e&&r.append(e),t.worldTransform=r;var o=t.worldTransform;t.worldAlpha=1;var s,a,l=t.children;for(s=0,a=l.length;a>s;++s)l[s].updateTransform();i&&this.textureBuffer.clear();var h=this.textureBuffer.context,u=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,h),this.renderer.resolution=u,t.worldTransform=o}},n.prototype.destroy=function(){o.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},n.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},n.prototype.getBase64=function(){return this.getCanvas().toDataURL()},n.prototype.getCanvas=function(){if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var t=this.renderer.gl,e=this.textureBuffer.size.width,i=this.textureBuffer.size.height,n=new Uint8Array(4*e*i);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new l(e,i),o=r.context.getImageData(0,0,e,i);return o.data.set(n),r.context.putImageData(o,0,0),r.canvas}return this.textureBuffer.canvas},n.prototype.getPixels=function(){var t,e;if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var i=this.renderer.gl;t=this.textureBuffer.size.width,e=this.textureBuffer.size.height;var n=new Uint8Array(4*t*e);return i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(0,0,t,e,i.RGBA,i.UNSIGNED_BYTE,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}return t=this.textureBuffer.canvas.width,e=this.textureBuffer.canvas.height,this.textureBuffer.canvas.getContext("2d").getImageData(0,0,t,e).data},n.prototype.getPixel=function(t,e){if(this.renderer.type===u.RENDERER_TYPE.WEBGL){var i=this.renderer.gl,n=new Uint8Array(4);return i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer),i.readPixels(t,e,1,1,i.RGBA,i.UNSIGNED_BYTE,n),i.bindFramebuffer(i.FRAMEBUFFER,null),n}return this.textureBuffer.canvas.getContext("2d").getImageData(t,e,1,1).data}},{"../const":20,"../math":30,"../renderers/canvas/utils/CanvasBuffer":42,"../renderers/webgl/managers/FilterManager":51,"../renderers/webgl/utils/RenderTarget":62,"./BaseTexture":67,"./Texture":69}],69:[function(t,e,i){function n(t,e,i,r,o){a.call(this),this.noFrame=!1,e||(this.noFrame=!0,e=new l.Rectangle(0,0,1,1)),t instanceof n&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||e,this.rotate=!!o,t.hasLoaded?(this.noFrame&&(e=new l.Rectangle(0,0,t.width,t.height),t.on("update",this.onBaseTextureUpdated,this)),this.frame=e):t.once("loaded",this.onBaseTextureLoaded,this)}var r=t("./BaseTexture"),o=t("./VideoBaseTexture"),s=t("./TextureUvs"),a=t("eventemitter3"),l=t("../math"),h=t("../utils");n.prototype=Object.create(a.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{frame:{get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,this.width=t.width,this.height=t.height,!this.trim&&!this.rotate&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=t,this.valid&&this._updateUvs()}}}),n.prototype.update=function(){this.baseTexture.update()},n.prototype.onBaseTextureLoaded=function(t){this.noFrame?this.frame=new l.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.emit("update",this)},n.prototype.onBaseTextureUpdated=function(t){this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},n.prototype.destroy=function(t){this.baseTexture&&(t&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},n.prototype.clone=function(){return new n(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},n.prototype._updateUvs=function(){this._uvs||(this._uvs=new s),this._uvs.set(this.crop,this.baseTexture,this.rotate)},n.fromImage=function(t,e,i){var o=h.TextureCache[t];return o||(o=new n(r.fromImage(t,e,i)),h.TextureCache[t]=o),o},n.fromFrame=function(t){var e=h.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},n.fromCanvas=function(t,e){return new n(r.fromCanvas(t,e))},n.fromVideo=function(t,e){return"string"==typeof t?n.fromVideoUrl(t,e):new n(o.fromVideo(t,e))},n.fromVideoUrl=function(t,e){return new n(o.fromUrl(t,e))},n.addTextureToCache=function(t,e){h.TextureCache[e]=t},n.removeTextureFromCache=function(t){var e=h.TextureCache[t];return delete h.TextureCache[t],delete h.BaseTextureCache[t],e},n.EMPTY=new n(new r)},{"../math":30,"../utils":74,"./BaseTexture":67,"./TextureUvs":70,"./VideoBaseTexture":71,eventemitter3:10}],70:[function(t,e,i){function n(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}e.exports=n,n.prototype.set=function(t,e,i){var n=e.width,r=e.height;i?(this.x0=(t.x+t.height)/n,this.y0=t.y/r,this.x1=(t.x+t.height)/n,this.y1=(t.y+t.width)/r,this.x2=t.x/n,this.y2=(t.y+t.width)/r,this.x3=t.x/n,this.y3=t.y/r):(this.x0=t.x/n,this.y0=t.y/r,this.x1=(t.x+t.width)/n,this.y1=t.y/r,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/r,this.x3=t.x/n,this.y3=(t.y+t.height)/r)}},{}],71:[function(t,e,i){function n(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),o.call(this,t,e),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),t.complete||(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function r(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}var o=t("./BaseTexture"),s=t("../utils");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},n.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},n.prototype._onPlayStop=function(){this.autoUpdate=!1},n.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},n.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete s.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),o.prototype.destroy.call(this)},n.fromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+s.uid());var i=s.BaseTextureCache[t._pixiId];return i||(i=new n(t,e),s.BaseTextureCache[t._pixiId]=i),i},n.fromUrl=function(t,e){var i=document.createElement("video");if(Array.isArray(t))for(var o=0;o<t.length;++o)i.appendChild(r(t[o].src||t[o],t[o].mime));else i.appendChild(r(t.src||t,t.mime));return i.load(),i.play(),n.fromVideo(i,e)},n.fromUrls=n.fromUrl},{"../utils":74,"./BaseTexture":67}],72:[function(t,e,i){function n(){var t=this;this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._emitter.listeners(s,!0)&&(t._requestId=requestAnimationFrame(t._tick)))},this._emitter=new o,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/r.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var r=t("../const"),o=t("eventemitter3"),s="tick";Object.defineProperties(n.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,r.TARGET_FPMS);this._maxElapsedMS=1/e}}}),n.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(s,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},n.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},n.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},n.prototype.add=function(t,e){return this._emitter.on(s,t,e),this._startIfPossible(),this},n.prototype.addOnce=function(t,e){return this._emitter.once(s,t,e),this._startIfPossible(),this},n.prototype.remove=function(t,e){return this._emitter.off(s,t,e),this._emitter.listeners(s,!0)||this._cancelIfNeeded(),this},n.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},n.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},n.prototype.update=function(t){var e;t=t||performance.now(),(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*r.TARGET_FPMS*this.speed,this._emitter.emit(s,this.deltaTime),this.lastTime=t},e.exports=n},{"../const":20,eventemitter3:10}],73:[function(t,e,i){var n=t("./Ticker"),r=new n;r.autoStart=!0,e.exports={shared:r,Ticker:n}},{"./Ticker":72}],74:[function(t,e,i){var n=t("../const"),r=e.exports={_uid:0,_saidHello:!1,EventEmitter:t("eventemitter3"),pluginTarget:t("./pluginTarget"),async:t("async"),uid:function(){return++r._uid},hex2rgb:function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},hex2string:function(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",i=new Image;i.src=t+"AP804Oa6"+e;var n=new Image;n.src=t+"/wCKxvRF"+e;var r=document.createElement("canvas");r.width=6,r.height=1;var o=r.getContext("2d");o.globalCompositeOperation="multiply",o.drawImage(i,0,0),o.drawImage(n,2,0);var s=o.getImageData(2,0,1,1).data;return 255===s[0]&&0===s[1]&&0===s[2]},getNextPowerOfTwo:function(t){if(t>0&&0==(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},isPowerOfTwo:function(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)},getResolutionOfUrl:function(t){var e=n.RETINA_PREFIX.exec(t);return e?parseFloat(e[1]):1},sayHello:function(t){if(!r._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c Pixi.js "+n.VERSION+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+n.VERSION+" - "+t+" - http://www.pixijs.com/");r._saidHello=!0}},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!i||!i.getContextAttributes().stencil)}catch(t){return!1}},sign:function(t){return t?0>t?-1:1:0},TextureCache:{},BaseTextureCache:{}}},{"../const":20,"./pluginTarget":75,async:1,eventemitter3:10}],75:[function(t,e,i){e.exports={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],76:[function(t,e,i){var n=t("./core"),r=t("./mesh"),o=t("./extras"),s=t("./filters");n.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},n.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(n,{Stage:{get:function(){return n.Container}},DisplayObjectContainer:{get:function(){return n.Container}},Strip:{get:function(){return r.Mesh}},Rope:{get:function(){return r.Rope}},MovieClip:{get:function(){return o.MovieClip}},TilingSprite:{get:function(){return o.TilingSprite}},BitmapText:{get:function(){return o.BitmapText}},blendModes:{get:function(){return n.BLEND_MODES}},scaleModes:{get:function(){return n.SCALE_MODES}},BaseTextureCache:{get:function(){return n.utils.BaseTextureCache}},TextureCache:{get:function(){return n.utils.TextureCache}},math:{get:function(){return n}}}),n.Sprite.prototype.setTexture=function(t){this.texture=t},o.BitmapText.prototype.setText=function(t){this.text=t},n.Text.prototype.setText=function(t){this.text=t},n.Text.prototype.setStyle=function(t){this.style=t},n.Texture.prototype.setFrame=function(t){this.frame=t},Object.defineProperties(s,{AbstractFilter:{get:function(){return n.AbstractFilter}},FXAAFilter:{get:function(){return n.FXAAFilter}},SpriteMaskFilter:{get:function(){return n.SpriteMaskFilter}}}),n.utils.uuid=function(){return n.utils.uid()}},{"./core":27,"./extras":83,"./filters":100,"./mesh":124}],77:[function(t,e,i){function n(t,e){r.Container.call(this),e=e||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==e.tint?e.tint:16777215,align:e.align||"left",name:null,size:0},this.font=e.font,this._text=t,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var r=t("../core");n.prototype=Object.create(r.Container.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{tint:{get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):n.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}}}),n.prototype.updateText=function(){for(var t=n.fonts[this._font.name],e=new r.Point,i=null,o=[],s=0,a=0,l=[],h=0,u=this._font.size/t.size,c=-1,d=0,p=0;p<this.text.length;p++){var f=this.text.charCodeAt(p);if(c=/(\s)/.test(this.text.charAt(p))?p:c,/(?:\r\n|\r|\n)/.test(this.text.charAt(p)))l.push(s),a=Math.max(a,s),h++,e.x=0,e.y+=t.lineHeight,i=null;else if(-1!==c&&this.maxWidth>0&&e.x*u>this.maxWidth)o.splice(c,p-c),p=c,c=-1,l.push(s),a=Math.max(a,s),h++,e.x=0,e.y+=t.lineHeight,i=null;else{var m=t.chars[f];m&&(i&&m.kerning[i]&&(e.x+=m.kerning[i]),o.push({texture:m.texture,line:h,charCode:f,position:new r.Point(e.x+m.xOffset,e.y+m.yOffset)}),s=e.x+(m.texture.width+m.xOffset),e.x+=m.xAdvance,d=Math.max(d,m.yOffset+m.texture.height),i=f)}}l.push(s),a=Math.max(a,s);var g=[];for(p=0;h>=p;p++){var v=0;"right"===this._font.align?v=a-l[p]:"center"===this._font.align&&(v=(a-l[p])/2),g.push(v)}var y=o.length,b=this.tint;for(p=0;y>p;p++){var _=this._glyphs[p];_?_.texture=o[p].texture:(_=new r.Sprite(o[p].texture),this._glyphs.push(_)),_.position.x=(o[p].position.x+g[o[p].line])*u,_.position.y=o[p].position.y*u,_.scale.x=_.scale.y=u,_.tint=b,_.parent||this.addChild(_)}for(p=y;p<this._glyphs.length;++p)this.removeChild(this._glyphs[p]);this.textWidth=a*u,this.textHeight=(e.y+t.lineHeight)*u,this.maxLineHeight=d*u},n.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},n.prototype.getLocalBounds=function(){return this.validate(),r.Container.prototype.getLocalBounds.call(this)},n.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},n.fonts={}},{"../core":27}],78:[function(t,e,i){function n(t){r.Sprite.call(this,t[0]instanceof r.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var r=t("../core");n.prototype=Object.create(r.Sprite.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){if(t[0]instanceof r.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},currentFrame:{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return 0>t&&(t+=this._textures.length),t}}}),n.prototype.stop=function(){this.playing&&(this.playing=!1,r.ticker.shared.remove(this.update,this))},n.prototype.play=function(){this.playing||(this.playing=!0,r.ticker.shared.add(this.update,this))},n.prototype.gotoAndStop=function(t){this.stop(),this._currentTime=t,this._texture=this._textures[this.currentFrame]},n.prototype.gotoAndPlay=function(t){this._currentTime=t,this.play()},n.prototype.update=function(t){var e=this.animationSpeed*t;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;0>i;)this._currentTime--,i+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},n.prototype.destroy=function(){this.stop(),r.Sprite.prototype.destroy.call(this)},n.fromFrames=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new r.Texture.fromFrame(t[i]));return new n(e)},n.fromImages=function(t){for(var e=[],i=0;i<t.length;++i)e.push(new r.Texture.fromImage(t[i]));return new n(e)}},{"../core":27}],79:[function(t,e,i){function n(t,e,i){r.Sprite.call(this,t),this.tileScale=new r.Point(1,1),this.tilePosition=new r.Point(0,0),this._width=e||100,this._height=i||100,this._uvs=new r.TextureUvs,this._canvasPattern=null,this.shader=new r.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var r=t("../core"),o=new r.Point,s=t("../core/renderers/canvas/utils/CanvasTinter");n.prototype=Object.create(r.Sprite.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}}),n.prototype._onTextureUpdate=function(){},n.prototype._renderWebGL=function(t){var e=this._texture;if(e&&e._uvs){var i=e._uvs,n=e._frame.width,r=e._frame.height,o=e.baseTexture.width,s=e.baseTexture.height;e._uvs=this._uvs,e._frame.width=this.width,e._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/o,this.shader.uniforms.uPixelSize.value[1]=1/s,this.shader.uniforms.uFrame.value[0]=i.x0,this.shader.uniforms.uFrame.value[1]=i.y0,this.shader.uniforms.uFrame.value[2]=i.x1-i.x0,this.shader.uniforms.uFrame.value[3]=i.y2-i.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(n*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(r*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=o/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=s/this._height*this.tileScale.y,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this),e._uvs=i,e._frame.width=n,e._frame.height=r}},n.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,n=this.worldTransform,o=t.resolution,a=e.baseTexture,l=this.tilePosition.x/this.tileScale.x%e._frame.width,h=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var u=new r.CanvasBuffer(e._frame.width,e._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=s.getTintedTexture(this,this.tint)),u.context.drawImage(this.tintedTexture,0,0)):u.context.drawImage(a.source,-e._frame.x,-e._frame.y),this._canvasPattern=u.context.createPattern(u.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),i.scale(this.tileScale.x,this.tileScale.y),i.translate(l+this.anchor.x*-this._width,h+this.anchor.y*-this._height);var c=t.blendModes[this.blendMode];c!==t.context.globalCompositeOperation&&(i.globalCompositeOperation=c),i.fillStyle=this._canvasPattern,i.fillRect(-l,-h,this._width/this.tileScale.x,this._height/this.tileScale.y)}},n.prototype.getBounds=function(){var t,e,i,n,r=this._width,o=this._height,s=r*(1-this.anchor.x),a=r*-this.anchor.x,l=o*(1-this.anchor.y),h=o*-this.anchor.y,u=this.worldTransform,c=u.a,d=u.b,p=u.c,f=u.d,m=u.tx,g=u.ty,v=c*a+p*h+m,y=f*h+d*a+g,b=c*s+p*h+m,_=f*h+d*s+g,x=c*s+p*l+m,w=f*l+d*s+g,T=c*a+p*l+m,S=f*l+d*a+g;t=(t=(t=(t=v)>b?b:t)>x?x:t)>T?T:t,i=(i=(i=(i=y)>_?_:i)>w?w:i)>S?S:i,e=T>(e=x>(e=b>(e=v)?b:e)?x:e)?T:e,n=S>(n=w>(n=_>(n=y)?_:n)?w:n)?S:n;var E=this._bounds;return E.x=t,E.width=e-t,E.y=i,E.height=n-i,this._currentBounds=E,E},n.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,o);var e,i=this._width,n=this._height,r=-i*this.anchor.x;return o.x>r&&o.x<r+i&&(e=-n*this.anchor.y,o.y>e&&o.y<e+n)},n.prototype.destroy=function(){r.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},n.fromFrame=function(t,e,i){var o=r.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new n(o,e,i)},n.fromImage=function(t,e,i,o,s){return new n(r.Texture.fromImage(t,o,s),e,i)}},{"../core":27,"../core/renderers/canvas/utils/CanvasTinter":45}],80:[function(t,e,i){var n=t("../core"),r=n.DisplayObject,o=new n.Matrix;r.prototype._cacheAsBitmap=!1,r.prototype._originalRenderWebGL=null,r.prototype._originalRenderCanvas=null,r.prototype._originalUpdateTransform=null,r.prototype._originalHitTest=null,r.prototype._originalDestroy=null,r.prototype._cachedSprite=null,Object.defineProperties(r.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),r.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cachedSprite.worldAlpha=this.worldAlpha,t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this._cachedSprite))},r.prototype._initCachedDisplayObject=function(t){if(!this._cachedSprite){t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var i=this._filters[0].padding;e.x-=i,e.y-=i,e.width+=2*i,e.height+=2*i}var r=t.currentRenderTarget,s=t.filterManager.filterStack,a=new n.RenderTexture(t,0|e.width,0|e.height),l=o;l.tx=-e.x,l.ty=-e.y,this.renderWebGL=this._originalRenderWebGL,a.render(this,l,!0,!0),t.setRenderTarget(r),t.filterManager.filterStack=s,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new n.Sprite(a),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},r.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(t))},r.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cachedSprite){var e=this.getLocalBounds(),i=t.context,r=new n.RenderTexture(t,0|e.width,0|e.height),s=o;s.tx=-e.x,s.ty=-e.y,this.renderCanvas=this._originalRenderCanvas,r.render(this,s,!0),t.context=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new n.Sprite(r),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},r.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},r.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},r.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":27}],81:[function(t,e,i){var n=t("../core");n.DisplayObject.prototype.name=null,n.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":27}],82:[function(t,e,i){var n=t("../core");n.DisplayObject.prototype.getGlobalPosition=function(t){return t=t||new n.Point,this.parent?(this.displayObjectUpdateTransform(),t.x=this.worldTransform.tx,t.y=this.worldTransform.ty):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":27}],83:[function(t,e,i){t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition"),e.exports={MovieClip:t("./MovieClip"),TilingSprite:t("./TilingSprite"),BitmapText:t("./BitmapText")}},{"./BitmapText":77,"./MovieClip":78,"./TilingSprite":79,"./cacheAsBitmap":80,"./getChildByName":81,"./getGlobalPosition":82}],84:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":27}],85:[function(t,e,i){function n(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYFilter=new s,this.defaultFilter=new r.AbstractFilter}var r=t("../../core"),o=t("../blur/BlurXFilter"),s=t("../blur/BlurYFilter");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(t,e,i),this.blurXFilter.applyFilter(t,e,n),t.blendModeManager.setBlendMode(r.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(t,n,i),t.blendModeManager.setBlendMode(r.BLEND_MODES.NORMAL),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":27,"../blur/BlurXFilter":88,"../blur/BlurYFilter":89}],86:[function(t,e,i){function n(t,e){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:t||0},dirY:{type:"1f",value:e||0}}),this.defaultFilter=new r.AbstractFilter,this.passes=1,this.dirX=t||0,this.dirY=e||0,this.strength=4}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(r,e,i,n);else{var o=t.filterManager.getRenderTarget(!0);t.filterManager.applyFilter(r,e,o,n);for(var s=0;s<this.passes-2;s++)t.filterManager.applyFilter(r,o,o,n);t.filterManager.applyFilter(r,o,i,n),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}},dirX:{get:function(){return this.dirX},set:function(t){this.uniforms.dirX.value=t}},dirY:{get:function(){return this.dirY},set:function(t){this.uniforms.dirY.value=t}}})},{"../../core":27}],87:[function(t,e,i){function n(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYFilter=new s}var r=t("../../core"),o=t("./BlurXFilter"),s=t("./BlurYFilter");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(t,e,n),this.blurYFilter.applyFilter(t,n,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.padding=.5*Math.abs(t),this.blurXFilter.blur=this.blurYFilter.blur=t}},passes:{get:function(){return this.blurXFilter.passes},set:function(t){this.blurXFilter.passes=this.blurYFilter.passes=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":27,"./BlurXFilter":88,"./BlurYFilter":89}],88:[function(t,e,i){function n(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width),1===this.passes)t.filterManager.applyFilter(r,e,i,n);else{for(var o=t.filterManager.getRenderTarget(!0),s=e,a=o,l=0;l<this.passes-1;l++){t.filterManager.applyFilter(r,s,a,!0);var h=a;a=s,s=h}t.filterManager.applyFilter(r,s,i,n),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":27}],89:[function(t,e,i){function n(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var r=this.getShader(t);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(r,e,i,n);else{for(var o=t.filterManager.getRenderTarget(!0),s=e,a=o,l=0;l<this.passes-1;l++){t.filterManager.applyFilter(r,s,a,!0);var h=a;a=s,s=h}t.filterManager.applyFilter(r,s,i,n),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*Math.abs(t),this.strength=t}}})},{"../../core":27}],90:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n},{"../../core":27}],91:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype._loadMatrix=function(t,e){var i=t;(e=!!e)&&(this._multiply(i,this.uniforms.m.value,t),i=this._colorMatrix(i)),this.uniforms.m.value=i},n.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19],t},n.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},n.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.grayscale=n.prototype.greyscale,n.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},n.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),r=.213,o=.715,s=.072,a=[r+.787*i+n*-r,o+i*-o+n*-o,s+i*-s+.928*n,0,0,r+i*-r+.143*n,o+i*(1-o)+.14*n,s+i*-s+-.283*n,0,0,r+i*-r+-.787*n,o+i*-o+n*o,s+.928*i+n*s,0,0,0,0,0,1,0];this._loadMatrix(a,e)},n.prototype.contrast=function(t,e){var i=(t||0)+1,n=-128*(i-1),r=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(r,e)},n.prototype.saturate=function(t,e){var i=2*(t||0)/3+1,n=-.5*(i-1),r=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(r,e)},n.prototype.desaturate=function(t){this.saturate(-1)},n.prototype.negative=function(t){this._loadMatrix([0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],t)},n.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},n.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},n.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},n.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},n.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},n.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},n.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},n.prototype.colorTone=function(t,e,i,n,r){var o=((i=i||16770432)>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,l=((n=n||3375104)>>16&255)/255,h=(n>>8&255)/255,u=(255&n)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,l,h,u,e=e||.15,0,o-l,s-h,a-u,0,0];this._loadMatrix(c,r)},n.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},n.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},n.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(t){this.uniforms.m.value=t}}})},{"../../core":27}],92:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}})},{"../../core":27}],93:[function(t,e,i){function n(t,e,i){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(t)},texelSize:{type:"v2",value:{x:1/e,y:1/i}}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=new Float32Array(t)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(t){this.uniforms.texelSize.value.x=1/t}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(t){this.uniforms.texelSize.value.y=1/t}}})},{"../../core":27}],94:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n},{"../../core":27}],95:[function(t,e,i){function n(t,e){var i=new r.Matrix;t.renderable=!1,r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:t.texture},otherMatrix:{type:"mat3",value:i.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=t,this.maskMatrix=i,null==e&&(e=20),this.scale=new r.Point(e,e)}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager;n.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/e.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/e.frame.height);var r=this.getShader(t);n.applyFilter(r,e,i)},Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(t){this.uniforms.mapSampler.value=t}}})},{"../../core":27}],96:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":27}],97:[function(t,e,i){function n(){r.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i,n){var r=this.getShader(t);if(this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.height/e.size.height),1===this.passes)t.filterManager.applyFilter(r,e,i,n);else{for(var o=t.filterManager.getRenderTarget(!0),s=e,a=o,l=0;l<this.passes-1;l++){t.filterManager.applyFilter(r,s,a,n);var h=a;a=s,s=h}t.filterManager.applyFilter(r,s,i,n),t.filterManager.returnRenderTarget(o)}},Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=.5*t,this.strength=t}}})},{"../../core":27}],98:[function(t,e,i){function n(){r.AbstractFilter.call(this),this.blurXFilter=new o,this.blurYTintFilter=new s,this.defaultFilter=new r.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=r.BLEND_MODES.MULTIPLY}var r=t("../../core"),o=t("../blur/BlurXFilter"),s=t("./BlurYTintFilter");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(t,e,n),t.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(t,n,i),t.blendModeManager.setBlendMode(r.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(t,e,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYTintFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(t){this.blurYTintFilter.blur=t}},color:{get:function(){return r.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(t){this.blurYTintFilter.uniforms.color.value=r.utils.hex2rgb(t)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(t){this.blurYTintFilter.uniforms.alpha.value=t}},distance:{get:function(){return this._distance},set:function(t){this._dirtyPosition=!0,this._distance=t}},angle:{get:function(){return this._angle},set:function(t){this._dirtyPosition=!0,this._angle=t}}})},{"../../core":27,"../blur/BlurXFilter":88,"./BlurYTintFilter":97}],99:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}})},{"../../core":27}],100:[function(t,e,i){e.exports={AsciiFilter:t("./ascii/AsciiFilter"),BloomFilter:t("./bloom/BloomFilter"),BlurFilter:t("./blur/BlurFilter"),BlurXFilter:t("./blur/BlurXFilter"),BlurYFilter:t("./blur/BlurYFilter"),BlurDirFilter:t("./blur/BlurDirFilter"),ColorMatrixFilter:t("./color/ColorMatrixFilter"),ColorStepFilter:t("./color/ColorStepFilter"),ConvolutionFilter:t("./convolution/ConvolutionFilter"),CrossHatchFilter:t("./crosshatch/CrossHatchFilter"),DisplacementFilter:t("./displacement/DisplacementFilter"),DotScreenFilter:t("./dot/DotScreenFilter"),GrayFilter:t("./gray/GrayFilter"),DropShadowFilter:t("./dropshadow/DropShadowFilter"),InvertFilter:t("./invert/InvertFilter"),NoiseFilter:t("./noise/NoiseFilter"),PixelateFilter:t("./pixelate/PixelateFilter"),RGBSplitFilter:t("./rgb/RGBSplitFilter"),ShockwaveFilter:t("./shockwave/ShockwaveFilter"),SepiaFilter:t("./sepia/SepiaFilter"),SmartBlurFilter:t("./blur/SmartBlurFilter"),TiltShiftFilter:t("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:t("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:t("./tiltshift/TiltShiftYFilter"),TwistFilter:t("./twist/TwistFilter")}},{"./ascii/AsciiFilter":84,"./bloom/BloomFilter":85,"./blur/BlurDirFilter":86,"./blur/BlurFilter":87,"./blur/BlurXFilter":88,"./blur/BlurYFilter":89,"./blur/SmartBlurFilter":90,"./color/ColorMatrixFilter":91,"./color/ColorStepFilter":92,"./convolution/ConvolutionFilter":93,"./crosshatch/CrossHatchFilter":94,"./displacement/DisplacementFilter":95,"./dot/DotScreenFilter":96,"./dropshadow/DropShadowFilter":98,"./gray/GrayFilter":99,"./invert/InvertFilter":101,"./noise/NoiseFilter":102,"./pixelate/PixelateFilter":103,"./rgb/RGBSplitFilter":104,"./sepia/SepiaFilter":105,"./shockwave/ShockwaveFilter":106,"./tiltshift/TiltShiftFilter":108,"./tiltshift/TiltShiftXFilter":109,"./tiltshift/TiltShiftYFilter":110,"./twist/TwistFilter":111}],101:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}})},{"../../core":27}],102:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(t){this.uniforms.noise.value=t}}})},{"../../core":27}],103:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":27}],104:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(t){this.uniforms.red.value=t}},green:{get:function(){return this.uniforms.green.value},set:function(t){this.uniforms.green.value=t}},blue:{get:function(){return this.uniforms.blue.value},set:function(t){this.uniforms.blue.value=t}}})},{"../../core":27}],105:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}})},{"../../core":27}],106:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(t){this.uniforms.center.value=t}},params:{get:function(){return this.uniforms.params.value},set:function(t){this.uniforms.params.value=t}},time:{get:function(){return this.uniforms.time.value},set:function(t){this.uniforms.time.value=t}}})},{"../../core":27}],107:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(n.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(t){this.uniforms.blur.value=t}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(t){this.uniforms.gradientBlur.value=t}},start:{get:function(){return this.uniforms.start.value},set:function(t){this.uniforms.start.value=t,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(t){this.uniforms.end.value=t,this.updateDelta()}}})},{"../../core":27}],108:[function(t,e,i){function n(){r.AbstractFilter.call(this),this.tiltShiftXFilter=new o,this.tiltShiftYFilter=new s}var r=t("../../core"),o=t("./TiltShiftXFilter"),s=t("./TiltShiftYFilter");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.applyFilter=function(t,e,i){var n=t.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(t,e,n),this.tiltShiftYFilter.applyFilter(t,n,i),t.filterManager.returnRenderTarget(n)},Object.defineProperties(n.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}}})},{"../../core":27,"./TiltShiftXFilter":109,"./TiltShiftYFilter":110}],109:[function(t,e,i){function n(){r.call(this)}var r=t("./TiltShiftAxisFilter");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=t/i,this.uniforms.delta.value.y=e/i}},{"./TiltShiftAxisFilter":107}],110:[function(t,e,i){function n(){r.call(this)}var r=t("./TiltShiftAxisFilter");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x,e=this.uniforms.end.value.y-this.uniforms.start.value.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=-e/i,this.uniforms.delta.value.y=t/i}},{"./TiltShiftAxisFilter":107}],111:[function(t,e,i){function n(){r.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var r=t("../../core");n.prototype=Object.create(r.AbstractFilter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}},radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":27}],112:[function(t,e,i){(function(i){t("./polyfill");var n=e.exports=t("./core");n.extras=t("./extras"),n.filters=t("./filters"),n.interaction=t("./interaction"),n.loaders=t("./loaders"),n.mesh=t("./mesh"),n.loader=new n.loaders.Loader,Object.assign(n,t("./deprecation")),i.PIXI=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core":27,"./deprecation":76,"./extras":83,"./filters":100,"./interaction":115,"./loaders":118,"./mesh":124,"./polyfill":129}],113:[function(t,e,i){function n(){this.global=new r.Point,this.target=null,this.originalEvent=null}var r=t("../core");n.prototype.constructor=n,e.exports=n,n.prototype.getLocalPosition=function(t,e,i){var n=t.worldTransform,o=i||this.global,s=n.a,a=n.c,l=n.tx,h=n.b,u=n.d,c=n.ty,d=1/(s*u+a*-h);return(e=e||new r.Point).x=u*d*o.x+-a*d*o.x+(c*a-l*u)*d,e.y=s*d*o.y+-h*d*o.y+(-c*s+l*h)*d,e}},{"../core":27}],114:[function(t,e,i){function n(t,e){e=e||{},this.renderer=t,this.autoPreventDefault=void 0===e.autoPreventDefault||e.autoPreventDefault,this.interactionFrequency=e.interactionFrequency||10,this.mouse=new o,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new r.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var r=t("../core"),o=t("./InteractionData");Object.assign(r.DisplayObject.prototype,t("./interactiveTarget")),n.prototype.constructor=n,e.exports=n,n.prototype.setTargetElement=function(t,e){this.removeEvents(),this.interactionDOMElement=t,this.resolution=e||1,this.addEvents()},n.prototype.addEvents=function(){this.interactionDOMElement&&(r.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},n.prototype.removeEvents=function(){this.interactionDOMElement&&(r.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},n.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},n.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.target=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},n.prototype.mapPositionToPoint=function(t,e,i){var n=this.interactionDOMElement.getBoundingClientRect();t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)/this.resolution,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)/this.resolution},n.prototype.processInteractive=function(t,e,i,n,r){if(!e.visible)return!1;var o=e.children,s=!1;if(r=r||e.interactive,e.interactiveChildren)for(var a=o.length-1;a>=0;a--)!s&&n?s=this.processInteractive(t,o[a],i,!0,r):this.processInteractive(t,o[a],i,!1,!1);return r&&(n&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),s=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(s=e.containsPoint(t))),e.interactive&&i(e,s)),s},n.prototype.onMouseDown=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},n.prototype.processMouseDown=function(t,e){var i=this.mouse.originalEvent,n=2===i.button||3===i.which;e&&(t[n?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(t,n?"rightdown":"mousedown",this.eventData))},n.prototype.onMouseUp=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},n.prototype.processMouseUp=function(t,e){var i=this.mouse.originalEvent,n=2===i.button||3===i.which,r=n?"_isRightDown":"_isLeftDown";e?(this.dispatchEvent(t,n?"rightup":"mouseup",this.eventData),t[r]&&(t[r]=!1,this.dispatchEvent(t,n?"rightclick":"click",this.eventData))):t[r]&&(t[r]=!1,this.dispatchEvent(t,n?"rightupoutside":"mouseupoutside",this.eventData))},n.prototype.onMouseMove=function(t){this.mouse.originalEvent=t,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},n.prototype.processMouseMove=function(t,e){e&&this.dispatchEvent(t,"mousemove",this.eventData),this.processMouseOverOut(t,e)},n.prototype.onMouseOut=function(t){this.mouse.originalEvent=t,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},n.prototype.processMouseOverOut=function(t,e){e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",this.eventData)),t.buttonMode&&(this.cursor=t.defaultCursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",this.eventData))},n.prototype.onTouchStart=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var r=e[n],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(o)}},n.prototype.processTouchStart=function(t,e){e&&(t._touchDown=!0,this.dispatchEvent(t,"touchstart",this.eventData))},n.prototype.onTouchEnd=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var r=e[n],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(o)}},n.prototype.processTouchEnd=function(t,e){e?(this.dispatchEvent(t,"touchend",this.eventData),t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"tap",this.eventData))):t._touchDown&&(t._touchDown=!1,this.dispatchEvent(t,"touchendoutside",this.eventData))},n.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();for(var e=t.changedTouches,i=e.length,n=0;i>n;n++){var r=e[n],o=this.getTouchData(r);o.originalEvent=t,this.eventData.data=o,this.eventData.stopped=!1,this.processInteractive(o.global,this.renderer._lastObjectRendered,this.processTouchMove,!0),this.returnTouchData(o)}},n.prototype.processTouchMove=function(t,e){e&&this.dispatchEvent(t,"touchmove",this.eventData)},n.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();return e||(e=new o),e.identifier=t.identifier,this.mapPositionToPoint(e.global,t.clientX,t.clientY),navigator.isCocoonJS&&(e.global.x=e.global.x/this.resolution,e.global.y=e.global.y/this.resolution),t.globalX=e.global.x,t.globalY=e.global.y,e},n.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)},n.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},r.WebGLRenderer.registerPlugin("interaction",n),r.CanvasRenderer.registerPlugin("interaction",n)},{"../core":27,"./InteractionData":113,"./interactiveTarget":116}],115:[function(t,e,i){e.exports={InteractionData:t("./InteractionData"),InteractionManager:t("./InteractionManager"),interactiveTarget:t("./interactiveTarget")}},{"./InteractionData":113,"./InteractionManager":114,"./interactiveTarget":116}],116:[function(t,e,i){e.exports={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1}},{}],117:[function(t,e,i){function n(t,e){var i={},n=t.data.getElementsByTagName("info")[0],r=t.data.getElementsByTagName("common")[0];i.font=n.getAttribute("face"),i.size=parseInt(n.getAttribute("size"),10),i.lineHeight=parseInt(r.getAttribute("lineHeight"),10),i.chars={};for(var a=t.data.getElementsByTagName("char"),l=0;l<a.length;l++){var h=parseInt(a[l].getAttribute("id"),10),u=new o.Rectangle(parseInt(a[l].getAttribute("x"),10)+e.frame.x,parseInt(a[l].getAttribute("y"),10)+e.frame.y,parseInt(a[l].getAttribute("width"),10),parseInt(a[l].getAttribute("height"),10));i.chars[h]={xOffset:parseInt(a[l].getAttribute("xoffset"),10),yOffset:parseInt(a[l].getAttribute("yoffset"),10),xAdvance:parseInt(a[l].getAttribute("xadvance"),10),kerning:{},texture:new o.Texture(e.baseTexture,u)}}var c=t.data.getElementsByTagName("kerning");for(l=0;l<c.length;l++){var d=parseInt(c[l].getAttribute("first"),10),p=parseInt(c[l].getAttribute("second"),10),f=parseInt(c[l].getAttribute("amount"),10);i.chars[p].kerning[d]=f}t.bitmapFont=i,s.BitmapText.fonts[i.font]=i}var r=t("resource-loader").Resource,o=t("../core"),s=t("../extras"),a=t("path");e.exports=function(){return function(t,e){if(!t.data||!t.isXml)return e();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return e();var i=a.dirname(t.url);"."===i&&(i=""),this.baseUrl&&i&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/"),i=i.replace(this.baseUrl,"")),i&&"/"!==i.charAt(i.length-1)&&(i+="/");var s=i+t.data.getElementsByTagName("page")[0].getAttribute("file");if(o.utils.TextureCache[s])n(t,o.utils.TextureCache[s]),e();else{var l={crossOrigin:t.crossOrigin,loadType:r.LOAD_TYPE.IMAGE};this.add(t.name+"_image",s,l,(function(i){n(t,i.texture),e()}))}}}},{"../core":27,"../extras":83,path:2,"resource-loader":16}],118:[function(t,e,i){e.exports={Loader:t("./loader"),bitmapFontParser:t("./bitmapFontParser"),spritesheetParser:t("./spritesheetParser"),textureParser:t("./textureParser"),Resource:t("resource-loader").Resource}},{"./bitmapFontParser":117,"./loader":119,"./spritesheetParser":120,"./textureParser":121,"resource-loader":16}],119:[function(t,e,i){function n(t,e){r.call(this,t,e);for(var i=0;i<n._pixiMiddleware.length;++i)this.use(n._pixiMiddleware[i]())}var r=t("resource-loader"),o=t("./textureParser"),s=t("./spritesheetParser"),a=t("./bitmapFontParser");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n._pixiMiddleware=[r.middleware.parsing.blob,o,s,a],n.addPixiMiddleware=function(t){n._pixiMiddleware.push(t)};var l=r.Resource;l.setExtensionXhrType("fnt",l.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":117,"./spritesheetParser":120,"./textureParser":121,"resource-loader":16}],120:[function(t,e,i){var n=t("resource-loader").Resource,r=t("path"),o=t("../core");e.exports=function(){return function(t,e){if(!t.data||!t.isJson||!t.data.frames)return e();var i={crossOrigin:t.crossOrigin,loadType:n.LOAD_TYPE.IMAGE},s=r.dirname(t.url.replace(this.baseUrl,"")),a=o.utils.getResolutionOfUrl(t.url);this.add(t.name+"_image",s+"/"+t.data.meta.image,i,(function(i){t.textures={};var n=t.data.frames;for(var r in n){var s=n[r].frame;if(s){var l=null,h=null;if(l=n[r].rotated?new o.Rectangle(s.x,s.y,s.h,s.w):new o.Rectangle(s.x,s.y,s.w,s.h),n[r].trimmed&&(h=new o.Rectangle(n[r].spriteSourceSize.x/a,n[r].spriteSourceSize.y/a,n[r].sourceSize.w/a,n[r].sourceSize.h/a)),n[r].rotated){var u=l.width;l.width=l.height,l.height=u}l.x/=a,l.y/=a,l.width/=a,l.height/=a,t.textures[r]=new o.Texture(i.texture.baseTexture,l,l.clone(),h,n[r].rotated),o.utils.TextureCache[r]=t.textures[r]}}e()}))}}},{"../core":27,path:2,"resource-loader":16}],121:[function(t,e,i){var n=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.isImage){var i=new n.BaseTexture(t.data,null,n.utils.getResolutionOfUrl(t.url));i.imageUrl=t.url,t.texture=new n.Texture(i),n.utils.BaseTextureCache[t.url]=i,n.utils.TextureCache[t.url]=t.texture}e()}}},{"../core":27}],122:[function(t,e,i){function n(t,e,i,o,s){r.Container.call(this),this._texture=null,this.uvs=i||new Float32Array([0,1,1,1,1,0,0,1]),this.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=o||new Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=r.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=s||n.DRAW_MODES.TRIANGLE_MESH,this.texture=t}var r=t("../core"),o=new r.Point,s=new r.Polygon;n.prototype=Object.create(r.Container.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}}),n.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.mesh),t.plugins.mesh.render(this)},n.prototype._renderCanvas=function(t){var e=t.context,i=this.worldTransform;t.roundPixels?e.setTransform(i.a,i.b,i.c,i.d,0|i.tx,0|i.ty):e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.drawMode===n.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(e):this._renderCanvasTriangles(e)},n.prototype._renderCanvasTriangleMesh=function(t){for(var e=this.vertices,i=this.uvs,n=e.length/2,r=0;n-2>r;r++){var o=2*r;this._renderCanvasDrawTriangle(t,e,i,o,o+2,o+4)}},n.prototype._renderCanvasTriangles=function(t){for(var e=this.vertices,i=this.uvs,n=this.indices,r=n.length,o=0;r>o;o+=3){var s=2*n[o],a=2*n[o+1],l=2*n[o+2];this._renderCanvasDrawTriangle(t,e,i,s,a,l)}},n.prototype._renderCanvasDrawTriangle=function(t,e,i,n,r,o){var s=this._texture.baseTexture.source,a=this._texture.baseTexture.width,l=this._texture.baseTexture.height,h=e[n],u=e[r],c=e[o],d=e[n+1],p=e[r+1],f=e[o+1],m=i[n]*a,g=i[r]*a,v=i[o]*a,y=i[n+1]*l,b=i[r+1]*l,_=i[o+1]*l;if(this.canvasPadding>0){var x=this.canvasPadding/this.worldTransform.a,w=this.canvasPadding/this.worldTransform.d,T=(h+u+c)/3,S=(d+p+f)/3,E=h-T,C=d-S,A=Math.sqrt(E*E+C*C);h=T+E/A*(A+x),d=S+C/A*(A+w),C=p-S,u=T+(E=u-T)/(A=Math.sqrt(E*E+C*C))*(A+x),p=S+C/A*(A+w),C=f-S,c=T+(E=c-T)/(A=Math.sqrt(E*E+C*C))*(A+x),f=S+C/A*(A+w)}t.save(),t.beginPath(),t.moveTo(h,d),t.lineTo(u,p),t.lineTo(c,f),t.closePath(),t.clip();var j=m*b+y*v+g*_-b*v-y*g-m*_,R=h*b+y*c+u*_-b*c-y*u-h*_,M=m*u+h*v+g*c-u*v-h*g-m*c,O=m*b*c+y*u*v+h*g*_-h*b*v-y*g*c-m*u*_,D=d*b+y*f+p*_-b*f-y*p-d*_,P=m*p+d*v+g*f-p*v-d*g-m*f,F=m*b*f+y*p*v+d*g*_-d*b*v-y*g*f-m*p*_;t.transform(R/j,D/j,M/j,P/j,O/j,F/j),t.drawImage(s,0,0),t.restore()},n.prototype.renderMeshFlat=function(t){var e=this.context,i=t.vertices,n=i.length/2;e.beginPath();for(var r=1;n-2>r;r++){var o=2*r,s=i[o],a=i[o+2],l=i[o+4],h=i[o+1],u=i[o+3],c=i[o+5];e.moveTo(s,h),e.lineTo(a,u),e.lineTo(l,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},n.prototype._onTextureUpdate=function(){this.updateFrame=!0},n.prototype.getBounds=function(t){if(!this._currentBounds){for(var e=t||this.worldTransform,i=e.a,n=e.b,o=e.c,s=e.d,a=e.tx,l=e.ty,h=-1/0,u=-1/0,c=1/0,d=1/0,p=this.vertices,f=0,m=p.length;m>f;f+=2){var g=p[f],v=p[f+1],y=i*g+o*v+a,b=s*v+n*g+l;c=c>y?y:c,d=d>b?b:d,h=y>h?y:h,u=b>u?b:u}if(c===-1/0||u===1/0)return r.Rectangle.EMPTY;var _=this._bounds;_.x=c,_.width=h-c,_.y=d,_.height=u-d,this._currentBounds=_}return this._currentBounds},n.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,o);var e,i,r=this.vertices,a=s.points;if(this.drawMode===n.DRAW_MODES.TRIANGLES){var l=this.indices;for(i=this.indices.length,e=0;i>e;e+=3){var h=2*l[e],u=2*l[e+1],c=2*l[e+2];if(a[0]=r[h],a[1]=r[h+1],a[2]=r[u],a[3]=r[u+1],a[4]=r[c],a[5]=r[c+1],s.contains(o.x,o.y))return!0}}else for(i=r.length,e=0;i>e;e+=6)if(a[0]=r[e],a[1]=r[e+1],a[2]=r[e+2],a[3]=r[e+3],a[4]=r[e+4],a[5]=r[e+5],s.contains(o.x,o.y))return!0;return!1},n.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":27}],123:[function(t,e,i){function n(t,e){r.call(this,t),this.points=e,this.vertices=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length),this._ready=!0,this.refresh()}var r=t("./Mesh"),o=t("../core");n.prototype=Object.create(r.prototype),n.prototype.constructor=n,e.exports=n,n.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){var e=this.uvs,i=this.indices,n=this.colors,r=this._texture._uvs,s=new o.Point(r.x0,r.y0),a=new o.Point(r.x2-r.x0,r.y2-r.y0);e[0]=0+s.x,e[1]=0+s.y,e[2]=0+s.x,e[3]=1*a.y+s.y,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var l,h,u=t.length,c=1;u>c;c++)t[c],h=c/(u-1),e[l=4*c]=h*a.x+s.x,e[l+1]=0+s.y,e[l+2]=h*a.x+s.x,e[l+3]=1*a.y+s.y,n[l=2*c]=1,n[l+1]=1,i[l=2*c]=l,i[l+1]=l+1;this.dirty=!0}},n.prototype._onTextureUpdate=function(){r.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},n.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e,i,n,r,o,s=t[0],a=0,l=0,h=this.vertices,u=t.length,c=0;u>c;c++)i=t[c],n=4*c,l=-((e=c<t.length-1?t[c+1]:i).x-s.x),a=e.y-s.y,10*(1-c/(u-1))>1&&1,a/=r=Math.sqrt(a*a+l*l),l/=r,a*=o=this._texture.height/2,l*=o,h[n]=i.x+a,h[n+1]=i.y+l,h[n+2]=i.x-a,h[n+3]=i.y-l,s=i;this.containerUpdateTransform()}}},{"../core":27,"./Mesh":122}],124:[function(t,e,i){e.exports={Mesh:t("./Mesh"),Rope:t("./Rope"),MeshRenderer:t("./webgl/MeshRenderer"),MeshShader:t("./webgl/MeshShader")}},{"./Mesh":122,"./Rope":123,"./webgl/MeshRenderer":125,"./webgl/MeshShader":126}],125:[function(t,e,i){function n(t){r.ObjectRenderer.call(this,t),this.indices=new Uint16Array(15e3);for(var e=0,i=0;15e3>e;e+=6,i+=4)this.indices[e+0]=i+0,this.indices[e+1]=i+1,this.indices[e+2]=i+2,this.indices[e+3]=i+0,this.indices[e+4]=i+2,this.indices[e+5]=i+3}var r=t("../../core"),o=t("../Mesh");n.prototype=Object.create(r.ObjectRenderer.prototype),n.prototype.constructor=n,e.exports=n,r.WebGLRenderer.registerPlugin("mesh",n),n.prototype.onContextChange=function(){},n.prototype.render=function(t){t._vertexBuffer||this._initWebGL(t);var e=this.renderer,i=e.gl,n=t._texture.baseTexture,r=e.shaderManager.plugins.meshShader,s=t.drawMode===o.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;e.blendModeManager.setBlendMode(t.blendMode),i.uniformMatrix3fv(r.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),i.uniformMatrix3fv(r.uniforms.projectionMatrix._location,!1,e.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform1f(r.uniforms.alpha._location,t.worldAlpha),t.dirty?(t.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.vertices,i.STATIC_DRAW),i.vertexAttribPointer(r.attributes.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferData(i.ARRAY_BUFFER,t.uvs,i.STATIC_DRAW),i.vertexAttribPointer(r.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),n._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,n._glTextures[i.id]):this.renderer.updateTexture(n),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.vertices),i.vertexAttribPointer(r.attributes.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.vertexAttribPointer(r.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),n._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,n._glTextures[i.id]):this.renderer.updateTexture(n),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,t.indices)),i.drawElements(s,t.indices.length,i.UNSIGNED_SHORT,0)},n.prototype._initWebGL=function(t){var e=this.renderer.gl;t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),t.colors&&(t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)},n.prototype.flush=function(){},n.prototype.start=function(){var t=this.renderer.shaderManager.plugins.meshShader;this.renderer.shaderManager.setShader(t)},n.prototype.destroy=function(){r.ObjectRenderer.prototype.destroy.call(this)}},{"../../core":27,"../Mesh":122}],126:[function(t,e,i){function n(t){r.Shader.call(this,t,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var r=t("../../core");n.prototype=Object.create(r.Shader.prototype),n.prototype.constructor=n,e.exports=n,r.ShaderManager.registerPlugin("meshShader",n)},{"../../core":27}],127:[function(t,e,i){Math.sign||(Math.sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1})},{}],128:[function(t,e,i){Object.assign||(Object.assign=t("object-assign"))},{"object-assign":11}],129:[function(t,e,i){t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign")},{"./Math.sign":127,"./Object.assign":128,"./requestAnimationFrame":130}],130:[function(t,e,i){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var i=Date.now(),n=["ms","moz","webkit","o"],r=0;r<n.length&&!t.requestAnimationFrame;++r)t.requestAnimationFrame=t[n[r]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n[r]+"CancelAnimationFrame"]||t[n[r]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+i-e;return 0>n&&(n=0),i=e,setTimeout((function(){i=Date.now(),t(performance.now())}),n)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[112])(112)}))})),game.module("engine.pool").body((function(){function t(){}t.prototype.create=function(t){return!this[t]&&(this[t]=[],!0)},t.prototype.get=function(t){return!(!this[t]||0===this[t].length)&&this[t].pop()},t.prototype.put=function(t,e){return!!this[t]&&(this[t].push(e),!0)},game.Pool=t})),game.module("engine.renderer").require("engine.pixi","engine.geometry").body((function(){function t(t,e){this.loop=!0,this.onComplete=null,this.random=!1,this.reverse=!1,this.speed=10,this.frames=t,game.merge(this,e)}function e(t){if(this.anims={},this.currentAnim="default",this.currentFrame=0,this.playing=!1,this._frameTime=0,this.textures=t,"string"==typeof this.textures&&-1!==this.textures.indexOf("json")){var e=game.getJSON(this.textures);for(var i in this.textures=[],e.frames)this.textures.push(i)}for(var n=[],r=0;r<this.textures.length;r++){var o=this.textures[r];o instanceof game.Texture||(o=game.Texture.fromAsset(o)),n.push(o)}this.textures=n,this.addAnim("default"),s.Sprite.call(this,this.textures[0])}function i(t,e,i,n){"string"==typeof t&&(t=game.paths[t]||t,t=game.Texture.fromFrame(t)),s.Sprite.call(this,t),game.merge(this,n),this.position.set(e,i),game.device.mobile&&!this.tap&&this.click&&(this.tap=this.click),game.device.mobile&&!this.touchmove&&this.mousemove&&(this.touchmove=this.mousemove),game.device.mobile&&!this.touchstart&&this.mousedown&&(this.touchstart=this.mousedown),game.device.mobile&&!this.touchend&&this.mouseup&&(this.touchend=this.mouseup),game.device.mobile&&!this.touchendoutside&&this.mouseupoutside&&(this.touchendoutside=this.mouseupoutside)}function n(t,e,i,n){this.speed=new game.Vector;var r=(t=game.paths[t]||t)instanceof game.Texture||t instanceof game.RenderTexture?t:game.Texture.fromFrame(this.path||t);s.extras.TilingSprite.call(this,r,e||r.width,i||r.height),game.merge(this,n)}function r(t,e,i){this.textures=[],this.frames=0,this.width=e,this.height=i,this.texture=null,this._sx=0,this._sy=0;var n=game.Texture.fromFrame(game.paths[t]||t),r=n.crop,o=n.baseTexture;this.sx=Math.floor(n.width/this.width),this.sy=Math.floor(n.height/this.height),this.frames=this.sx*this.sy;for(var s=0;s<this.frames;s++){var a=s%this.sx*this.width,l=Math.floor(s/this.sx)*this.height,h=new game.Texture(o,new game.HitRectangle(a+r.x,l+r.y,this.width,this.height));this.textures.push(h)}}function o(){this.loop=!1,this.videoElem=null,this.sprite=null,this.videoElem=document.createElement("video"),this.videoElem.addEventListener("ended",this._complete.bind(this));for(var t,e=Array.prototype.slice.call(arguments),n=0;n<e.length;n++)(t=document.createElement("source")).src=game.getMediaPath(e[n]),this.videoElem.appendChild(t);var r=s.VideoTexture.textureFromVideo(this.videoElem);r.baseTexture.addEventListener("loaded",this._loaded.bind(this)),this.sprite=new i(r)}var s=game.PIXI;s.utils._saidHello=!0,game.blendModes=s.BLEND_MODES,game.autoDetectRenderer=s.autoDetectRenderer,game.CanvasRenderer=s.CanvasRenderer,game.TextureCache=s.utils.TextureCache,game.BaseTexture=s.BaseTexture,game.Texture=s.Texture,game.RenderTexture=s.RenderTexture,game.DisplayObject=s.DisplayObject,game.Graphics=s.Graphics,game.Container=s.Container,game.ParticleContainer=s.ParticleContainer,game.Text=s.Text,game.BitmapText=s.extras.BitmapText,game.HitCircle=s.Circle,game.HitEllipse=s.Ellipse,game.HitPolygon=s.Polygon,game.HitRectangle=s.Rectangle,game.Matrix=s.Matrix,game.EventEmitter=s.utils.EventEmitter,game.DisplayObject.prototype.remove=function(){this.parent&&this.parent.removeChild(this)},game.DisplayObject.prototype.addTo=function(t){return t.addChild(this),this},e.prototype=Object.create(s.Sprite.prototype),e.prototype.constructor=e,e.prototype.addAnim=function(e,i,n){if(e){if(!i){i=[];for(var r=0;r<this.textures.length;r++)i.push(r)}var o=new t(i,n);return this.anims[e]=o,this}},e.prototype.play=function(t,e){t=t||this.currentAnim;var i=this.anims[t];if(i)return this.playing=!0,this.currentAnim=t,"number"!=typeof e&&i.reverse&&(e=i.frames.length-1),this.gotoFrame(e||0),this},e.prototype.stop=function(t){return this.playing=!1,"number"==typeof t&&this.gotoFrame(t),this},e.prototype.gotoFrame=function(t){var e=this.anims[this.currentAnim];if(e)return this.currentFrame=t,this._frameTime=0,this.texture=this.textures[e.frames[t]],this},e.prototype.updateAnimation=function(){var t=this.anims[this.currentAnim];if(this.playing&&(this._frameTime+=t.speed*game.system.delta),this._frameTime>=1){if(this._frameTime=0,t.random&&t.frames.length>1){for(var e=this.currentFrame;e===this.currentFrame;)e=Math.round(Math.random(0,t.frames.length-1));return this.currentFrame=e,void(this.texture=this.textures[t.frames[e]])}(e=this.currentFrame+(t.reverse?-1:1))>=t.frames.length?t.loop?(this.currentFrame=0,this.texture=this.textures[t.frames[0]]):(this.playing=!1,t.onComplete&&t.onComplete()):0>e?t.loop?(this.currentFrame=t.frames.length-1,this.texture=this.textures[t.frames.last()]):(this.playing=!1,t.onComplete&&t.onComplete()):(this.currentFrame=e,this.texture=this.textures[t.frames[e]])}},e.prototype.updateTransform=function(){this.currentAnim&&this.updateAnimation(),s.Sprite.prototype.updateTransform.call(this)},e.fromFrames=function(t){var e=[];for(var i in game.Texture.cache)0===i.indexOf(t)&&e.push(game.Texture.cache[i]);return e.length>0?new game.Animation(e):void 0},game.Animation=e,i.prototype=Object.create(s.Sprite.prototype),i.prototype.constructor=i,Object.defineProperty(i.prototype,"texture",{get:function(){return this._texture},set:function(t){var e=t;"string"==typeof e&&(e=game.paths[e]||e,e=game.Texture.fromFrame(e)),this._texture!==e&&(this._texture=e,this.cachedTint=16777215,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}),i.prototype.crop=function(t,e,i,n){var r=new s.Texture(this.texture,new game.HitRectangle(t,e,i,n));return this.texture=r,this},i.prototype.center=function(t,e){return this.position.x=game.system.width/2-this.width/2+this.width*this.anchor.x,this.position.y=game.system.height/2-this.height/2+this.height*this.anchor.y,this.position.x+=t||0,this.position.y+=e||0,this},i.fromFrame=s.Sprite.fromFrame,i.fromImage=s.Sprite.fromImage,game.Sprite=i,game.Texture.fromAsset=function(t){var e=game.paths[t]||t,i=s.utils.TextureCache[e];return i||(i=game.Texture.fromFrame(e)),i},n.prototype=Object.create(s.extras.TilingSprite.prototype),n.prototype.constructor=n,n.prototype.update=function(){this.tilePosition.x+=this.speed.x*game.system.delta,this.tilePosition.y+=this.speed.y*game.system.delta},game.TilingSprite=n,r.prototype.frame=function(t){return t=t.limit(0,this.frames-1),new i(this.textures[t])},r.prototype.anim=function(t,i,n){i=i||0;var r=[];if((t=t||this.frames).length>0)for(var o=0;o<t.length;o++)r.push(this.textures[i+t[o]]);else for(o=0;t>o;o++)r.push(this.textures[i+o]);return n?r:new e(r)},game.SpriteSheet=r,o.prototype._loaded=function(){"function"==typeof this._loadCallback&&this._loadCallback()},o.prototype._complete=function(){"function"==typeof this._completeCallback&&this._completeCallback()},o.prototype.onLoaded=function(t){this._loadCallback=t},o.prototype.onComplete=function(t){this._completeCallback=t},o.prototype.play=function(){this.videoElem.loop=!!this.loop,this.videoElem.play()},o.prototype.stop=function(t){this.videoElem.pause(),t&&this.sprite.remove()},game.Video=o})),game.module("engine.scene").require("engine.renderer").body((function(){function t(e){game.EventEmitter.call(this),game.scene=this,this.backgroundColor=this.backgroundColor||t.backgroundColor,this.swipeDist=this.swipeDist||100,this.swipeTime=this.swipeDist||500,this.emitters=[],this.objects=[],this.stage=null,this.timers=[],this.tweens=[],this.mouse=null,this._updateOrder=[],!this.backgroundColor&&game.device.cocoonCanvasPlus&&(this.backgroundColor=0),game.audio&&game.Audio.stopOnSceneChange&&game.scene&&(game.audio.stopMusic(),game.audio.stopSound(!1,!0),game.audio.pausedSounds.length=0,game.audio.playingSounds.length=0);for(var i=0;i<t.updateOrder.length;i++)this._updateOrder.push(t.updateOrder[i].ucfirst());if(game.system.stage.removeChildren(),game.system.renderer.backgroundColor=this.backgroundColor,this.stage=new game.Container,game.system.webGL&&game.device.cocoonJS){var n=game.renderer.width/game.renderer.height;if(game.system.width/game.system.height>n){var r=game.renderer.width/game.system.width;this.stage.scale.set(r,r),this.stage.position.y=game.renderer.height/2-game.system.height*r/2}else{r=game.renderer.height/game.system.height;this.stage.scale.set(r,r),this.stage.position.x=game.renderer.width/2-game.system.width*r/2}}game.system.stage.addChild(this.stage),this.stage.interactive=!0,this.stage.containsPoint=function(){return!0},this.stage.on("mousedown",this._mousedown,this),this.stage.on("mousemove",this._mousemove,this),this.stage.on("mouseup",this._mouseup,this),this.stage.on("mouseout",this._mouseout,this),this.stage.on("touchstart",this._touchstart,this),this.stage.on("touchmove",this._touchmove,this),this.stage.on("touchend",this._touchend,this),game.debugDraw&&game.debugDraw.reset()}t.prototype=Object.create(game.EventEmitter.prototype),t.prototype.constructor=t,t.prototype.addEmitter=function(t){-1===this.emitters.indexOf(t)&&this.emitters.push(t)},t.prototype.addObject=function(t){-1===this.objects.indexOf(t)&&(t._remove=!1,this.objects.push(t))},t.prototype.addTimer=function(t,e,i){var n;return(n=game.pool.get("Timer"))?game.Timer.call(n,t):n=new game.Timer(t),n.repeat=!!i,n.callback=e,this.timers.push(n),n},t.prototype.addTween=function(t,e,i,n){var r=new game.Tween(t);for(var o in r.to(e,i),n)r[o](n[o]);return r},t.prototype.exit=function(){},t.prototype._exit=function(){this.stage.off("mousedown",this._mousedown,this),this.stage.off("mousemove",this._mousemove,this),this.stage.off("mouseup",this._mouseup,this),this.stage.off("mouseout",this._mouseout,this),this.stage.off("touchstart",this._touchstart,this),this.stage.off("touchmove",this._touchmove,this),this.stage.off("touchend",this._touchend,this),this.emit("exit"),this.exit()},t.prototype.keydown=function(){},t.prototype.keyup=function(){},t.prototype.mousedown=function(){},t.prototype.mouseup=function(){},t.prototype.mousemove=function(){},t.prototype.mouseout=function(){},t.prototype.touchstart=function(){},t.prototype.touchmove=function(){},t.prototype.touchend=function(){},t.prototype.swipe=function(){},t.prototype.removeEmitter=function(t){t&&t.remove()},t.prototype.removeObject=function(t){t._remove=!0},t.prototype.removeTimer=function(t,e){t&&(e||(t.callback=null),t.repeat=!1,t.set(0))},t.prototype.removeTimers=function(t){for(var e=this.timers.length-1;e>=0;e--)this.removeTimer(this.timers[e],t)},t.prototype.removeTweens=function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t]._shouldRemove=!0},t.prototype.clear=function(){for(var t=this.stage.children.length-1;t>=0;t--)this.stage.removeChild(this.stage.children[t])},t.prototype.pause=function(){game.audio&&game.audio._systemPause()},t.prototype.resume=function(){game.audio&&game.audio._systemResume()},t.prototype.update=function(){},t.prototype._mousedown=function(t){t.data._swipeStartTime=Date.now(),t.data._swipeX=t.data.global.x,t.data._swipeY=t.data.global.y,this.mousedown(t),this.emit("mousedown",t)},t.prototype._mousemove=function(t){this.mousemove(t),this.emit("mousemove",t),t.data._swipeStartTime&&(t.data.type="swipe",t.data.global.x-t.data._swipeX>=t.data.swipeDist?t.data.dir="right":t.data.global.x-this._swipeX<=-this.swipeDist?t.data.dir="left":t.data.global.y-this._swipeY>=this.swipeDist?t.data.dir="down":t.data.global.y-this._swipeY<=-this.swipeDist&&(t.data.dir="up"),this._swipe(t))},t.prototype._mouseup=function(t){this.mouseup(t),this.emit("mouseup",t)},t.prototype._mouseout=function(t){this.mouseout(t),this.emit("mouseout",t)},t.prototype._touchstart=function(t){t.data._swipeStartTime=Date.now(),t.data._swipeX=t.data.global.x,t.data._swipeY=t.data.global.y,this.touchstart(t),this.emit("touchstart",t)},t.prototype._touchmove=function(t){this.touchmove(t),this.emit("touchmove",t),t.data._swipeStartTime&&(t.data.type="swipe",t.data.dir="none",t.data.global.x-t.data._swipeX>=this.swipeDist?t.data.dir="right":t.data.global.x-t.data._swipeX<=-this.swipeDist?t.data.dir="left":t.data.global.y-t.data._swipeY>=this.swipeDist?t.data.dir="down":t.data.global.y-t.data._swipeY<=-this.swipeDist&&(t.data.dir="up"),"none"!==t.data.dir&&this._swipe(t))},t.prototype._touchend=function(t){this.touchend(t),this.emit("touchend",t)},t.prototype._swipe=function(t){var e=Date.now()-t.data._swipeStartTime;t.data._swipeStartTime=null,(e<=this.swipeTime||0===this.swipeTime)&&(this.swipe(t),this.emit("swipe",t))},t.prototype.run=function(){this.emit("update"),this.update();for(var t=0;t<this._updateOrder.length;t++)this["_update"+this._updateOrder[t]]()},t.prototype._updateEmitters=function(){for(var t=this.emitters.length-1;t>=0;t--)this.emitters[t]._update(),this.emitters[t]._remove&&this.emitters.splice(t,1)},t.prototype._updateObjects=function(){for(var t=this.objects.length-1;t>=0;t--)"function"!=typeof this.objects[t].update||this.objects[t]._remove||this.objects[t].update(),this.objects[t]._remove&&this.objects.splice(t,1)},t.prototype._updatePhysics=function(){this.world&&this.world._update()},t.prototype._updateRenderer=function(){game.debugDraw&&game.debugDraw.update(),game.renderer.render(game.system.stage)},t.prototype._updateTimers=function(){for(var t,e=this.timers.length-1;e>=0;e--)(t=this.timers[e]).time()>=0&&("function"==typeof t.callback&&t.callback(),t.repeat?t.reset():(game.pool.put("Timer",t),this.timers.splice(e,1)))},t.prototype._updateTweens=function(){for(var t=this.tweens.length-1;t>=0;t--)this.tweens[t]._update()||this.tweens.splice(t,1)},game.addAttributes(t,{updateOrder:["tweens","physics","timers","emitters","objects","renderer"],backgroundColor:0}),game.Scene=t})),game.module("engine.storage").body((function(){function t(e){this.id=e||t.id,this.supported=this._isSupported()}t.prototype.set=function(t,e){return!!this.supported&&void localStorage.setItem(this.id+"."+t,this._encode(e))},t.prototype.get=function(t,e){var i=localStorage.getItem(this.id+"."+t);if(null===i)return e;try{return this._decode(i)}catch(t){return i}},t.prototype.has=function(t){return null!==localStorage.getItem(this.id+"."+t)},t.prototype.remove=function(t){localStorage.removeItem(this.id+"."+t)},t.prototype.reset=function(){for(var t=localStorage.length-1;t>=0;t--){var e=localStorage.key(t);-1!==e.indexOf(this.id+".")&&localStorage.removeItem(e)}},t.prototype._encode=function(t){return JSON.stringify(t)},t.prototype._decode=function(t){return JSON.parse(t)},t.prototype._isSupported=function(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(t){return!1}return!0},game.addAttributes(t,{id:""}),game.Storage=t})),game.module("engine.system").body((function(){function t(){this.currentSceneName=null,this.width=null,this.height=null,this.delta=0,this.timer=null,this.canvas=null,this.paused=!1,this.hires=!1,this.retina=!1,this.rotateScreenVisible=!1,this.gameLoopId=0,this.webGL=!1,this.originalWidth=null,this.originalHeight=null,this.newSceneClass=null,this.running=!1;var e=t.width,i=t.height;if("window"===e&&(e=window.innerWidth),"window"===i&&(i=window.innerHeight),this.originalWidth=e,this.originalHeight=i,this.retina=!0,game.scale=2,this.width=e,this.height=i,this.canvasId=t.canvasId,this.timer=new game.Timer,this.initRenderer(e,i),game._normalizeVendorAttribute(this.canvas,"requestFullscreen"),game._normalizeVendorAttribute(this.canvas,"requestFullScreen"),game._normalizeVendorAttribute(navigator,"vibrate"),this.canvas.style.width=e+"px",this.canvas.style.height=i+"px",game.renderer=this.renderer,game.device.cocoonJS)this.resizeToFill(),this.canvas.style.cssText="idtkscale:"+t.idtkScale+";";else{window.sdkHandler.setPauseUnPause((function(){t.pauseOnHide&&game.system.pause(!0)}),(function(){t.pauseOnHide&&game.system.resume(!0)})),t.bgColor&&!t.bgColorMobile&&(t.bgColorMobile=t.bgColor),t.bgColorMobile&&!t.bgColorRotate&&(t.bgColorRotate=t.bgColorMobile),t.bgImage&&!t.bgImageMobile&&(t.bgImageMobile=t.bgImage),t.bgImageMobile&&!t.bgImageRotate&&(t.bgImageRotate=t.bgImageMobile),game.device.mobile||(t.bgColor&&(document.body.style.backgroundColor=t.bgColor),t.bgImage&&(document.body.style.backgroundImage="url("+game.getMediaPath(t.bgImage)+")")),t.bgPosition&&(document.body.style.backgroundPosition=t.bgPosition),this.initResize()}}t.prototype.initRenderer=function(e,i){if(!document.getElementById(this.canvasId)){var n=document.createElement("canvas");game.device.cocoonJS&&(n.screencanvas=!!t.screenCanvas),n.id=this.canvasId,document.body.appendChild(n)}game.PIXI.SCALE_MODES.DEFAULT=game.PIXI.SCALE_MODES[t.scaleMode.toUpperCase()]||0,t.webGL&&game.device.cocoonJS&&(e=window.innerWidth*game.device.pixelRatio,i=window.innerHeight*game.device.pixelRatio),game.PIXI.RESOLUTION=game.scale,t.webGL?this.renderer=game.autoDetectRenderer(e,i,{view:document.getElementById(this.canvasId),transparent:t.transparent,antialias:t.antialias,resolution:game.scale}):this.renderer=new game.CanvasRenderer(e,i,{view:document.getElementById(this.canvasId),transparent:t.transparent,antialias:t.antialias,resolution:game.scale}),this.webGL=!!this.renderer.gl,this.canvas=this.renderer.view,this.stage=new game.Container},t.prototype.resizeToFill=function(){if(t.resize&&(!game.device.mobile||!this.rotateScreenVisible)){game.device.mobile;var e=t.width/t.height;window.innerWidth/window.innerHeight>e?(this.height=t.height,this.width=Math.round(this.height*(window.innerWidth/window.innerHeight))):(this.width=t.width,this.height=Math.round(this.width*(window.innerHeight/window.innerWidth))),this.resize(this.width,this.height)}},t.prototype.fullscreen=function(){this.canvas.requestFullscreen?this.canvas.requestFullscreen():this.canvas.requestFullScreen&&this.canvas.requestFullScreen()},t.prototype.fullscreenSupport=function(){return!(!this.canvas.requestFullscreen&&!this.canvas.requestFullScreen)},t.prototype.vibrate=function(t){return!!navigator.vibrate&&navigator.vibrate(t)},t.prototype.pause=function(t){this.paused||(t?this.pausedOnHide=!0:this.paused=!0,game.scene&&game.scene.pause())},t.prototype.resume=function(t){t&&this.paused||(t||this.paused)&&(t?this.pausedOnHide=!1:this.paused=!1,game.Timer.last=performance.now(),game.scene&&game.scene.resume())},t.prototype.setScene=function(t,e){this.currentSceneName=t;var i=game.s[t];this.running&&!this.paused?(this.newSceneClass=i,this.removeAssets=e):this.setSceneNow(i,e)},t.prototype.setSceneNow=function(t,e){this.paused&&(this.paused=!1),game.scene&&game.scene._exit(),e&&game.removeAssets(),game.scene=new t,game.Debug&&game.Debug.enabled&&!game.device.cocoonJS&&!this.debug&&(this.debug=new game.Debug),this.newSceneClass=null,this.startRunLoop()},t.prototype.startRunLoop=function(){this.gameLoopId&&this.stopRunLoop(),this.gameLoopId=game._setGameLoop(this.run.bind(this),this.canvas),this.running=!0},t.prototype.stopRunLoop=function(){game._clearGameLoop(this.gameLoopId),this.running=!1},t.prototype.run=function(t){this.paused||this.pausedOnHide||(game.Timer.update(t),this.delta=this.timer.delta()/1e3,this.debug&&this.debug.reset(),game.scene.run(),this.debug&&this.debug.update(),this.newSceneClass&&this.setSceneNow(this.newSceneClass,this.removeAssets))},t.prototype.resize=function(t,e){this.renderer.resize(t,e),game.scene&&game.scene.resize&&game.scene.resize(t,e)},t.prototype.initResize=function(){if(this.ratio=this.width>this.height?this.width/this.height:this.height/this.width,t.resize&&(t.center=!1,t.scale=!1),t.center&&(this.canvas.style.position="absolute",this.canvas.style.margin="auto",this.canvas.style.top=0,this.canvas.style.left=0,this.canvas.style.bottom=0,this.canvas.style.right=0),game.device.mobile&&t.rotateScreen){var e=document.createElement("div");if(e.innerHTML=t.rotateImg?"":t.rotateMsg,e.style.position="absolute",e.style.height="12px",e.style.textAlign="center",e.style.left=0,e.style.right=0,e.style.top=0,e.style.bottom=0,e.style.margin="auto",e.style.display="none",e.id="panda-rotate",t.rotateDiv=e,document.body.appendChild(t.rotateDiv),t.rotateImg){var i=new Image,n=this;i.onload=function(){e.image=i,e.style.height=i.height+"px",e.appendChild(i),n.resizeRotateImage()},0===t.rotateImg.indexOf("data:")?i.src=t.rotateImg:i.src=game._getFilePath(t.rotateImg),i.style.position="relative",i.style.maxWidth="100%"}}void 0===window.onorientationchange||game.device.android?window.onresize=this.onResize.bind(this):window.onorientationchange=this.onResize.bind(this),this.onResize()},t.prototype.checkOrientation=function(){this.orientation=window.innerWidth<window.innerHeight?"portrait":"landscape",game.device.android2&&320===window.innerWidth&&251===window.innerHeight&&(this.orientation="portrait"),this.width>this.height&&"landscape"!==this.orientation||this.width<this.height&&"portrait"!==this.orientation?this.rotateScreenVisible=!0:this.rotateScreenVisible=!1,t.rotateScreen||(this.rotateScreenVisible=!1),this.canvas.style.display=this.rotateScreenVisible?"none":"block",t.rotateDiv&&(t.rotateDiv.style.display=this.rotateScreenVisible?"block":"none"),this.rotateScreenVisible&&t.bgColorRotate&&(document.body.style.backgroundColor=t.bgColorRotate),!this.rotateScreenVisible&&t.bgColorMobile&&(document.body.style.backgroundColor=t.bgColorMobile),this.rotateScreenVisible&&t.bgImageRotate&&(document.body.style.backgroundImage="url("+game.getMediaPath(t.bgImageRotate)+")"),!this.rotateScreenVisible&&t.bgImageMobile&&(document.body.style.backgroundImage="url("+game.getMediaPath(t.bgImageMobile)+")"),this.rotateScreenVisible&&game.system&&"function"==typeof game.system.pause&&game.system.pause(),!this.rotateScreenVisible&&game.system&&"function"==typeof game.system.resume&&game.system.resume(),this.rotateScreenVisible&&this.resizeRotateImage()},t.prototype.resizeRotateImage=function(){this.rotateScreenVisible&&t.rotateDiv.image&&window.innerHeight<t.rotateDiv.image.height&&(t.rotateDiv.image.style.height=window.innerHeight+"px",t.rotateDiv.image.style.width="auto",t.rotateDiv.style.height=window.innerHeight+"px",t.rotateDiv.style.bottom="auto")},t.prototype.onResize=function(){if(game.device.mobile&&this.checkOrientation(),t.scale||t.resize)if(game.device.mobile){this.ratio="landscape"===this.orientation?this.width/this.height:this.height/this.width,this.resizeToFill();var e=window.innerWidth,i=window.innerHeight;game.device.iOS7&&256===window.innerHeight&&(i=320),game.device.iOS7&&319===window.innerHeight&&(i=320),game.device.iOS7&&2===game.device.pixelRatio&&"landscape"===this.orientation&&(i+=2),game.device.iPad&&671===i&&(i=672),this.width>this.height?"landscape"===this.orientation&&i*this.ratio<=e?(this.canvas.style.height=i+"px",this.canvas.style.width=i*this.width/this.height+"px"):(this.canvas.style.width=e+"px",this.canvas.style.height=e*this.height/this.width+"px"):"portrait"===this.orientation&&e*this.ratio<=i?(this.canvas.style.width=e+"px",this.canvas.style.height=e*this.height/this.width+"px"):(this.canvas.style.height=i+"px",this.canvas.style.width=i*this.width/this.height+"px"),game.device.ejecta||window.scroll(0,1),this.rotateScreenVisible||!game._loader||game._loader.started||game._loader.start()}else{if(0===window.innerWidth)return;t.scale?window.innerWidth<this.width||window.innerHeight<this.height||t.scale?window.innerWidth/this.width<window.innerHeight/this.height?(this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=Math.floor(window.innerWidth*(this.height/this.width))+"px"):(this.canvas.style.height=window.innerHeight+"px",this.canvas.style.width=Math.floor(window.innerHeight*(this.width/this.height))+"px"):(this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px"):t.resize&&(this.resizeToFill(),this.canvas.style.width="100%",this.canvas.style.height="100%")}},game.addAttributes(t,{center:!0,scale:!0,resize:!1,idtkScale:"ScaleAspectFit",screenCanvas:!0,hires:0,retina:!1,pauseOnHide:!0,rotateScreen:!0,width:1024,height:768,bgColor:"#958BAB",bgColorMobile:null,bgColorRotate:null,bgImage:null,bgImageMobile:null,bgImageRotate:null,bgPosition:null,rotateMsg:"Please rotate your device",rotateImg:null,webGL:!1,transparent:!1,antialias:!1,startScene:"Main",canvasId:"canvas",scaleMode:"linear"}),game.System=t})),game.module("engine.timer").body((function(){function t(t){this.target=0,this.base=0,this._last=game.Timer.time,this._pauseTime=0,this.set(t)}t.prototype.set=function(t){"number"!=typeof t&&(t=0),this.target=t,this.reset()},t.prototype.reset=function(){this.base=t.time,this._pauseTime=0},t.prototype.delta=function(){var e=t.time-this._last;return this._last=t.time,this._pauseTime?0:e},t.prototype.time=function(){var e=(this._pauseTime||t.time)-this.base-this.target;return e},t.prototype.pause=function(){this._pauseTime||(this._pauseTime=t.time)},t.prototype.resume=function(){this._pauseTime&&(this.base+=t.time-this._pauseTime,this._pauseTime=0)},game.addAttributes(t,{time:0,speed:1,minFPS:20,delta:0,_last:0,_realDelta:0,update:function(t){var e=t||Date.now();this._last||(this._last=e),this._realDelta=e-this._last,this.delta=Math.min(this._realDelta,1e3/this.minFPS)*this.speed,this.time+=this.delta,this._last=e}}),game.Timer=t})),game.module("engine.tween").body((function(){function t(t){if("object"!=typeof t)throw"Tween parameter must be object";for(var e in this.chainedTweens=[],this.currentTime=0,this.delayRepeat=!1,this.delayTime=0,this.duration=1e3,this.easingFunction=game.Tween.Easing.Linear.None,this.interpolationFunction=game.Tween.Interpolation.Linear,this.object=t,this.onCompleteCallback=null,this.onRepeatCallback=null,this.onStartCallback=null,this.onUpdateCallback=null,this.paused=!1,this.playing=!1,this.repeatCount=0,this.reversed=!1,this.yoyoEnabled=!1,this._onStartCallbackFired=!1,this._originalStartTime=null,this._repeats=0,this._shouldRemove=!1,this._startTime=null,this._valuesEnd=null,this._valuesStart={},this._valuesStartRepeat={},t)"number"==typeof t[e]&&(this._valuesStart[e]=parseFloat(t[e],10))}function e(t){this.onComplete=t,this.tweens=[],this._complete=!1}var i;t.prototype.chain=function(){return this.chainedTweens=arguments,this},t.prototype.delay=function(t,e){return this.delayTime=t,this.delayRepeat=!!e,this},t.prototype.easing=function(e){return"string"==typeof e?(e=e.split("."),this.easingFunction=t.Easing[e[0]][e[1]]):this.easingFunction=e,this},t.prototype.interpolation=function(t){return this.interpolationFunction=t,this},t.prototype.onComplete=function(t){return this.onCompleteCallback=t,this},t.prototype.onRepeat=function(t){return this.onRepeatCallback=t,this},t.prototype.onStart=function(t){return this.onStartCallback=t,this},t.prototype.onUpdate=function(t){return this.onUpdateCallback=t,this},t.prototype.pause=function(){this.paused=!0},t.prototype.repeat=function(t){return void 0===t&&(t=1/0),this.repeatCount=t,this},t.prototype.resume=function(){this.paused=!1},t.prototype.start=function(){for(var t in game.scene&&game.scene.tweens.push(this),this.currentTime=0,this.playing=!0,this._onStartCallbackFired=!1,this._startTime=this.delayTime,this._originalStartTime=this._startTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this.object[t]].concat(this._valuesEnd[t])}this._valuesStart[t]=this.object[t],this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0}return this},t.prototype.stop=function(){return this.playing?(this.playing=!1,this._shouldRemove=!0,this._stopChainedTweens(),this):this},t.prototype.to=function(t,e){return this.duration=e||this.duration,this._valuesEnd=t,this},t.prototype.yoyo=function(t){return void 0===t&&(t=!0),this.yoyoEnabled=t,this},t.prototype._stopChainedTweens=function(){for(var t=0,e=this.chainedTweens.length;e>t;t++)this.chainedTweens[t].stop()},t.prototype._update=function(){if(this._shouldRemove)return!1;if(this.paused)return!0;if(this.currentTime+=1e3*game.system.delta,this.currentTime<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this.onStartCallback&&this.onStartCallback.call(this.object),this._onStartCallbackFired=!0);var t=(this.currentTime-this._startTime)/this.duration;t=t>1?1:t;var e,i=this.easingFunction(t);for(e in this._valuesEnd){var n=this._valuesStart[e]||0,r=this._valuesEnd[e];r instanceof Array?this.object[e]=this.interpolationFunction(r,i):("string"==typeof r&&(r=n+parseFloat(r,10)),"number"==typeof r&&(this.object[e]=n+(r-n)*i))}if(null!==this.onUpdateCallback&&this.onUpdateCallback.call(this.object,i),1===t){if(this.repeatCount>0){for(e in isFinite(this.repeatCount)&&this.repeatCount--,this._repeats+=1,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e],10)),this.yoyoEnabled){var o=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=o,this.reversed=!this.reversed}this._valuesStart[e]=this._valuesStartRepeat[e]}return this.delayRepeat||(this.delayTime=0),this._startTime=this._originalStartTime+this._repeats*(this.duration+this.delayTime),null!==this.onRepeatCallback&&this.onRepeatCallback.call(this.object),!0}this.playing=!1,null!==this.onCompleteCallback&&this.onCompleteCallback.call(this.object);for(var s=0,a=this.chainedTweens.length;a>s;s++)this.chainedTweens[s].start();return!1}return!0},game.addAttributes(t,{Easing:{Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},Out:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},InOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||1>i?(i=1,e=.1):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)}},Back:{In:function(t){return t*t*(3*t-2)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-game.Tween.Easing.Bounce.Out(1-t)},Out:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*game.Tween.Easing.Bounce.In(2*t):.5*game.Tween.Easing.Bounce.Out(2*t-1)+.5}}},Interpolation:{Linear:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),o=game.Tween.Interpolation.Utils.Linear;return 0>e?o(t[0],t[1],n):e>1?o(t[i],t[i-1],i-n):o(t[r],t[r+1>i?i:r+1],n-r)},Bezier:function(t,e){var i,n=0,r=t.length-1,o=Math.pow,s=game.Tween.Interpolation.Utils.Bernstein;for(i=0;r>=i;i++)n+=o(1-e,r-i)*o(e,i)*t[i]*s(r,i);return n},CatmullRom:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),o=game.Tween.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(0>e&&(r=Math.floor(n=i*(1+e))),o(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):0>e?t[0]-(o(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(o(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):o(t[r?r-1:0],t[r],t[r+1>i?i:r+1],t[r+2>i?i:r+2],n-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=game.Tween.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(i=[1],function(t){var e,n=1;if(i[t])return i[t];for(e=t;e>1;e--)n*=e;return i[t]=n}),CatmullRom:function(t,e,i,n,r){var o=.5*(i-t),s=.5*(n-e),a=r*r;return(2*e-2*i+o+s)*(r*a)+(-3*e+3*i-2*o-s)*a+o*r+e}}}}),game.Tween=t,e.prototype.add=function(t){return t.onComplete(this._tweenComplete.bind(this)),this.tweens.push(t),t},e.prototype.pause=function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].pause()},e.prototype.remove=function(t){this.tweens.erase(t)},e.prototype.resume=function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].resume()},e.prototype.start=function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].start()},e.prototype.stop=function(t,e){if(!this._complete){for(var i=0;i<this.tweens.length;i++)this.tweens[i].stop(e);!this._complete&&t&&this._tweenComplete(),this._complete=!0}},e.prototype._tweenComplete=function(){if(!this._complete){for(var t=0;t<this.tweens.length;t++)if(this.tweens[t].playing)return;this._complete=!0,"function"==typeof this.onComplete&&this.onComplete()}},game.TweenGroup=e})),game.module("game.main").require("game.data","game.menu","game.shop","game.playground","game.game-over","game.bonus","game.content").body((function(){function t(){game.Scene.call(this),this.addTimer(10,(function(){var t=EXAPI.getLanguage();game.content=game.texts[t],"en"!==t&&(game.USE_FONT=!0),EXAPI.getStorageItem&&EXAPI.setStorageItem&&(game.storage.get=EXAPI.getStorageItem,game.storage.set=EXAPI.setStorageItem),EXAPI.setOrientationHandler((function(){game.system.checkOrientation()})),EXAPI.setResizeHandler((function(){game.system.onResize()})),EXAPI.setPauseHandler((function(){game.system.pause()})),EXAPI.setUnpauseHandler((function(){game.system.resume()})),game.incentivise=function(){return EXAPI.isEnabledIncentiviseButton()},game.G.fetch(),game.system.setScene("Menu"),EXAPI.start()}))}var e="logo.png";"ja"===EXAPI.getLanguage()&&(e="logo_ja.png"),game.addAsset(e,"logo"),game.addAsset("bg_select.png","bg_select"),game.addAsset("bg_02.png","bg_02"),game.addAsset("bg_03.png","bg_03"),game.addAsset("bg_04.png","bg_04"),game.addAsset("bg_05.png","bg_05"),game.addAsset("button_video_heart.png","button_video_heart"),game.addAsset("claim_button_heart.png","claim_button_heart"),game.addAsset("video.png","video"),game.addAsset("touch.png","touch"),game.addAsset("finger.png","finger"),game.addAsset("key_left.png","key_left"),game.addAsset("key_right.png","key_right"),game.addAsset("shine.png","shine"),game.addAsset("shild_01.png","shild_01"),game.addAsset("coin-plus.png","coin-plus"),game.addAsset("heart-plus.png","heart-plus"),game.addAsset("scene.json"),game.addAsset("bomb.json"),game.addAsset("ui.json"),game.addAsset("character.json"),game.addAsset("PixelDigivolve.fnt"),game.addAudio("jump.m4a","jump"),game.addAudio("heart.m4a","heart-snd"),game.addAudio("coin.m4a","coin"),game.addAudio("reward.m4a","reward"),game.addAudio("bg-pigeon.m4a","bg-pigeon"),game.addAudio("bg-bird.m4a","bg-bird"),game.addAudio("crash.m4a","crash"),game.addAudio("snap.m4a","snap"),game.addAudio("hit-car.m4a","hit-car"),game.addAudio("car-horn.m4a","car-horn"),game.addAudio("click.m4a","click"),game.addAudio("click-s.m4a","click-s"),game.addAudio("burn.m4a","burn"),game.addAudio("explo.m4a","explo"),game.addAudio("din.m4a","din"),t.prototype=Object.create(game.Scene.prototype),t.prototype.constructor=t,game.s.Main=t})),game.module("game.data").body((function(){function t(){var t=Date.now()-game.G.bonusTriggerTime;return t>60*e*1e3?game.G.bonusAvailable=!0:game.G.bonusTimer$.value=60*e*1e3-t,game.G.bonusAvailable?(clearInterval(game.G.bonusTimer),void(game.scene&&game.scene.emit("bonusAvailable"))):void 0}var e=10;game.G={CHARACTERS:[{name:"K.SEEL",price:100},{name:"Piggy",price:110},{name:"Superboy",price:120},{name:"Batboy",price:130},{name:"Cyboy",price:140},{name:"Pengy",price:150},{name:"Ducky",price:160},{name:"King Bob",price:170},{name:"Bunny",price:180},{name:"Box Bee",price:190},{name:"Sheepy",price:200},{name:"Alien Me",price:210},{name:"Snowman",price:220},{name:"Mr.Pop",price:230},{name:"Fisher",price:240}],char:0,best:0,hasRecord:!1,newHighScore:!1,score:0,currScore:0,newCoins:0,tutWatched:!1,isContinue:!1,bonusCountText:"",heartCount:0,heartCountIdx:-1,unlocks:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fetch:function(){if(game.G.coin$=game.R.variable(0),game.G.heart$=game.R.variable(5),game.G.bonusTimer$=game.R.variable(0),game.G.bonusAvailable=!0,game.G.heart$.onValue((function(t){0===t&&(game.G.heartCount=59,game.G.heartCountIdx=setInterval((function(){game.G.heartCount-=1,game.G.heartCount<=0&&(clearInterval(game.G.heartCountIdx),game.G.heart+=1)}),1e3))})),game.storage.supported){var e=game.storage.get(game.Storage.id);if(!e)return;"number"==typeof(e=JSON.parse(e)).coin&&(game.G.coin=e.coin),"number"==typeof e.heart&&(game.G.heart=e.heart),"number"==typeof e.best&&(game.G.best=e.best),"number"==typeof e.bonusTriggerTime?game.G.bonusTriggerTime=e.bonusTriggerTime:game.G.bonusTriggerTime=Date.now(),game.G.bonusAvailable=0===game.G.getBonusRestTime(),game.G.bonusAvailable||(game.G.bonusTimer=setInterval(t,1e3));var i=e.unlocks;i&&i instanceof Array&&15===i.length&&(game.G.unlocks=i),game.G.best>0&&!game.G.isContinue&&(game.G.hasRecord=!0)}},save:function(){game.storage.supported&&game.storage.set(game.Storage.id,JSON.stringify({coin:game.G.coin,heart:1e8,best:game.G.best,unlocks:game.G.unlocks,bonusTriggerTime:game.G.bonusTriggerTime}))},getBonus:function(){game.G.bonusAvailable&&(game.G.bonusAvailable=!1,game.G.bonusTriggerTime=Date.now(),game.G.bonusTimer=setInterval(t,1e3),game.G.save())},getBonusRestTime:function(){return Math.max(0,Math.floor(60*e-(Date.now()-game.G.bonusTriggerTime)/1e3))},resetBonusTimer:function(){game.G.bonusTimer$.value=0,game.G.bonusAvailable=!0,clearInterval(game.G.bonusTimer),game.G.bonusTriggerTime=Date.now()-60*e*1e3,game.G.save()}},Object.defineProperty(game.G,"coin",{get:function(){return this.coin$.value},set:function(t){this.coin$.value=t}}),Object.defineProperty(game.G,"heart",{get:function(){return this.heart$.value},set:function(t){this.heart$.value=t}})})),game.module("game.menu").require("game.cloud").body((function(){function t(){function t(){this.isDown||(this.isDown=!0,this.scale.set(.8))}function n(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("toggleSound"),game.audio.playSound("click"))}function r(){this.isDown||(this.isDown=!0,this.scale.set(.8))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.audio.playSound("click"),game.scene.emit("moreGames"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.8),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("startGame"))}function l(t){t?(D.texture="button_sound",game.audio.musicMuted=game.audio.soundMuted=!1):(D.texture="button_sound_off",game.audio.musicMuted=game.audio.soundMuted=!0)}function h(){EXAPI.redirectToPortal()}function u(){game.G.tutWatched?game.system.setScene("Shop"):game.system.setScene("Playground")}game.Scene.call(this);var c=new game.Sprite("bg_select",0,0,{width:game.system.width,height:game.system.height}).addTo(this.stage);new i(10,100,this.stage),new i(320,300,this.stage),new i(120,400,this.stage),new i(400,500,this.stage);var d=(new game.Container).addTo(this.stage);d.x=.5*(game.system.width-game.System.width),game.R.fromEvents(this,"resize").onValue((function(){c.width=game.system.width,c.height=game.system.height,d.x=.5*(game.system.width-game.System.width),d.y=.5*(game.system.height-game.System.height)}));var p=(new game.Sprite("logo",.5*game.System.width,.5*game.System.height-40,{anchor:e}).addTo(d),new game.Animation(["sting_01_a","sting_01_b","sting_01_c"]).addTo(d));p.anchor.set(.5),p.position.set(316,68),p.addAnim("a",[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],{speed:20}),p.play("a");var f=new game.Animation(["coin_small","coin_small_02","coin_small_03","coin_small_04"]).addTo(d);f.anchor.set(.5,1.2),f.position.set(190,160),f.addAnim("a",[0,1,2,3,2,1],{speed:10}),f.play("a");var m=new game.Sprite("shine").addTo(d);m.anchor.set(.5,.5),m.position.set(185,400);var g=new game.Animation(["box_a","box_b"]).addTo(d);g.anchor.set(.5,1),g.position.set(185,424),g.addAnim("a",[0,1,1,1],{speed:1}),g.play("a"),this.addTimer(10,(function(){m.rotation+=Math.PI*game.system.delta*.5,0!==g.currentFrame?m.visible=!0:m.visible=!1}),!0);var v=new game.Sprite("shadow_small").addTo(d);v.anchor.set(.5,100/132);var y=new game.Sprite("car_01_b").addTo(d);y.anchor.set(.5,1),y.position.set(76,176),v.position.copy(y.position).add(10,-5);var b=new game.Tween(y.position).to({x:88,y:140},450).easing("Quadratic.Out"),_=new game.Tween(y.position).to({x:108,y:186},450).easing("Quadratic.In"),x=new game.Tween(y.position).to({x:88,y:140},450).easing("Quadratic.Out"),w=new game.Tween(y.position).to({x:76,y:176},450).easing("Quadratic.In"),T=new game.Tween(y.scale).to({y:.9},450).easing("Back.Out"),S=new game.Tween(y.scale).to({y:.75},450).easing("Back.In");b.chain(_.chain(x.chain(w.chain(b)))).start(),T.chain(S.chain(T)).start();var E=new game.Tween(v.scale).to({x:.9,y:.9},450).easing("Quadratic.Out"),C=new game.Tween(v.scale).to({x:.6,y:.6},450).easing("Quadratic.In");C.chain(E.chain(C)).start();var A=new game.Sprite("shadow_small").addTo(d);A.anchor.set(.5,100/132);var j=new game.Sprite("charater_small_09").addTo(d);j.anchor.set(.5,1),j.scale.set(-.6,.6),j.position.set(96,424),A.position.copy(j.position).add(0,-10);b=new game.Tween(j.position).to({y:400},420).easing("Quadratic.Out"),T=new game.Tween(j.scale).to({y:.8},420).easing("Back.Out"),_=new game.Tween(j.position).to({y:424},420).easing("Quadratic.In"),S=new game.Tween(j.scale).to({y:.6},420).easing("Back.In");var R=new game.Tween(A.scale).to({x:.75,y:.75},420).easing("Quadratic.Out"),M=new game.Tween(A.scale).to({x:.4,y:.4},420).easing("Quadratic.In");M.chain(R.chain(M)).start(),b.chain(_.chain(b)).start(),T.chain(S.chain(T)).start();var O=game.System.height-80,D=new game.Sprite("button_sound",.5*game.System.width-150,O,{anchor:e,interactive:!0,isDown:!1}).addTo(d);D.on("mousedown",t,D),D.on("touchstart",t,D),D.on("mouseup",n,D),D.on("mouseout",n,D),D.on("touchend",n,D);var P=new game.Sprite("button_more_games",.5*game.System.width+150,O,{anchor:e,interactive:!0,isDown:!1});P.on("mousedown",r,P),P.on("touchstart",r,P),P.on("mouseup",o,P),P.on("mouseout",o,P),P.on("touchend",o,P);var F=new game.Sprite("button_play_start",.5*game.System.width,O,{anchor:e,interactive:!0,isDown:!1}).addTo(d);F.on("mousedown",s,F),F.on("touchstart",s,F),F.on("mouseup",a,F),F.on("mouseout",a,F),F.on("touchend",a,F);var G=game.R.fromEvents(this,"toggleSound").throttle(100,{trailing:!1}).scan((function(t){return!t}),!game.audio.musicMuted);G.onValue(l);var L=game.R.fromEvents(this,"moreGames").throttle(100,{trailing:!1});L.onValue(h);var B=game.R.fromEvents(this,"startGame").delay(200).throttle(100,{trailing:!1});B.onValue(u),this.on("exit",(function(){game.G.lastScene="Menu",G.offValue(l),L.offValue(h),B.offValue(u)}))}var e={x:.5,y:.5},i=this.imports["game.cloud"];t.prototype=Object.create(game.Scene.prototype),Object.assign(t.prototype,{constructor:t,resize:function(){this.emit("resize")},exit:function(){this.removeAllListeners()}}),game.s.Menu=t})),game.module("game.cloud").require("plugins.nonsense").body((function(){function t(t,i,n){this.sprite=new game.Sprite("cloud",t,i,{anchor:e}).addTo(n);var r=game.rnd.realInRange(.4,1.2);this.sprite.scale.set(r,r),this.speed=game.rnd.between(6,12),this.paused=!1,game.scene.on("pause",(function(){this.paused=!0,game.scene.removeObject(this)}),this),game.scene.on("resume",(function(){this.paused=!1,game.scene.addObject(this)}),this),game.scene.addObject(this)}var e={x:.5,y:.5};Object.assign(t.prototype,{update:function(){this.sprite.position.x+=game.system.delta*this.speed,this.sprite.position.x>game.system.width+.5*this.sprite.width&&(this.sprite.position.x-=game.system.width+this.sprite.width),game.scene.camera&&this.sprite.position.y<game.scene.camera.position.y-.5*game.system.height-this.sprite.height&&(this.sprite.position.y+=game.system.height+2*this.sprite.height)}}),this.exports=t})),game.module("plugins.nonsense").body((function(){function t(t){void 0===t&&(t=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.sow(t)}Object.assign(t.prototype,{rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},sow:function(t){if(this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},hash:function(t){var e,i,n;for(n=4022871197,t=t.toString(),i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return 2.3283064365386963e-10*(n>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+11102230246251565e-32*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return this.integerInRange(t,e)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1))]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)}}),game.rnd=new t([(Date.now()*Math.random()).toString()])})),game.module("game.shop").require("game.panels","game.data").body((function(){function t(t){return 0>t?n.length-1:t>n.length-1?0:t}function e(t){return 10>t?"0"+t:t.toString()}function i(){function i(){this.isDown||(this.isDown=!0,this.scale.set(.95))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("buy"))}function s(){this.isDown||(this.isDown=!0,H.scale.set(.95),game.audio.playSound("click"))}function h(){this.isDown&&(this.isDown=!1,H.scale.set(1),window.sdkHandler.trigger("interstitialAd",{callback:function(){game.scene.emit("back")}},self))}function v(){this.isDown||(this.isDown=!0,X.scale.set(.95),game.audio.playSound("click"))}function y(){this.isDown&&(this.isDown=!1,X.scale.set(1),game.scene.emit("bonus"))}function b(){this.isDown||(this.isDown=!0,this.scale.set(.6))}function _(){this.isDown&&(this.isDown=!1,this.scale.set(.65),game.scene.emit("toggleSound"),game.audio.playSound("click"))}function x(t){var e=Math.floor(t/1e3),i=Math.floor(e/60);Q.visible=!1,game.incentivise()||($.visible=!1),i=10>i?"0"+i:i.toString();var n=e%60;n=10>n?"0"+n:n.toString(),$.text=i+":"+n,game.G.bonusCountText=$.text,$.position.copy(X).add(.5*-$.width,2-$.height)}function w(){this.isDown||(this.isDown=!0,this.scale.set(.9))}function T(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.audio.playSound("click-s"),game.scene.emit("left"))}function S(){this.isDown||(this.isDown=!0,this.scale.set(.9))}function E(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.audio.playSound("click-s"),game.scene.emit("right"))}function C(i){Math.floor(i/3),k.text=n[i].name,k.position.set(.5*game.System.width-.5*k.width,90),nt.texture="charater_small_"+e(t(i-1)+1),ot.texture="charater_big_"+e(i+1),at.texture="charater_small_"+e(t(i+1)+1),game.G.unlocks[i]?lt.visible=!1:lt.visible=!0,game.G.unlocks[i]?(Z.visible=!1,tt.visible=!1,et.visible=!0):(tt.text=n[i].price.toString(),Z.visible=!0,tt.visible=!0,et.visible=!1),game.G.unlocks[i]?(U.texture=a,V.text=game.content[1]):(U.texture=l,V.text=game.content[0]),V.position.x=.5*-V.width}function A(t){game.G.char=t,game.system.setScene("Playground")}function j(t){game.G.unlocks[t]=1,game.G.coin-=n[t].price,game.G.save(),C(t),game.audio.playSound("reward")}function R(){ut.show()}function M(){EXAPI.isEnabledIncentiviseButton()?ct.isVisible()||ct.show():gt.isVisible()||gt.show()}function O(){game.system.setScene("Bonus")}function D(){ft.show()}function P(t){N.text=t.toString()}function F(t){}game.Scene.call(this);var G=new game.Sprite("bg_select",0,0,{width:game.system.width,height:game.system.height}).addTo(this.stage),L=(new game.Container).addTo(this.stage);L.x=.5*(game.system.width-game.System.width),game.R.fromEvents(this,"resize").onValue((function(){G.width=game.system.width,G.height=game.system.height,L.x=.5*(game.system.width-game.System.width),L.y=.5*(game.system.height-game.System.height)}));var B=new game.Sprite("hud_bg",.5*game.System.width,0).addTo(L);B.anchor.x=.5;var I=new game.Sprite("coin_hud",-156,18,{anchor:r}).addTo(B),N=new game[game.USE_FONT?"Text":"BitmapText"]("000",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(B);N.position.set(-138,-3);var k=new game[game.USE_FONT?"Text":"BitmapText"]("Cyberg",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(L),U=new game.Sprite(l,.5*game.System.width,game.System.height-120,{interactive:!0,isDown:!1}).addTo(L);U.anchor.set(.5);var V=new game[game.USE_FONT?"Text":"BitmapText"](game.content[0],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(U);V.position.set(.5*-V.width,-20),U.on("mousedown",i,U),U.on("touchstart",i,U),U.on("mouseup",o,U),U.on("mouseout",o,U),U.on("touchend",o,U);var H=new game.Sprite("button_back").addTo(L);H.anchor.set(.5),H.position.set(37,U.y+80),H.interactive=!0,H.isDown=!1,H.on("mousedown",s,H),H.on("touchstart",s,H),H.on("mouseup",h,H),H.on("mouseout",h,H),H.on("touchend",h,H);var X=new game.Sprite("button_2_wheel");if(X.anchor.set(.5),X.position.set(game.System.width-2-35,U.y+80),X.interactive=!0,X.isDown=!1,X.on("mousedown",v,X),X.on("touchstart",v,X),X.on("mouseup",y,X),X.on("mouseout",y,X),X.on("touchend",y,X),game.incentivise()){I.texture="coin-plus";var z=I;z.interactive=!0,z.isDown=!1,z.scale.set(.9);var W=function(){this.isDown||(z.scale.set(.85),this.isDown=!0,game.audio.playSound("click"))};z.on("mousedown",W,z),z.on("touchstart",W,z);var Y=function(){this.isDown&&(this.isDown=!1,z.scale.set(.9),game.scene.emit("moreCoins"))};z.on("mouseup",Y,z),z.on("mouseout",Y,z),z.on("touchend",Y,z)}var q=new game.Sprite("button_sound",0,0,{anchor:r,interactive:!0,isDown:!1}).addTo(L);q.scale.set(.65),q.position.set(game.System.width-2-105,U.y+80),q.on("mousedown",b,q),q.on("touchstart",b,q),q.on("mouseup",_,q),q.on("mouseout",_,q),q.on("touchend",_,q);var Q=new game.Sprite("one_free");Q.anchor.set(.5),Q.position.copy(X.position).add(.35*-X.width,.35*-X.height);var $=new game[game.USE_FONT?"Text":"BitmapText"]("00:59",{font:game.USE_FONT?"18px Arial":"18px PixelDigivolve",fill:"white"});$.visible=!1,$.interactive=!0,$.on("mousedown",v,X),$.on("touchstart",v,X),$.on("mouseup",y,X),$.on("mouseout",y,X),$.on("touchend",y,X),game.G.bonusTimer$.onValue(x),$.position.copy(X).add(.5*-$.width,2-$.height),game.G.bonusAvailable||(Q.visible=!1,$.visible=!1);var K=new game.Sprite("button_left",.5*game.System.width-150,U.y-94,{interactive:!0,isDown:!1}).addTo(L);K.anchor.set(.5),K.on("mousedown",w,K),K.on("touchstart",w,K),K.on("mouseup",T,K),K.on("mouseout",T,K),K.on("touchend",T,K);var J=new game.Sprite("button_right",.5*game.System.width+150,U.y-94,{interactive:!0,isDown:!1}).addTo(L);J.anchor.set(.5),J.on("mousedown",S,J),J.on("touchstart",S,J),J.on("mouseup",E,J),J.on("mouseout",E,J),J.on("touchend",E,J);var Z=new game.Sprite("coin_hud",.5*game.System.width-30,U.y-94).addTo(L);Z.anchor.set(.5);var tt=new game[game.USE_FONT?"Text":"BitmapText"]("160",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(L);tt.position.copy(Z.position).add(20,-22);var et=new game[game.USE_FONT?"Text":"BitmapText"](game.content[2],{font:game.USE_FONT?"20px Arial":"20px PixelDigivolve",fill:"white"}).addTo(L);et.position.set(.5*game.System.width-.5*et.width,U.y-94-16);var it=new game.Sprite("shadow_small",.5*game.System.width-130,.5*game.System.height-50).addTo(L);it.anchor.set(.5);var nt=new game.Sprite("charater_small_03").addTo(it);nt.anchor.set(.5);var rt=new game.Sprite("shadow_big",.5*game.System.width,.5*game.System.height-50).addTo(L);rt.anchor.set(.5);var ot=new game.Sprite("charater_big_05").addTo(rt);ot.anchor.set(.5);var st=new game.Sprite("shadow_small",.5*game.System.width+130,.5*game.System.height-50).addTo(L);st.anchor.set(.5);var at=new game.Sprite("charater_small_06").addTo(st);at.anchor.set(.5);var lt=new game.Sprite("lock").addTo(ot);lt.anchor.set(.5),lt.visible=!1;var ht=new g(L),ut=new u(L,ht),ct=new c(L,ht),dt=new d(L,ht,"coin"),pt=new d(L,ht,"heart"),ft=new p(L,ht),mt=new f(L,ht),gt=new m(L,ht),vt=game.R.fromEvents(this,"left"),yt=game.R.fromEvents(this,"right"),bt=game.R.merge([vt.map((function(){return-1})),yt.map((function(){return 1}))]).scan((function(e,i){return t(e+i)}),game.G.char);bt.onValue(C);var _t=game.R.fromEvents(this,"buy"),xt=bt.sampledBy(_t).filter((function(t){return game.G.unlocks[t]})),wt=xt.filter((function(){return game.G.heart>0})),Tt=bt.sampledBy(wt);Tt.onValue(A);var St=bt.sampledBy(_t).filter((function(t){return!game.G.unlocks[t]})),Et=bt.sampledBy(St).filter((function(t){return game.G.coin>=n[t].price}));Et.delay(1).onValue(j);var Ct=game.R.merge([bt.sampledBy(St).filter((function(t){return game.G.coin<n[t].price})).filter((function(){return EXAPI.isEnabledIncentiviseButton()})),game.R.fromEvents(this,"moreCoins")]).filter((function(){return!ut.isVisible()}));Ct.onValue(R);var At=game.R.merge([game.R.fromEvents(this,"moreHearts"),xt.filter((function(){return game.G.heart<=0}))]);At.onValue(M);var jt=game.R.fromEvents(this,"bonus").delay(200).throttle(100,{trailing:!1}),Rt=jt.filter((function(){return game.G.bonusAvailable}));Rt.onValue(O);var Mt=jt.filter((function(){return!game.G.bonusAvailable})).filter(game.incentivise);Mt.onValue(D),jt.filter((function(){return!game.G.bonusAvailable})).filter((function(){return!game.incentivise()})).onValue((function(){mt.show()})),this.on("skipBonusTimer",(function(){game.G.resetBonusTimer(),game.system.setScene("Bonus")})),this.on("openCoinClaimPanel",(function(t){dt.show(t)})),this.on("openHeartClaimPanel",(function(t){pt.show(t)})),game.G.coin$.onValue(P),game.G.heart$.onValue(F),game.R.fromEvents(this,"toggleSound").throttle(100,{trailing:!1}).scan((function(t){return!t}),!game.audio.musicMuted).onValue((function(t){t?(q.texture="button_sound",game.audio.musicMuted=game.audio.soundMuted=!1):(q.texture="button_sound_off",game.audio.musicMuted=game.audio.soundMuted=!0)})),this.once("back",(function(){this.addTimer(200,(function(){game.system.setScene("GameOver")}))}),this),this.once("exit",(function(){game.G.lastScene="Shop",bt.offValue(C),Tt.offValue(A),Et.offValue(j),Ct.offValue(R),At.offValue(M),game.G.coin$.offValue(P),game.G.heart$.offValue(F),Rt.offValue(O),Mt.offValue(D),game.G.bonusTimer$.offValue(x)}),this)}var n=game.G.CHARACTERS,r={x:.5,y:.5},o=new game.Graphics;o.beginFill(3374255),o.drawCircle(0,0,7),o.endFill(),o.generateTexture(game.scale),o.clear(),o.beginFill(16777215),o.drawCircle(0,0,7),o.endFill();var s=(o.generateTexture(game.scale),new game.Graphics);s.lineStyle(2,11333118),s.beginFill(5546532),s.drawRoundedRect(-194,-40,388,80,12),s.endFill();var a=s.generateTexture(game.scale);s.clear(),s.lineStyle(2,11333118),s.beginFill(3636909),s.drawRoundedRect(-194,-40,388,80,12),s.endFill();var l=s.generateTexture(game.scale),h=this.imports["game.panels"],u=h.MoreCoinsPanel,c=h.MoreHeartsPanel,d=h.ClaimPanel,p=h.BonusAdPanel,f=h.BonusNotAvailablePanel,m=h.HeartNotAvailablePanel,g=h.Dimmer;i.prototype=Object.create(game.Scene.prototype),Object.assign(i.prototype,{constructor:i,resize:function(){this.emit("resize")},exit:function(){this.removeAllListeners()}}),game.s.Shop=i})),game.module("game.panels").body((function(){function t(){return!0}function e(){return!1}function i(t){this.g=new game.Sprite(g,0,0).addTo(t),this.g.width=game.system.width,this.g.height=game.system.height,this.g.visible=!1,game.scene.on("resize",this.resize,this),game.scene.once("exit",(function(){game.scene.off("resize",this.resize,this)}),this)}function n(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("hide"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("requestAds"))}function l(t){d.visible=t,n&&(t?n.show():n.hide())}function h(t){t&&(c.hide(),game.scene.emit("openCoinClaimPanel",{type:"coin",number:100})),turnOnSound()}function u(){turnOffSound(),EXAPI.triggerIncentivise(h)}game.EventEmitter.call(this);var c=this,d=new game.Sprite("popup_middle").addTo(i);d.position.set(.5*game.System.width-.5*d.width,.5*game.System.height-.5*d.height);var p=new game.Sprite("button_close").addTo(d);p.anchor.set(.5),p.position.set(d.width-.5*p.width,0),p.interactive=!0,p.isDown=!1,p.on("mousedown",r,p),p.on("touchstart",r,p),p.on("mouseup",o,p),p.on("mouseout",o,p),p.on("touchend",o,p);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[8],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(d);f.position.set(.5*d.width-.5*f.width,32);var m=new game[game.USE_FONT?"Text":"BitmapText"](game.content[10],{font:game.USE_FONT?"16px Arial":"16px PixelDigivolve",fill:"white",align:"center",tint:16776960}).addTo(d);m.position.set(.5*d.width-.5*m.width,f.y+30);var g=new game.Sprite("button_video").addTo(d);g.position.set(.5*d.width-.5*g.width,.5*d.height-.5*g.height);var v=new game.Sprite("button_green").addTo(d);v.anchor.set(.5),v.position.set(.5*d.width,d.height-.5*v.height-26);var y=new game[game.USE_FONT?"Text":"BitmapText"](game.content[11],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(v);y.position.set(.5*-y.width,-20),v.interactive=!0,v.isDown=!1,v.on("mousedown",s,v),v.on("touchstart",s,v),v.on("mouseup",a,v),v.on("mouseout",a,v),v.on("touchend",a,v);var b=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);b.onValue(l);var _=game.R.fromEvents(this,"requestAds");_.onValue(u),game.scene.once("exit",(function(){b.offValue(l),_.offValue(u)}),this),this.isVisible=function(){return d.visible}}function r(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("hide"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("requestAds"))}function l(t){d.visible=t,n&&(t?n.show():n.hide())}function h(t){t&&(c.hide(),game.scene.emit("openHeartClaimPanel",{type:"heart",number:10})),turnOnSound()}function u(){turnOffSound(),EXAPI.triggerIncentivise(h)}game.EventEmitter.call(this);var c=this,d=new game.Sprite("popup_middle").addTo(i);d.position.set(.5*game.System.width-.5*d.width,.5*game.System.height-.5*d.height);var p=new game.Sprite("button_close").addTo(d);p.anchor.set(.5),p.position.set(d.width-.5*p.width,0),p.interactive=!0,p.isDown=!1,p.on("mousedown",r,p),p.on("touchstart",r,p),p.on("mouseup",o,p),p.on("mouseout",o,p),p.on("touchend",o,p);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[9],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(d);f.position.set(.5*d.width-.5*f.width,32);var m=new game[game.USE_FONT?"Text":"BitmapText"](game.content[10],{font:game.USE_FONT?"16px Arial":"16px PixelDigivolve",fill:"white",align:"center",tint:16776960}).addTo(d);m.position.set(.5*d.width-.5*m.width,f.y+30);var g=new game.Sprite("button_video_heart").addTo(d);g.position.set(.5*d.width-.5*g.width,.5*d.height-.5*g.height);var v=new game.Sprite("button_green").addTo(d);v.anchor.set(.5),v.position.set(.5*d.width,d.height-.5*v.height-26);var y=new game[game.USE_FONT?"Text":"BitmapText"](game.content[11],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(v);y.position.set(.5*-y.width,-20),v.interactive=!0,v.isDown=!1,v.on("mousedown",s,v),v.on("touchstart",s,v),v.on("mouseup",a,v),v.on("mouseout",a,v),v.on("touchend",a,v);var b=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);b.onValue(l);var _=game.R.fromEvents(this,"requestAds");_.onValue(u),game.scene.once("exit",(function(){b.offValue(l),_.offValue(u)}),this),this.isVisible=function(){return d.visible}}function o(i,n,r){function o(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function s(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("hide"))}function a(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function l(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("claim"))}function h(t){d.visible=t,c.info&&(g.texture="coin"===c.info.type?"claim_button":"claim_button_heart"),n&&(t?n.show():n.hide())}function u(){c.hide(),game.G[c.info.type]+=c.info.number,game.G.save(),game.audio.playSound("reward")}game.EventEmitter.call(this);var c=this,d=new game.Sprite("popup_middle").addTo(i);d.position.set(.5*game.System.width-.5*d.width,.5*game.System.height-.5*d.height);var p=new game.Sprite("button_close").addTo(d);p.anchor.set(.5),p.position.set(d.width-.5*p.width,0),p.interactive=!0,p.isDown=!1,p.on("mousedown",o,p),p.on("touchstart",o,p),p.on("mouseup",s,p),p.on("mouseout",s,p),p.on("touchend",s,p);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[12],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(d);f.position.set(.5*d.width-.5*f.width,32);var m=new game[game.USE_FONT?"Text":"BitmapText"]("coin"===r?game.content[13]:game.content[23],{font:game.USE_FONT?"16px Arial":"16px PixelDigivolve",fill:"white",align:"center",tint:16776960}).addTo(d);m.position.set(.5*d.width-.5*m.width,f.y+30);var g=new game.Sprite("claim_button").addTo(d);g.position.set(.5*d.width-.5*g.width,.5*d.height-.5*g.height);var v=new game.Sprite("button_green").addTo(d);v.anchor.set(.5),v.position.set(.5*d.width,d.height-.5*v.height-26);var y=new game[game.USE_FONT?"Text":"BitmapText"](game.content[14],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(v);y.position.set(.5*-y.width,-20),v.interactive=!0,v.isDown=!1,v.on("mousedown",a,v),v.on("touchstart",a,v),v.on("mouseup",l,v),v.on("mouseout",l,v),v.on("touchend",l,v);var b=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);b.onValue(h);var _=game.R.fromEvents(this,"claim");_.onValue(u),game.scene.once("exit",(function(){b.offValue(h),_.offValue(u)}),this)}function s(i,n,r){function o(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function s(){this.isDown&&(this.isDown=!1,this.scale.set(1),h.emit("claim"))}function a(t){u.visible=t,h.info,n&&(t?n.show():n.hide())}function l(){h.hide(),game.audio.playSound("reward")}game.EventEmitter.call(this);var h=this,u=new game.Sprite("popup_middle").addTo(i);u.position.set(.5*game.System.width-.5*u.width,.5*game.System.height-.5*u.height);var c=new game[game.USE_FONT?"Text":"BitmapText"](game.content[12],{font:game.USE_FONT?"48px Arial":"48px PixelDigivolve",fill:"white"}).addTo(u);c.position.set(.5*u.width-.5*c.width,64);var d=new game[game.USE_FONT?"Text":"BitmapText"](game.content[24],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white",align:"center",tint:16776960}).addTo(u);d.position.set(.5*u.width-.5*d.width,c.y+96);var p=new game.Sprite("button_green").addTo(u);p.anchor.set(.5),p.position.set(.5*u.width,u.height-.5*p.height-26);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[1],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(p);f.position.set(.5*-f.width,-20),p.interactive=!0,p.isDown=!1,p.on("mousedown",o,p),p.on("touchstart",o,p),p.on("mouseup",s,p),p.on("mouseout",s,p),p.on("touchend",s,p);var m=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);m.onValue(a);var g=game.R.fromEvents(this,"claim");g.onValue(l),game.scene.once("exit",(function(){m.offValue(a),g.offValue(l)}),this)}function a(i,n,r){function o(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function s(){this.isDown&&(this.isDown=!1,this.scale.set(1),h.emit("failedClaim"))}function a(t){u.visible=t,h.info,n&&(t?n.show():n.hide())}function l(){h.hide(),game.scene.emit("gameOver")}game.EventEmitter.call(this);var h=this,u=new game.Sprite("popup_middle").addTo(i);u.position.set(.5*game.System.width-.5*u.width,.5*game.System.height-.5*u.height);var c=new game[game.USE_FONT?"Text":"BitmapText"](game.content[12],{font:game.USE_FONT?"48px Arial":"48px PixelDigivolve",fill:"white"}).addTo(u);c.position.set(.5*u.width-.5*c.width,64);var d=new game[game.USE_FONT?"Text":"BitmapText"](game.content[27],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white",align:"center",tint:16776960}).addTo(u);d.position.set(.5*u.width-.5*d.width,c.y+96);var p=new game.Sprite("button_green").addTo(u);p.anchor.set(.5),p.position.set(.5*u.width,u.height-.5*p.height-26);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[4],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(p);f.position.set(.5*-f.width,-20),p.interactive=!0,p.isDown=!1,p.on("mousedown",o,p),p.on("touchstart",o,p),p.on("mouseup",s,p),p.on("mouseout",s,p),p.on("touchend",s,p);var m=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);m.onValue(a);var g=game.R.fromEvents(this,"failedClaim");g.onValue(l),game.scene.once("exit",(function(){m.offValue(a),g.offValue(l)}),this)}function l(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),window.sdkHandler.trigger("interstitialAd",{callback:function(){y.emit("resume")}},y))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),window.sdkHandler.trigger("interstitialAd",{callback:function(){y.emit("resume")}},y))}function l(){this.isDown||(this.isDown=!0,this.scale.set(.95))}function h(){this.isDown&&(this.isDown=!1,this.scale.set(1),y.emit("toggleSound"))}function u(){this.isDown||(this.isDown=!0,this.width=this.height=86,game.audio.playSound("click"))}function c(){this.isDown&&(this.isDown=!1,this.width=this.height=91,window.sdkHandler.trigger("interstitialAd",{callback:function(){game.system.setScene("GameOver")}},y))}function d(){this.isDown||(this.isDown=!0,this.width=this.height=86,game.audio.playSound("click"))}function p(){this.isDown&&(this.isDown=!1,this.width=this.height=91,game.scene.emit("moreCoins"))}function f(t){b.visible=t,n&&(t?n.show():n.hide())}function m(){y.hide(),game.scene.emit("resume")}function g(t){t?(T.texture="button_sound",game.audio.musicMuted=game.audio.soundMuted=!1):(T.texture="button_sound_off",game.audio.musicMuted=game.audio.soundMuted=!0)}function v(){window.sdkHandler.trigger("moreGames")}game.EventEmitter.call(this);var y=this,b=new game.Sprite("popup_middle").addTo(i);b.position.set(.5*game.System.width-.5*b.width,.5*game.System.height-.5*b.height);var _=new game.Sprite("button_close").addTo(b);_.anchor.set(.5),_.position.set(b.width-.5*_.width,0),_.interactive=!0,_.isDown=!1,_.on("mousedown",r,_),_.on("touchstart",r,_),_.on("mouseup",o,_),_.on("mouseout",o,_),_.on("touchend",o,_);var x=new game[game.USE_FONT?"Text":"BitmapText"](game.content[15],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(b);x.position.set(.5*b.width-.5*x.width,32);var w=new game.Sprite("button_play").addTo(b);w.anchor.set(.5),w.position.set(.5*b.width,.5*b.height),w.interactive=!0,w.isDown=!1,w.on("mousedown",s,w),w.on("touchstart",s,w),w.on("mouseup",a,w),w.on("mouseout",a,w),w.on("touchend",a,w);var T=new game.Sprite("button_sound").addTo(b);T.anchor.set(.5),T.position.set(72,b.height-72),T.interactive=!0,T.isDown=!1,T.on("mousedown",l,T),T.on("touchstart",l,T),T.on("mouseup",h,T),T.on("mouseout",h,T),T.on("touchend",h,T);var S=new game.Sprite("button_back").addTo(b);S.anchor.set(.5),S.width=S.height=91,S.position.set(.5*b.width,b.height-72),S.interactive=!0,S.isDown=!1,S.on("mousedown",u,S),S.on("touchstart",u,S),S.on("mouseup",c,S),S.on("mouseout",c,S),S.on("touchend",c,S);var E=new game.Sprite("button_2_more_coins").addTo(b);E.anchor.set(.5),E.width=E.height=91,E.position.set(b.width-72,b.height-72),E.interactive=!0,E.isDown=!1,E.on("mousedown",d,E),E.on("touchstart",d,E),E.on("mouseup",p,E),E.on("mouseout",p,E),E.on("touchend",p,E);var C=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);C.onValue(f);var A=game.R.fromEvents(this,"resume");A.onValue(m);var j=game.R.fromEvents(this,"toggleSound").throttle(60,{trailing:!1}).scan((function(t){return!t}),!game.audio.musicMuted);j.onValue(g);var R=game.R.fromEvents(this,"moreGames").throttle(60,{trailing:!1});R.onValue(v),game.R.fromEvents(this,"startGame").throttle(60,{trailing:!1}).onValue((function(){game.system.setScene("Shop")})),game.scene.once("exit",(function(){C.offValue(f),A.offValue(m),j.offValue(g),R.offValue(v)}),this)}function h(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("restart"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("restart"))}function l(t){h.visible=t,t&&(d.text=game.content[21]+":     +"+game.G.newCoins,p.text=game.content[5]+":     "+game.G.score,f.text=game.content[6]+":       "+game.G.best),n&&(t?n.show():n.hide())}game.EventEmitter.call(this);var h=new game.Sprite("popup_middle").addTo(i);h.position.set(.5*game.System.width-.5*h.width,.5*game.System.height-.5*h.height);var u=new game.Sprite("button_close").addTo(h);u.anchor.set(.5),u.position.set(h.width-.5*u.width,0),u.interactive=!0,u.isDown=!1,u.on("mousedown",r,u),u.on("touchstart",r,u),u.on("mouseup",o,u),u.on("mouseout",o,u),u.on("touchend",o,u);var c=new game[game.USE_FONT?"Text":"BitmapText"](game.content[4],{font:game.USE_FONT?"36px Arial":"36px PixelDigivolve",fill:"white"}).addTo(h);c.position.set(.5*h.width-.5*c.width,40);var d=new game[game.USE_FONT?"Text":"BitmapText"](game.content[21]+":     +15",{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(h);d.position.set(.5*h.width-86,c.y+80);var p=new game[game.USE_FONT?"Text":"BitmapText"](game.content[5]+":    123",{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(h);p.position.set(.5*h.width-86,d.y+30);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[6]+":      357",{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white"}).addTo(h);f.position.set(.5*h.width-86,p.y+30);var m=new game.Sprite("button_green").addTo(h);m.anchor.set(.5),m.position.set(.5*h.width,h.height-.5*m.height-26);var g=new game[game.USE_FONT?"Text":"BitmapText"](game.content[16],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(m);g.position.set(.5*-g.width,-20),m.interactive=!0,m.isDown=!1,m.on("mousedown",s,m),m.on("touchstart",s,m),m.on("mouseup",a,m),m.on("mouseout",a,m),m.on("touchend",a,m);var v=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);v.onValue(l),game.scene.once("exit",(function(){v.offValue(l)}),this),this.isVisible=function(){return h.visible}}function u(i){function n(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function r(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("gameOver"))}function o(){this.isDown||(this.isDown=!0,game.audio.playSound("click"))}function s(){this.isDown&&(this.isDown=!1,game.scene.emit("continue"),l.ended=!0)}function a(t){if(h.visible=t,t){game.G.coin<100?(g.visible=!1,m.text=game.content[22],m.scale.set(.75),m.position.copy(d.position).add(.5*-m.width,.5*-m.height)):(g.visible=!0,m.text=game.content[18],m.scale.set(1),m.position.copy(d.position).add(.5*-m.width-14,.5*-m.height));var e=game.R.fromUpdate().map((function(){return 1e3*game.system.delta})).scan((function(t,e){return Math.max(0,t-e)}),f).map((function(t){return t/f})).takeWhile((function(t){return t>0}));e.onValue((function(t){l.ended||(p.scale.x=t)})),e.onEnd((function(){l.ended||game.scene.emit("gameOver")}))}}game.EventEmitter.call(this);var l=this;l.ended=!1;var h=new game.Sprite("popup_small").addTo(i);h.position.set(.5*game.System.width-.5*h.width,.5*game.System.height-.5*h.height);var u=new game.Sprite("button_close").addTo(h);u.anchor.set(.5),u.position.set(.5*u.width,0),u.interactive=!0,u.isDown=!1,u.on("mousedown",n,u),u.on("touchstart",n,u),u.on("mouseup",r,u),u.on("mouseout",r,u),u.on("touchend",r,u);var c=new game[game.USE_FONT?"Text":"BitmapText"](game.content[17],{font:game.USE_FONT?"30px Arial":"30px PixelDigivolve",fill:"white"}).addTo(h);c.position.set(.5*h.width-.5*c.width,10);var d=(new game.Graphics).addTo(h);d.lineStyle(2,11333118),d.beginFill(5855577,0),d.drawRect(-175,-35,350,70),d.endFill(),d.position.set(.5*h.width,h.height-.5*d.height-20);var p=(new game.Graphics).addTo(h);p.beginFill(5546532),p.drawRect(0,0,350,70),p.endFill(),p.position.set(.5*h.width-.5*p.width,h.height-p.height-22);var m=new game[game.USE_FONT?"Text":"BitmapText"](game.content[18],{font:game.USE_FONT?"16px Arial":"24px PixelDigivolve",fill:"white",align:"center"}).addTo(h);m.position.copy(d.position).add(.5*-m.width-14,.5*-m.height);var g=new game.Sprite("coin_hud").addTo(h);g.position.copy(m.position).add(m.width+4,4);var v=(new game.Graphics).addTo(h);v.lineStyle(2,11333118),v.beginFill(5855577,0),v.drawRect(-175,-35,350,70),v.endFill(),v.position.set(.5*h.width,h.height-.5*v.height-20),v.interactive=!0,v.isDown=!1,v.on("mousedown",o,v),v.on("touchstart",o,v),v.on("mouseup",s,v),v.on("mouseout",s,v),v.on("touchend",s,v);var y=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);y.onValue(a),game.scene.once("exit",(function(){y.offValue(a)}),this),this.isVisible=function(){return h.visible}}function c(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("hide"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),c.emit("requestAds"))}function l(t){d.visible=t,n&&(t?n.show():n.hide())}function h(t){t&&(c.hide(),game.scene.emit("skipBonusTimer")),turnOnSound()}function u(){turnOffSound(),EXAPI.triggerIncentivise(h)}game.EventEmitter.call(this);var c=this,d=new game.Sprite("popup_middle").addTo(i);d.position.set(.5*game.System.width-.5*d.width,.5*game.System.height-.5*d.height);var p=new game.Sprite("button_close").addTo(d);p.anchor.set(.5),p.position.set(d.width-.5*p.width,0),p.interactive=!0,p.isDown=!1,p.on("mousedown",r,p),p.on("touchstart",r,p),p.on("mouseup",o,p),p.on("mouseout",o,p),p.on("touchend",o,p);var f=new game[game.USE_FONT?"Text":"BitmapText"](game.content[19],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white",align:"center"}).addTo(d);f.position.set(.5*d.width-.5*f.width,32),this.update=function(){f.text=game.content[19].replace(/1/i,game.G.bonusCountText)};var m=new game.Sprite("video").addTo(d);m.position.set(.5*d.width-.5*m.width,.5*d.height-.5*m.height+20);var g=new game.Sprite("button_green").addTo(d);g.anchor.set(.5),g.position.set(.5*d.width,d.height-.5*g.height-26);var v=new game[game.USE_FONT?"Text":"BitmapText"](game.content[11],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(g);v.position.set(.5*-v.width,-20),g.interactive=!0,g.isDown=!1,g.on("mousedown",s,g),g.on("touchstart",s,g),g.on("mouseup",a,g),g.on("mouseout",a,g),g.on("touchend",a,g);var y=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);y.onValue(l);var b=game.R.fromEvents(this,"requestAds");b.onValue(u),game.scene.once("exit",(function(){y.offValue(l),b.offValue(u)}),this),this.isVisible=function(){return d.visible}}function d(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),a.emit("hide"))}function s(t){l.visible=t,n&&(t?n.show():n.hide())}game.EventEmitter.call(this);var a=this,l=new game.Sprite("popup_small").addTo(i);l.position.set(.5*game.System.width-.5*l.width,.5*game.System.height-.5*l.height);var h=new game.Sprite("button_close").addTo(l);h.anchor.set(.5),h.position.set(l.width-.5*h.width,0),h.interactive=!0,h.isDown=!1,h.on("mousedown",r,h),h.on("touchstart",r,h),h.on("mouseup",o,h),h.on("mouseout",o,h),h.on("touchend",o,h);var u=new game[game.USE_FONT?"Text":"BitmapText"](game.content[26],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white",align:"center"}).addTo(l);u.position.set(.5*l.width-.5*u.width,32),this.update=function(){u.text=game.content[26].replace(/1/i,game.G.bonusCountText)};var c=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);c.onValue(s),game.scene.once("exit",(function(){c.offValue(s)}),this),this.isVisible=function(){return l.visible}}function p(i,n){function r(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click-s"))}function o(){this.isDown&&(this.isDown=!1,this.scale.set(1),a.emit("hide"))}function s(t){l.visible=t,n&&(t?n.show():n.hide())}game.EventEmitter.call(this);var a=this,l=new game.Sprite("popup_small").addTo(i);l.position.set(.5*game.System.width-.5*l.width,.5*game.System.height-.5*l.height);var h=new game.Sprite("button_close").addTo(l);h.anchor.set(.5),h.position.set(l.width-.5*h.width,0),h.interactive=!0,h.isDown=!1,h.on("mousedown",r,h),h.on("touchstart",r,h),h.on("mouseup",o,h),h.on("mouseout",o,h),h.on("touchend",o,h);var u=new game[game.USE_FONT?"Text":"BitmapText"](game.content[26],{font:game.USE_FONT?"24px Arial":"24px PixelDigivolve",fill:"white",align:"center"}).addTo(l);u.position.set(.5*l.width-.5*u.width,32),this.update=function(){var t=game.G.heartCount;t=10>t?"0"+t:t,u.text=game.content[26].replace(/1/i,t.toString())};var c=game.R.merge([game.R.fromEvents(this,"show").map(t),game.R.fromEvents(this,"hide").map(e)]).skipDuplicates().scan((function(t,e){return t!==e?e:t}),!1);c.onValue(s),game.scene.once("exit",(function(){c.offValue(s)}),this),this.isVisible=function(){return l.visible}}var f=5e3,m=new game.Graphics;m.beginFill(0,.5),m.drawRect(0,0,2,2),m.endFill();var g=m.generateTexture(game.scale);Object.assign(i.prototype,{show:function(){return this.resize(),this.g.visible=!0,this},hide:function(){return this.g.visible=!1,this},resize:function(){return this.g.position.copy(this.g.parent.toGlobal(game.scene.stage.position).scale(-1)),this.g.width=game.system.width,this.g.height=game.system.height,this}}),n.prototype=Object.create(game.EventEmitter.prototype),Object.assign(n.prototype,{constructor:n,show:function(){this.emit("show")},hide:function(){this.emit("hide")}}),r.prototype=Object.create(game.EventEmitter.prototype),Object.assign(r.prototype,{constructor:n,show:function(){this.emit("show")},hide:function(){this.emit("hide")}}),o.prototype=Object.create(game.EventEmitter.prototype),Object.assign(o.prototype,{constructor:o,show:function(t){return this.info=t,this.emit("show"),this},hide:function(){return this.emit("hide"),this}}),s.prototype=Object.create(game.EventEmitter.prototype),Object.assign(s.prototype,{constructor:s,show:function(){return this.emit("show"),this},hide:function(){return this.emit("hide"),this}}),a.prototype=Object.create(game.EventEmitter.prototype),Object.assign(a.prototype,{constructor:a,show:function(){return this.emit("show"),this},hide:function(){return this.emit("hide"),this}}),l.prototype=Object.create(game.EventEmitter.prototype),Object.assign(l.prototype,{constructor:l,show:function(t){window.panelOpened||(window.panelOpened=!0,this.info=t,this.emit("show"))},hide:function(){window.panelOpened=!1,this.emit("hide")}}),h.prototype=Object.create(game.EventEmitter.prototype),Object.assign(h.prototype,{constructor:h,show:function(){window.panelOpened=!0,this.emit("show")},hide:function(){window.panelOpened=!1,this.emit("hide")}}),u.prototype=Object.create(game.EventEmitter.prototype),Object.assign(u.prototype,{constructor:u,show:function(){window.panelOpened=!0,this.ended=!1,this.emit("show")},hide:function(){window.panelOpened=!1,this.ended=!0,this.emit("hide")}}),c.prototype=Object.create(game.EventEmitter.prototype),Object.assign(c.prototype,{constructor:c,show:function(){window.panelOpened=!0,this.emit("show"),game.scene.addObject(this)},hide:function(){window.panelOpened=!1,this.emit("hide"),game.scene.removeObject(this)}}),d.prototype=Object.create(game.EventEmitter.prototype),Object.assign(d.prototype,{constructor:d,show:function(){window.panelOpened=!0,this.emit("show"),game.scene.addObject(this)},hide:function(){window.panelOpened=!1,this.emit("hide"),game.scene.removeObject(this)}}),p.prototype=Object.create(game.EventEmitter.prototype),Object.assign(p.prototype,{constructor:p,show:function(){window.panelOpened=!0,this.emit("show"),game.scene.addObject(this)},hide:function(){window.panelOpened=!1,this.emit("hide"),game.scene.removeObject(this)}}),this.exports={Dimmer:i,ContinuePanel:u,MoreCoinsPanel:n,MoreHeartsPanel:r,ClaimPanel:o,WatchClaimPanel:s,FailClaimPanel:a,PausePanel:l,GameOverPanel:h,BonusAdPanel:c,BonusNotAvailablePanel:d,HeartNotAvailablePanel:p}})),game.module("game.playground").require("plugins.nonsense","plugins.reactive","game.cloud","game.panels","game.data").body((function(){function t(){return!0}function e(){return!1}function i(t,e,i,n,r,o){game.EventEmitter.call(this),this.q=e,this.r=i,this.type=t.type,this.block=t.block||n&&n.block,n&&n.fallDuration||t.fallDuration?this.fallDuration=t.fallDuration:this.fallDuration=800;var a=t.action||!1,l=!1,h=!1,u=!1;this.param=o;var c=s(e,i),d=new game.Sprite(t.texture,c.x,c.y,{anchor:j}).addTo(r);if(this.sprite=d,t.hasDeco)if("Lava"===t.type){var p=new game.Animation(t.decoTex);p.anchor.set(.5),p.addAnim("a",[0,1,2],{speed:10}),p.play("a"),d.addChild(p)}else d.addChild(new game.Sprite(t.decoTex,0,0,{anchor:j}));if("Water"===this.type){var f=new game.Animation(["water_ani_01","water_ani_02","water_ani_03"]).addTo(d);f.anchor.set(.5),f.scale.x=-1,f.addAnim("a",[0,1,2],{speed:10}),f.play("a"),0>o&&(d.texture="water_b",f.scale.x=1)}if("Bomb"===this.type&&d.anchor.set(.5,.854),"Road"===this.type&&(d.texture="road_"+this.param),n){if(u=n.action,l=n.loopAction,"Stab"===n.type)(h=new game.Animation(n.texture).addTo(d)).anchor.set(n.anchor.x,n.anchor.y),h.addAnim("a",[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],{speed:16}),h.play("a");else if("Coin"===n.type){var m=game.rnd.frac(),g=null;E>m?g=w.Box:C>m?g=w.Heart:.4>m&&(g=n),g?(u=g.action,l=g.loopAction,"Coin"===g.type?((h=new game.Animation(g.texture).addTo(d)).anchor.set(g.anchor.x,g.anchor.y),h.addAnim("a",[0,1,2,3,2,1],{speed:10}),h.play("a")):h=new game.Sprite(g.texture,0,0,{anchor:g.anchor}).addTo(d)):(u=null,l=null)}else if("Car"===n.type){(h=new game.Sprite(n.texture,0,0,{anchor:n.anchor}).addTo(game.scene.beforeTileLayer)).position.copy(s(e,i));var v=0,y=1,b=function(t,e,i){var n=new game.Tween(t.position).to({x:e},320).delay(320).easing("Quadratic.In"),r=new game.Tween(t.position).to({y:i},320).delay(320).easing(y>0?"Back.In":"Back.Out"),o=new game.TweenGroup(T);o.add(n),o.add(r),o.start(),h.texture=y>0?"car_01_b":"car_01_c"},x=0,T=function(){if((v+=y)>3?(y=-1,v=2):0>v&&(y=1,v=1),0===v){var t=s(e,i);b(h,t.x,t.y)}else if(1===v){t=s(e+1,i+1);b(h,t.x,t.y),game.scene.emit("carStop",{q:e+1,r:i+1})}else if(2===v){t=s(e+1,i+2);b(h,t.x,t.y),game.scene.emit("carStop",{q:e+1,r:i+2})}else if(3===v){t=s(e+2,i+3);b(h,t.x,t.y),game.scene.emit("carStop",{q:e+2,r:i+3})}2>x&&(x+=1,game.scene.addTimer(1e3,(function(){game.audio.playSound("car-horn")})),game.scene.addTimer(2e3,(function(){game.audio.playSound("car-horn")})))};m=s(e+1,i+1);b(h,m.x,m.y)}else h=new game.Sprite(n.texture,0,0,{anchor:n.anchor}).addTo(d);if("Honey"===n.type)(S=new game.Animation(["honey_stop_01","honey_stop_02","honey_stop_03"]).addTo(d)).anchor.set(.5,.5),S.addAnim("snap",[0,1,2,1,0],{speed:16,loop:!1,onComplete:function(){S.visible=!1}}),S.visible=!1,this.snapObj=S;else if("Poison"===n.type){var S;(S=new game.Animation(["oli_stop_01","oli_stop_02","oli_stop_03"]).addTo(d)).anchor.set(.5,.5),S.addAnim("snap",[0,1,2,1,0],{speed:16,loop:!1,onComplete:function(){S.visible=!1}}),S.visible=!1,this.snapObj=S}}this.fall=new game.Tween(d).to({y:d.position.y+3*_,alpha:0},this.fallDuration).onComplete((function(){d.remove(),h&&h.remove()})).easing("Quadratic.In");var A=0;this.once("landed",(function(t){A=t.y-d.y,this.fall.onUpdate((function(e){t.y=d.y+A,e>.2&&t.canJump&&(t.canJump=!1,t.emit("doomed"))})),a&&a(this,h,t),l&&(this.loopTimer=game.scene.addTimer(10,(function(){l(this,h,t)}),!0)),u&&u(this,h,t),"Water"!==this.type&&(t.onWater=!1),new game.Tween(d.position).to({y:d.position.y+8},80).repeat(1).yoyo(!0).start(),t.landAnim=new game.Tween(t.position).to({y:t.position.y+8},80).repeat(1).yoyo(!0).start(),game.scene.emit("landedOnTile",this)}),this),this.once("leftTile",(function(){this.fall.onUpdate(null),this.loopTimer&&game.scene.removeTimer(this.loopTimer)}),this)}function n(){function i(t){if(!z.killed){z.canJump=!1,N.jumpSnapped=!1,z.landAnim&&z.landAnim.stop();var e=new game.Tween(z.position).to({x:t.x},320).easing("Quadratic.In"),i=new game.Tween(z.position).to({y:t.y},320).easing("Back.In"),n=new game.TweenGroup(w);n.add(e),n.add(i),n.start(),t.x>z.position.x?z.scale.x=-1:z.scale.x=1;var r=new game.Tween(z.scale).to({y:1.2},150).easing("Quadratic.In"),o=new game.Tween(z.scale).to({y:1},150).easing("Quadratic.Out");r.chain(o).start(),H.position.copy(t).add(0,-16),H.scale.set(.1),new game.Tween(H.scale).to({x:1,y:1},300).easing("Quadratic.In").start(),game.audio.playSound("jump")}}function n(){N.jumpSnap+=1,new game.Tween(z.position).to({y:z.position.y-m},g).repeat(1).yoyo(!0).start(),rt&&rt.snap()}function a(){z.onWater&&(z.triedToJump=!0)}function b(){z.invincible||z.kill()}function _(){z.invincible||(game.audio.playSound("hit-car"),z.killByStab())}function x(){z.drop()}function w(){z.canJump=!0,z.emit("landOnTile")}function E(t){ut.text=t.toString(),ut.position.set(.5*game.System.width-.5*ut.width,48),game.G.score=t,game.G.score>game.G.best&&(game.G.best=t,game.G.newHighScore||!game.G.hasRecord||N.bestScoreLogged||(N.bestScoreLogged=!0,game.G.newHighScore=!0,N.emit("newHighScore",t),game.audio.playSound("reward")))}function C(t){game.R.sequentially(100,[0,0,0,0,0]).onValue((function(){var t=new game.Sprite("coin_hud").addTo(game.scene.uiLayer);t.anchor.set(.5),t.position.copy(rt.sprite.toGlobal(rt.sprite.parent.position)).subtract(v,y),new game.Tween(t.position).to({x:.5*game.System.width-156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){t.remove(),game.G.coin+=1,game.G.newCoins+=1})).start()})),gt.show()}function O(){this.isDown||(this.isDown=!0,_t.scale.set(.9))}function D(){this.isDown&&(this.isDown=!1,_t.scale.set(1),game.scene.emit("pause"))}function P(t){bt.text=t.toString()}function F(t){}function G(t){t?(wt.show(),N._updateOrder=["Renderer"]):(wt.hide(),N._updateOrder=["Tweens","Physics","Timers","Emitters","Objects","Renderer"])}function L(){window.panelOpened||dt||(wt.show(),N._updateOrder=["Renderer"])}function B(){Tt.show()}function I(){game.audio.soundVolume=0,game.G.heart-1<0?game.G.heart=0:game.G.heart-=0,game.system.setScene("GameOver"),EXAPI.gameOver(1,game.G.score,(function(){game.audio.soundVolume=1}))}game.Scene.call(this);var N=this,k=game.G.isContinue?{q:1,r:9}:{q:2,r:0};game.G.isContinue||(game.G.newHighScore=!1,game.G.newCoins=0);var U=new game.Sprite(game.rnd.pick(M),0,0,{width:game.system.width,height:game.system.height}).addTo(this.stage);new R(10,100,this.stage),new R(320,300,this.stage),new R(120,400,this.stage),new R(400,500,this.stage);var V=this.container=(new game.Container).addTo(this.stage);V.x=.5*(game.system.width-game.System.width),game.R.fromEvents(this,"resize").onValue((function(){U.width=game.system.width,U.height=game.system.height,V.x=.5*(game.system.width-game.System.width),V.y=.5*(game.system.height-game.System.height)})),this.actLayer=(new game.Container).addTo(V),this.tileLayer=(new game.Container).addTo(this.actLayer),this.beforeTileLayer=(new game.Container).addTo(this.actLayer),this.uiLayer=(new game.Container).addTo(V);var H=new game.Sprite("shadow_small").addTo(this.beforeTileLayer);H.anchor.set(.5,100/132);var X=game.G.char+1;10>X&&(X="0"+X);var z=new game.Sprite("charater_small_"+X).addTo(this.beforeTileLayer);z.anchor.set(.5,1),z.canJump=!0,z.kill=function(){z.killed||(z.killed=!0,nt.emit("leftTile"),z.remove(),z.emit("doomed"))},z.killByStab=function(){z.killed||(z.killed=!0,nt.emit("leftTile"),z.emit("doomed","stab"))},z.drop=function(){if(!z.killed){if(z.killed=!0,rt){var t=N.tileLayer.getChildIndex(rt.sprite);N.tileLayer.addChildAt(z,t+1)}H.remove(),nt.emit("leftTile"),z.emit("doomed")}},z.dir=1,this.jumpSnapped=!1,this.jumpSnap=0,z.onWater=!1;var W=game.R.fromEvents(this,"left").map((function(){return-1*z.dir})),Y=game.R.fromEvents(this,"right").map((function(){return 1*z.dir})),q=game.R.merge([W,Y]),Q=q.filter((function(){return z.canJump})).filter((function(){return!(N.jumpSnapped&&N.jumpSnap<A)})).scan((function(t,e){var i=!(t.r%2),n=!1;i&&(0===t.q&&0>e||4===t.q&&e>0)&&(n=!0);var o={q:t.q+(i&&0>e||!i&&e>0?e:0),r:t.r+1};n||r(o).block&&(o=t);return o}),k),$=Q.skipDuplicates((function(t,e){return t.q===e.q&&t.r===e.r})).map((function(t){return s(t.q,t.r)}));$.onValue(i),this.isMoving=!1,$.skip(1).take(1).onValue((function(){N.isMoving=!0}));var K=q.filter((function(){return z.canJump})).filter((function(){return N.jumpSnapped}));K.onValue(n),z.triedToJump=!1,q.onValue(a),this.camera=(new game.Camera).addTo(this.actLayer),this.camera.sensor={x:.5*-game.System.width,y:0,width:game.system.width,height:120,anchor:new game.Vector(.5,.75)},this.camera.anchor.set(.5,.36),this.camera.setTarget(z),this.camera.setPosition(0,50),z.on("doomed",(function(t){z.canJump=!1,this.camera.target=null,H.visible=!1,"stab"===t?(new game.Tween(z.position).to({y:z.position.y+game.system.height},game.system.height/.6).easing("Back.In").onComplete((function(){z.visible=!1,game.scene.isMoving=!1,game.scene.emit("failed")})).start(),new game.Tween(z).to({rotation:4*Math.PI},game.system.height/1).easing("Quadratic.Out").start()):new game.Tween(z.position).to({y:z.position.y+game.system.height},game.system.height/.8).easing("Quadratic.In").onComplete((function(){z.visible=!1,game.scene.isMoving=!1,game.scene.emit("failed")})).start(),z.anchor.set(.5)}),this);var J=game.R.fromEvents(this,"explode").map((function(t){var e=[t];return t.r%2?(e.push({r:t.r+1,q:t.q}),e.push({r:t.r+1,q:t.q+1}),t.q>0&&e.push({r:t.r,q:t.q-1}),t.q<3&&e.push({r:t.r,q:t.q+1})):(t.q>0&&(e.push({r:t.r,q:t.q-1}),e.push({r:t.r+1,q:t.q-1})),t.q<3&&(e.push({r:t.r,q:t.q+1}),e.push({r:t.r+1,q:t.q}))),e})),Z=game.R.combine([J,Q],(function(t,e){var i=!1;return t.forEach((function(t){t.r===e.r&&t.q===e.q&&(i=!0)})),i})).filter();Z.onValue(b);var tt=game.R.fromEvents(this,"carStop"),et=game.R.combine([tt,Q],(function(t,e){return t.q===e.q&&t.r===e.r||void 0})).filter();et.onValue(_);var it=game.R.fromEvents(this,"poisonKill");it.onValue(x),this.lastRow=-1,this.currPatternIdx=0,this.currPatternLength=0,this.nextPatternRowIdx=0,this.tiles=this.firstTilePattern().map(o);var nt=null,rt=null,ot=game.R.fromEvents(z,"landOnTile");Q.map(r).scan((function(t,e){return nt=t,rt=e,e}),r({q:2,r:0})).sampledBy(ot).onValue((function(t){t?(t.emit("landed",z),z.triedToJump=!1):z.drop()})),$.delay(1).map((function(){return nt})).skip(1).onValue((function(t){z.dir=1,t.emit("leftTile")}));var st=(new game.Container).addTo(this.beforeTileLayer);st.visible=!1;for(var at,lt=0;4>lt;lt++)(at=new game.Sprite("lava_pixel")).anchor.set(.5),at.rotation=game.rnd.realInRange(0,Math.PI),2>lt?at.on("play",(function(){var t=this;this.position.set(game.rnd.between(-15,-2),0),this.visible=!0,new game.Tween(this.position).to({x:game.rnd.between(-8,0)+this.position.x,y:game.rnd.between(-20,-16)+this.position.y},280).onComplete((function(){t.visible=!1})).start()}),at):at.on("play",(function(){var t=this;this.position.set(game.rnd.between(2,15),0),this.visible=!0,new game.Tween(this.position).to({x:game.rnd.between(0,8)+this.position.x,y:game.rnd.between(-20,-16)+this.position.y},280).onComplete((function(){t.visible=!1})).start()}),at),st.addChild(at);if(this.on("landedOnTile",(function(t){if(-1!==S.indexOf(t.type)){var e;st.position.copy(t.sprite.position).add(0,-15);for(var i=0;i<st.children.length;i++)(e=st.children[i]).texture=T[t.type],e.emit("play");st.visible=!0}})),N.bestScoreLogged=!1,game.G.isContinue)var ht=ot.skip(2).scan((function(t){return t+1}),game.G.currScore);else ht=ot.skip(1).scan((function(t){return t+1}),0);var ut=new game[game.USE_FONT?"Text":"BitmapText"]("0",{font:game.USE_FONT?"64px Arial":"64px PixelDigivolve",fill:"white"}).addTo(this.uiLayer);ht.onValue(E);var ct=game.R.fromEvents(this,"newHighScore");if(ct.onValue(C),!game.G.tutWatched){game.G.tutWatched=!0;var dt=(new game.Graphics).addTo(this.stage),pt=new game.Sprite(game.device.mobile?"finger":"key_left").addTo(dt);pt.anchor.set(.5),game.device.mobile||pt.scale.set(.75);var ft=function(){dt.clear(),dt.beginFill(3355443,.75),dt.drawRect(0,0,.5*game.system.width,game.system.height),dt.endFill(),game.device.mobile?pt.position.set(.5*pt.width,.5*game.system.height):pt.position.set(.5*dt.width,.5*game.system.height)};ft(),game.scene.on("resize",ft);var mt=!0;W.filter((function(){return mt})).take(1).onValue((function(){mt=!1,dt.position.x=.5*game.system.width,game.device.mobile?(pt.scale.x=-1,pt.position.x=dt.width-.5*pt.width):pt.texture="key_right"})),Y.filter((function(){return!mt})).take(1).onValue((function(){dt.remove(),N.off("resize",ft),dt=null})),this.on("resize",ft)}var gt=new game.Sprite("popup_small",200,-160).addTo(this.uiLayer);gt.anchor.set(.5,.5);var vt=new game[game.USE_FONT?"Text":"BitmapText"](game.content[3],{font:game.USE_FONT?"30px Arial":"30px PixelDigivolve",fill:"white",align:"center"}).addTo(gt);game.USE_FONT?(vt.position.set(0,vt.height),vt.anchor.set(.5)):vt.position.set(.5*-vt.width,-4),gt.show=function(){gt.position.y=-160,gt.alpha=1,gt.visible=!0;var t=new game.Tween(gt).to({y:36},400).easing("Quadratic.In"),e=new game.Tween(gt).to({y:-160,alpha:0},800).easing("Cubic.In").delay(2e3).onComplete((function(){gt.visible=!1}));t.chain(e).start()},gt.visible=!1;var yt=new game.Sprite("hud_bg",.5*game.System.width,0).addTo(this.uiLayer);yt.anchor.x=.5;var bt=(new game.Sprite("coin_hud",-156,18,{anchor:j}).addTo(yt),new game[game.USE_FONT?"Text":"BitmapText"]("000",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(yt));bt.position.set(-138,-3);var _t=new game.Sprite("button_pause_hud").addTo(yt);_t.anchor.set(.5),_t.position.set(0,.5*_t.height+6),_t.interactive=!0,_t.on("mousedown",O,_t),_t.on("touchstart",O,_t),_t.on("mouseup",D,_t),_t.on("mouseout",D,_t),_t.on("touchend",D,_t),game.G.coin$.onValue(P),game.G.heart$.onValue(F);var xt=new l(this.uiLayer),wt=new h(this.uiLayer,xt),Tt=new u(this.uiLayer,xt),St=new c(this.uiLayer,xt),Et=new d(this.uiLayer,xt,"coin"),Ct=new p(this.uiLayer,xt),At=new f(this.uiLayer,xt),jt=game.R.merge([game.R.fromEvents(this,"pause").map(t),game.R.fromEvents(this,"resume").map(e)]).scan((function(t,e){return t!==e?e:t}),!1);jt.onValue(G),game.R.fromEvents(this,"moreCoins").filter((function(){return EXAPI.isEnabledIncentiviseButton()})).filter((function(){return!St.isVisible()})).onValue((function(){St.show()})),this.on("openCoinClaimPanel",(function(t){Et.show(t)}));var Rt=game.R.fromEvents(this,"failed"),Mt=Rt.filter(game.incentivise).filter((function(){return!Tt.isVisible()}));Mt.onValue(B);var Ot=game.R.merge([game.R.fromEvents(this,"gameOver"),Rt.filter((function(){return!game.incentivise()}))]);if(Ot.onValue(I),game.G.isContinue||EXAPI.gameStart(1),r(k).emit("landed",z),i(s(k.q,k.r)),game.G.isContinue){game.G.isContinue=!1;for(lt=0;6>lt;lt++)this.tiles.push(o(this.getNextRow(),this.lastRow+1))}this.once("continue",(function(){game.G.coin>=100?(game.G.coin-=100,game.G.isContinue=!0,game.G.currScore=game.G.score,game.system.setScene("Playground")):EXAPI.isEnabledIncentiviseButton()&&(turnOffSound(),EXAPI.triggerIncentivise((function(t){1==t?(game.G.isContinue=!0,game.G.currScore=game.G.score,Ct.show().once("claim",(function(){game.system.setScene("Playground")}))):At.show().once("failedClaim",(function(){turnOnSound(),game.system.setScene("GameOver")})),turnOnSound()})))}),this),this.once("exit",(function(){window.removeEventListener("blur",L,!0),game.G.lastScene="Playground",$.offValue(i),ht.offValue(E),ct.offValue(C),K.offValue(n),q.offValue(a),game.G.coin$.offValue(P),game.G.heart$.offValue(F),jt.offValue(G),Mt.offValue(B),Ot.offValue(I),Z.offValue(b),et.offValue(_),it.offValue(x),game.G.hasRecord=!0,game.G.save()}),this);var Dt=!0,Pt=function(){Dt?Dt=!1:game.audio.playSound(game.rnd.frac()>.5?"bg-pigeon":"bg-bird"),game.scene.addTimer(game.rnd.between(2e3,6e3),Pt)};Pt(),window.addEventListener("blur",L,!0)}function r(t){var e=t.q,i=t.r-(game.scene.lastRow+1-game.scene.tiles.length);return game.scene.tiles[i][e]}function o(t,e){var n=t.map((function(t,n){return new i(x[t.tile],n,e,w[t.obj],game.scene.tileLayer,t.param)}));return n.yLimit=s(2,e).y,game.scene.lastRow+=1,n}function s(t,e){return{x:e%2?(t-1.5)*_:(t-2)*_,y:e*_*.79}}var a=this.imports["game.panels"],l=a.Dimmer,h=a.PausePanel,u=a.ContinuePanel,c=a.MoreCoinsPanel,d=a.ClaimPanel,p=a.WatchClaimPanel,f=a.FailClaimPanel,m=(a.GameOverPanel,36),g=80,v=0,y=0,b=[[[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Lava",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Lava",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Lava",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Stab"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Stab"}],[{tile:"Lava",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Stab"}],[{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"}]],[[{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null}]],[[{tile:"Lava",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Stab"},{tile:"Lava",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Stab"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Stab"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Bomb",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Dir"},{tile:"Lava",obj:null},{tile:"Sand",obj:"Crash"}],[{tile:"Grass",obj:"Tree"},{tile:"Lava",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Poison"},{tile:"Sand",obj:null}],[{tile:"Sand",obj:"Crash"},{tile:"Grass",obj:"Stab"},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Dir"},{tile:"Grass",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Dir"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Honey"},{tile:"Lava",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Bomb",obj:null},{tile:"Lava",obj:null}],[{tile:"Bomb",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Sand",obj:"Stab"},{tile:"Sand",obj:"Crash"},{tile:"Grass",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}]],[[{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Sand",obj:null}],[{tile:"Bomb",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Sand",obj:"Crash"},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Lava",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:"Crash"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Honey"},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Lava",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Grass",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Bomb",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Grass",obj:"Coin"},{tile:"Bomb",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Stab"},{tile:"Lava",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Honey"}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Dir"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Poison"},{tile:"Sand",obj:null}],[{tile:"Sand",obj:"Crash"},{tile:"Grass",obj:"Dir"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Lava",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Bomb",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Crash"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Cure"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null}],[{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Poison"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Bomb",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Crash"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Lava",obj:null}],[{tile:"Lava",obj:null},{tile:"Grass",obj:"Cure"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:"Coin"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Dir"}],[{tile:"Sand",obj:"Coin"},{tile:"Bomb",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Honey"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Poison"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Sand",obj:"Crash"}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:"Stab"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Dir"},{tile:"Lava",obj:null},{tile:"Sand",obj:null}],[{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Grass",obj:null},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"}],[{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Bomb",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Dir"},{tile:"Sand",obj:null}],[{tile:"Lava",obj:null},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:"Crash"},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:"Poison"},{tile:"Bomb",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:"Crash"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}]],[[{tile:"Bomb",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:"Crash"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null}]],[[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Lava",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}]],[[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:"Poison"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"}]],[[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Bomb",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Lava",obj:null}],[{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Stab"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null}]],[[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:null},{tile:"Grass",obj:null}],[{tile:"Bomb",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"}]],[[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Crash"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"}]],[[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Honey"},{tile:"Sand",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:"Crash"}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Water",obj:null,param:1},{tile:"Grass",obj:null}],[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Water",obj:null,param:1}],[{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Water",obj:null,param:1}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Bomb",obj:null}]],[[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Dir"},{tile:"Water",obj:null,param:-1},{tile:"Sand",obj:null},{tile:"Lava",obj:null},{tile:"Grass",obj:"Coin"}],[{tile:"Water",obj:null,param:-1},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Water",obj:null,param:-1},{tile:"Sand",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Honey"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Stab"},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Crash"}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Lava",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Lava",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Water",obj:null,param:1},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Honey"},{tile:"Grass",obj:"Stab"},{tile:"Sand",obj:"Coin"},{tile:"Water",obj:null,param:1}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Dir"},{tile:"Grass",obj:null},{tile:"Water",obj:null,param:1}],[{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null}]],[[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Dir"}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Water",obj:null,param:-1},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Water",obj:null,param:-1},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Water",obj:null,param:-1},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"}]],[[{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Bomb",obj:null},{tile:"Grass",obj:"Dir"}],[{tile:"Grass",obj:"Coin"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:"Tree"},{tile:"Water",obj:null,param:-1},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Water",obj:null,param:-1},{tile:"Sand",obj:null},{tile:"Grass",obj:"Coin"},{tile:"Grass",obj:null}],[{tile:"Water",obj:null,param:-1},{tile:"Grass",obj:null},{tile:"Sand",obj:"Coin"},{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:"Coin"}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:"Car",param:"a"},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"b"},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:"Car",param:"a"},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"b"},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:"Car",param:"a"},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"b"},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null}]],[[{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:"Car",param:"a"},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"b"},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null},{tile:"Grass",obj:"Tree"}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:null}],[{tile:"Road",obj:null,param:"b"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Road",obj:null,param:"d"},{tile:"Grass",obj:"Tree"}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Grass",obj:null},{tile:"Sand",obj:null}],[{tile:"Grass",obj:"Tree"},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null},{tile:"Grass",obj:null}],[{tile:"Grass",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null},{tile:"Sand",obj:null}]]],_=63,x={Grass:{type:"Grass",texture:"tile_green"},Sand:{type:"Sand",texture:"tile_brown",fallDuration:700,action:function(t,e,i){i.invincible||game.scene.addTimer(800,(function(){t.fall.start()}))}},Lava:{type:"Lava",texture:"tile_brown",hasDeco:!0,decoTex:["lava_01","lava_02","lava_03"],action:function(t,e,i){i.invincible||(game.audio.playSound("burn"),i.kill())}},Bomb:{type:"Bomb",texture:"tnt_a",action:function(t,e,i){t.sprite.texture="tnt_b",game.scene.addTimer(700,(function(){t.sprite.texture="tnt_c"})),game.scene.addTimer(800,(function(){t.sprite.texture="tnt_d"})),game.scene.addTimer(900,(function(){t.sprite.texture="tnt_e",game.audio.playSound("explo"),game.scene.emit("explode",{q:t.q,r:t.r})})),game.scene.addTimer(1e3,(function(){t.sprite.texture="tnt_f",game.scene.emit("explode",{q:t.q,r:t.r})})),game.scene.addTimer(1100,(function(){t.sprite.texture="tnt_g",game.scene.emit("explode",{q:t.q,r:t.r})}))}},Water:{type:"Water",texture:"water_d",action:function(t,e,i){i.onWater=!0,i.triedToJump||(t.param>0?game.scene.emit("right"):game.scene.emit("left"))}},Road:{type:"Road",texture:"road_b"}},w={Coin:{type:"Coin",texture:["coin_small","coin_small_02","coin_small_03","coin_small_04"],anchor:{x:.5,y:1.2},action:function(t,e){e.remove(),game.G.coin+=1,game.G.newCoins+=1;var i=new game.Sprite("coin_hud").addTo(game.scene.uiLayer);i.anchor.set(.5),i.position.copy(t.sprite.toGlobal(t.sprite.parent.position)).subtract(v,y),new game.Tween(i.position).to({x:.5*game.System.width-156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){i.remove()})).start(),game.audio.playSound("coin")}},Heart:{type:"Heart",texture:"heart",anchor:{x:.5,y:1},action:function(t,e){e.remove(),game.G.heart+=1;var i=new game.Sprite("heart").addTo(game.scene.uiLayer);i.anchor.set(.5),i.position.copy(t.sprite.toGlobal(t.sprite.parent.position)).subtract(v,y),new game.Tween(i.position).to({x:.5*game.System.width+156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){i.remove()})).start(),game.audio.playSound("heart-snd")}},Box:{type:"Box",texture:"box_a",anchor:{x:.5,y:1},action:function(t,e){e.texture="box_b";var i=new game.Sprite("shine").addTo(game.scene.tileLayer);i.alpha=.75,i.anchor.set(.5),i.position.copy(t.sprite.position).add(0,-16),i.update=function(){i.rotation+=game.system.delta*Math.PI*.75},game.scene.addObject(i),game.scene.addTimer(1e3,(function(){game.scene.removeObject(i),i.remove()})),game.rnd.frac()<.4?game.R.sequentially(100,[0,0,0,0,0,0,0,0]).onValue((function(){var e=new game.Sprite("coin_hud").addTo(game.scene.uiLayer);e.anchor.set(.5),e.position.copy(t.sprite.toGlobal(t.sprite.parent.position)).subtract(v,y),new game.Tween(e.position).to({x:.5*game.System.width-156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){e.remove(),game.G.coin+=1,game.G.newCoins+=1})).start()})):game.rnd.frac()<.6?game.R.sequentially(100,[0,0,0,0,0,0,0,0]).onValue((function(){var e=new game.Sprite("coin_hud").addTo(game.scene.uiLayer);e.anchor.set(.5),e.position.copy(t.sprite.toGlobal(t.sprite.parent.position)).subtract(v,y),new game.Tween(e.position).to({x:.5*game.System.width-156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){e.remove(),game.G.coin+=1,game.G.newCoins+=1})).start()})):game.R.sequentially(100,[0,0,0,0,0]).onValue((function(){})),game.audio.playSound("heart-snd")}},Stab:{type:"Stab",texture:["sting_01_a","sting_01_b","sting_01_c"],anchor:{x:.5,y:1},loopAction:function(t,e,i){i.invincible||i.killed||0===e.anims.a.frames[e.currentFrame]&&(game.audio.playSound("hit-car"),i.killByStab())}},Dir:{type:"Dir",texture:"way",anchor:{x:.5,y:1},action:function(t,e,i){i.dir=-1}},Tree:{type:"Tree",texture:"tree_01",anchor:{x:.5,y:1},block:!0},Crash:{type:"Crash",texture:"cute",anchor:{x:.5,y:1},fallDuration:100,action:function(t,e,i){i.invincible||i.killed||(game.audio.playSound("crash"),i.drop(),t.fall.start())}},Honey:{type:"Honey",texture:"honey",anchor:{x:.5,y:1},action:function(t,e,i){i.invincible||i.killed||(game.scene.jumpSnapped=!0,game.scene.jumpSnap=0,t.snap=function(){t.snapObj.visible=!0,t.snapObj.play("snap"),game.audio.playSound("snap")})}},Poison:{type:"Poison",texture:"oli_left",anchor:{x:.5,y:1},action:function(t,e,i){i.invincible||i.killed||(game.scene.mePoisoned=!0,game.scene.health=3.6,game.scene.healthBox||(game.scene.healthBox=(new game.Sprite).addTo(i),game.scene.healthBox.anchor.set(.5,1)))}},Cure:{type:"Cure",texture:"bottle",anchor:{x:.5,y:1},action:function(t,e,i){game.scene.mePoisoned&&(game.scene.mePoisoned=!1,e.remove(),game.scene.healthBox&&(game.scene.healthBox.visible=!1))}},Shield:{type:"Shield",texture:"shild_01",anchor:{x:.5,y:1},action:function(t,e,i){i.invincible&&game.scene.removeTimer(i.invincTimer),i.invincible=!0,i.invincTimer=game.scene.addTimer(5e3,(function(){i.invincible=!1,i.protect&&(i.protect.visible=!1)})),i.protect||(i.protect=new game.Sprite("shield").addTo(i),i.protect.anchor.set(.5,.9)),i.protect.visible=!0}},Car:{type:"Car",texture:"car_01_b",anchor:{x:.5,y:1}}},T={Grass:"gras_tile",Lava:"lava_pixel",Water:"water_pixel"},S=["Grass","Lava","Water"],E=.01,C=.02,A=1,j={x:.5,y:.5};i.prototype=Object.create(game.EventEmitter.prototype),i.prototype.constructor=i;var R=this.imports["game.cloud"],M=["bg_select","bg_02","bg_03","bg_04","bg_05"];n.prototype=Object.create(game.Scene.prototype),Object.assign(n.prototype,{backgroundColor:12172999,constructor:n,update:function(){if(this.isMoving&&(this.camera.sensor.y+=30*game.system.delta,this.camera.position.y>this.tiles[0].yLimit+30&&(this.tiles[0].forEach((function(t){t.fall.start()})),this.tiles.shift(),this.tiles.push(o(this.getNextRow(),this.lastRow+1)))),this.jumpSnapped&&(this.jumpSnap-=game.system.delta),this.mePoisoned){this.health-=game.system.delta;var t=5-Math.floor(Math.max(0,this.health)/3.6*4);this.healthBox.texture="infection_0"+t+"b",this.healthBox.visible=!0,this.health<0&&this.emit("poisonKill")}v=this.container.x,y=this.container.y},keydown:function(t){"LEFT"===t?this.emit("left"):"RIGHT"===t&&this.emit("right")},mousedown:function(t){t.data.global.x<.5*game.system.width?this.emit("left"):this.emit("right")},touchstart:function(t){t.data.global.x<.5*game.system.width?this.emit("left"):this.emit("right")},firstTilePattern:function(t){var e=b[0];return this.currPatternIdx=0,this.currPatternLength=e.length,this.nextPatternRowIdx=e.length+1,e},getNextRow:function(){var t=b[this.currPatternIdx];this.nextPatternRowIdx>this.currPatternLength-1&&(this.currPatternIdx=game.rnd.between(1,b.length-1),t=b[this.currPatternIdx],this.currPatternLength=t.length,this.nextPatternRowIdx=0);var e=t[this.nextPatternRowIdx];return this.nextPatternRowIdx+=1,e},resize:function(){this.emit("resize")},exit:function(){this.removeAllListeners()}}),game.s.Playground=n})),game.module("plugins.reactive").body((function(){var t=function(t,e){return game.scene.addTimer(e,t,!1)};game.R=function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){function n(t,e,i){return function(){if(r.DEPRECATION_WARNINGS&&"undefined"!=typeof console&&console.log);return i.apply(this,arguments)}}var r=t.exports={};r.Kefir=r;var o=r.Observable=i(1);r.Stream=i(6),r.Property=i(7),r.never=i(8),r.later=i(9),r.interval=i(11),r.sequentially=i(12),r.fromPoll=i(13),r.withInterval=i(14),r.fromCallback=i(16),r.fromNodeCallback=i(18),r.fromEvents=i(19),r.stream=i(17),r.constant=i(22),r.constantError=i(23),r.fromPromise=i(24);var s=i(25);o.prototype.toProperty=function(t){return s(this,t)};var a=i(27);o.prototype.changes=function(){return a(this)};var l=i(28);o.prototype.toPromise=function(t){return l(this,t)};var h=i(29);o.prototype.map=function(t){return h(this,t)};var u=i(30);o.prototype.filter=function(t){return u(this,t)};var c=i(31);o.prototype.take=function(t){return c(this,t)};var d=i(32);o.prototype.takeWhile=function(t){return d(this,t)};var p=i(33);o.prototype.last=function(){return p(this)};var f=i(34);o.prototype.skip=function(t){return f(this,t)};var m=i(35);o.prototype.skipWhile=function(t){return m(this,t)};var g=i(36);o.prototype.skipDuplicates=function(t){return g(this,t)};var v=i(37);o.prototype.diff=function(t,e){return v(this,t,e)};var y=i(38);o.prototype.scan=function(t,e){return y(this,t,e)};var b=i(39);o.prototype.flatten=function(t){return b(this,t)};var _=i(40);o.prototype.delay=function(t){return _(this,t)};var x=i(41);o.prototype.throttle=function(t,e){return x(this,t,e)};var w=i(43);o.prototype.debounce=function(t,e){return w(this,t,e)};var T=i(44);o.prototype.valuesToErrors=function(t){return T(this,t)};var S=i(45);o.prototype.errorsToValues=function(t){return S(this,t)};var E=i(46);o.prototype.mapErrors=function(t){return E(this,t)};var C=i(47);o.prototype.filterErrors=function(t){return C(this,t)};var A=i(48);o.prototype.endOnError=function(){return A(this)};var j=i(49);o.prototype.skipValues=function(){return j(this)};var R=i(50);o.prototype.skipErrors=function(){return R(this)};var M=i(51);o.prototype.skipEnd=function(){return M(this)};var O=i(52);o.prototype.beforeEnd=function(t){return O(this,t)};var D=i(53);o.prototype.slidingWindow=function(t,e){return D(this,t,e)};var P=i(54);o.prototype.bufferWhile=function(t,e){return P(this,t,e)};var F=i(55);o.prototype.transduce=function(t){return F(this,t)};var G=i(56);o.prototype.withHandler=function(t){return G(this,t)};var L=r.combine=i(57);o.prototype.combine=function(t,e){return L([this,t],e)};var B=r.zip=i(58);o.prototype.zip=function(t,e){return B([this,t],e)};var I=r.merge=i(59);o.prototype.merge=function(t){return I([this,t])};var N=r.concat=i(61);o.prototype.concat=function(t){return N([this,t])};var k=r.Pool=i(63);r.pool=function(){return new k},r.repeat=i(62);var U=i(64);o.prototype.flatMap=function(t){return new U(this,t).setName(this,"flatMap")},o.prototype.flatMapLatest=function(t){return new U(this,t,{concurLim:1,drop:"old"}).setName(this,"flatMapLatest")},o.prototype.flatMapFirst=function(t){return new U(this,t,{concurLim:1}).setName(this,"flatMapFirst")},o.prototype.flatMapConcat=function(t){return new U(this,t,{queueLim:-1,concurLim:1}).setName(this,"flatMapConcat")},o.prototype.flatMapConcurLimit=function(t,e){return new U(this,t,{queueLim:-1,concurLim:e}).setName(this,"flatMapConcurLimit")};var V=i(65);o.prototype.flatMapErrors=function(t){return new V(this,t).setName(this,"flatMapErrors")};var H=i(66);o.prototype.filterBy=function(t){return H(this,t)};var X=i(68);o.prototype.sampledBy=function(t,e){return X(this,t,e)};var z=i(69);o.prototype.skipUntilBy=function(t){return z(this,t)};var W=i(70);o.prototype.takeUntilBy=function(t){return W(this,t)};var Y=i(71);o.prototype.bufferBy=function(t,e){return Y(this,t,e)};var q=i(72);o.prototype.bufferWhileBy=function(t,e){return q(this,t,e)};var Q=i(73);o.prototype.awaiting=function(t){return Q(this,t)},r.DEPRECATION_WARNINGS=!0;var $=r.Emitter=i(74);r.emitter=n(0,0,(function(){return new $}));var K=r.Bus=i(75);r.bus=n(0,0,(function(){return new K}));var J=i(76);o.prototype.reduce=n(0,0,(function(t,e){return J(this,t,e)}));var Z=i(77);r.sampledBy=n(0,0,Z);var tt=i(78);r.repeatedly=n(0,0,tt);var et=i(79);o.prototype.mapTo=n(0,0,(function(t){return et(this,t)}));var it=i(80);o.prototype.tap=n(0,0,(function(t){return it(this,t)}));var nt=i(81);o.prototype.pluck=n(0,0,(function(t){return nt(this,t)}));var rt=i(82);o.prototype.invoke=n(0,0,(function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;e>n;n++)i[n-1]=arguments[n];return rt(this,t,i)}));var ot=i(83);o.prototype.timestamp=n(0,0,(function(){return ot(this)}));var st=i(84);r.and=n(0,0,st),o.prototype.and=n(0,0,(function(t){return st([this,t])}));var at=i(85);r.or=n(0,0,at),o.prototype.or=n(0,0,(function(t){return at([this,t])}));var lt=i(86);o.prototype.not=n(0,0,(function(){return lt(this)}));var ht=i(20);r.fromSubUnsub=n(0,0,ht);var ut=i(87);o.prototype.takeWhileBy=n(0,0,(function(t){return ut(this,t)}));var ct=i(88);o.prototype.skipWhileBy=n(0,0,(function(t){return ct(this,t)}))},function(t,e,i){function n(){this._dispatcher=new c,this._active=!1,this._alive=!0,this._activating=!1,this._logHandlers=null}var r=i(2).extend,o=i(3),s=o.VALUE,a=o.ERROR,l=o.ANY,h=o.END,u=i(4),c=u.Dispatcher,d=u.callSubscriber,p=i(5).findByPred;r(n.prototype,{_name:"observable",_onActivation:function(){},_onDeactivation:function(){},_setActive:function(t){this._active!==t&&(this._active=t,t?(this._activating=!0,this._onActivation(),this._activating=!1):this._onDeactivation())},_clear:function(){this._setActive(!1),this._dispatcher.cleanup(),this._dispatcher=null,this._logHandlers=null},_emit:function(t,e){switch(t){case s:return this._emitValue(e);case a:return this._emitError(e);case h:return this._emitEnd()}},_emitValue:function(t){this._alive&&this._dispatcher.dispatch({type:s,value:t,current:this._activating})},_emitError:function(t){this._alive&&this._dispatcher.dispatch({type:a,value:t,current:this._activating})},_emitEnd:function(){this._alive&&(this._alive=!1,this._dispatcher.dispatch({type:h,current:this._activating}),this._clear())},_on:function(t,e){return this._alive?(this._dispatcher.add(t,e),this._setActive(!0)):d(t,e,{type:h,current:!0}),this},_off:function(t,e){this._alive&&(0===this._dispatcher.remove(t,e)&&this._setActive(!1));return this},onValue:function(t){return this._on(s,t)},onError:function(t){return this._on(a,t)},onEnd:function(t){return this._on(h,t)},onAny:function(t){return this._on(l,t)},offValue:function(t){return this._off(s,t)},offError:function(t){return this._off(a,t)},offEnd:function(t){return this._off(h,t)},offAny:function(t){return this._off(l,t)},_ofSameType:function(t,e){return t.prototype.getType()===this.getType()?t:e},setName:function(t,e){return this._name=e?t._name+"."+e:t,this},log:function(){var t=arguments.length<=0||void 0===arguments[0]?this.toString():arguments[0],e=function(t){t.type,t.current;t.type};return this._alive&&(this._logHandlers||(this._logHandlers=[]),this._logHandlers.push({name:t,handler:e})),this.onAny(e),this},offLog:function(){var t=arguments.length<=0||void 0===arguments[0]?this.toString():arguments[0];if(this._logHandlers){var e=p(this._logHandlers,(function(e){return e.name===t}));-1!==e&&(this.offAny(this._logHandlers[e].handler),this._logHandlers.splice(e,1))}return this}}),n.prototype.toString=function(){return"["+this._name+"]"},t.exports=n},function(t,e){function i(t){var e=arguments.length,i=void 0,n=void 0;for(i=1;e>i;i++)for(n in arguments[i])t[n]=arguments[i][n];return t}t.exports={extend:i,inherit:function(t,e){var n,r,o=arguments.length,s=void 0;for(t.prototype=(n=e.prototype,r=void 0,(r=function(){}).prototype=n,new r),t.prototype.constructor=t,s=2;o>s;s++)i(t.prototype,arguments[s]);return t}}},function(t,e){e.NOTHING=["<nothing>"],e.END="end",e.VALUE="value",e.ERROR="error",e.ANY="any"},function(t,e,i){function n(t,e,i){t===h?e(i):t===i.type&&(t===a||t===l?e(i.value):e())}function r(){this._items=[],this._inLoop=0,this._removedItems=null}var o=i(2).extend,s=i(3),a=s.VALUE,l=s.ERROR,h=s.ANY,u=i(5),c=u.concat,d=u.findByPred,p=u.remove,f=u.contains;o(r.prototype,{add:function(t,e){return this._items=c(this._items,[{type:t,fn:e}]),this._items.length},remove:function(t,e){var i=d(this._items,(function(i){return i.type===t&&i.fn===e}));return 0!==this._inLoop&&-1!==i&&(null===this._removedItems&&(this._removedItems=[]),this._removedItems.push(this._items[i])),this._items=p(this._items,i),this._items.length},dispatch:function(t){this._inLoop++;for(var e=0,i=this._items;e<i.length&&null!==this._items;e++)null!==this._removedItems&&f(this._removedItems,i[e])||n(i[e].type,i[e].fn,t);this._inLoop--,0===this._inLoop&&(this._removedItems=null)},cleanup:function(){this._items=null}}),t.exports={callSubscriber:n,Dispatcher:r}},function(t,e){function i(t,e){var i=t.length,n=void 0;for(n=0;i>n;n++)if(t[n]===e)return n;return-1}function n(t,e){var i=t.length,n=void 0;for(n=0;i>n;n++)if(e(t[n]))return n;return-1}function r(t,e){var i=t.length,n=void 0,r=void 0,o=void 0;if(e>=0&&i>e){if(1===i)return[];for(n=new Array(i-1),r=0,o=0;i>r;r++)r!==e&&(n[o]=t[r],o++);return n}return t}t.exports={concat:function(t,e){var i=void 0,n=void 0,r=void 0,o=void 0;if(0===t.length)return e;if(0===e.length)return t;for(o=0,i=new Array(t.length+e.length),n=t.length,r=0;n>r;r++,o++)i[o]=t[r];for(n=e.length,r=0;n>r;r++,o++)i[o]=e[r];return i},circleShift:function(t,e){var i=t.length,n=new Array(i),r=void 0;for(r=0;i>r;r++)n[(r+e)%i]=t[r];return n},find:i,findByPred:n,cloneArray:function(t){var e=t.length,i=new Array(e),n=void 0;for(n=0;e>n;n++)i[n]=t[n];return i},remove:r,removeByPred:function(t,e){return r(t,n(t,e))},map:function(t,e){var i=t.length,n=new Array(i),r=void 0;for(r=0;i>r;r++)n[r]=e(t[r]);return n},forEach:function(t,e){var i=t.length,n=void 0;for(n=0;i>n;n++)e(t[n])},fillArray:function(t,e){var i=t.length,n=void 0;for(n=0;i>n;n++)t[n]=e},contains:function(t,e){return-1!==i(t,e)},slide:function(t,e,i){var n=Math.min(i,t.length+1),r=t.length-n+1,o=new Array(n),s=void 0;for(s=r;n>s;s++)o[s-r]=t[s];return o[n-1]=e,o}}},function(t,e,i){function n(){o.call(this)}var r=i(2).inherit,o=i(1);r(n,o,{_name:"stream",getType:function(){return"stream"}}),t.exports=n},function(t,e,i){function n(){u.call(this),this._currentEvent=null}var r=i(2).inherit,o=i(3),s=o.VALUE,a=o.ERROR,l=o.END,h=i(4).callSubscriber,u=i(1);r(n,u,{_name:"property",_emitValue:function(t){this._alive&&(this._activating||this._dispatcher.dispatch({type:s,value:t,current:this._activating}),this._currentEvent={type:s,value:t,current:!0})},_emitError:function(t){this._alive&&(this._activating||this._dispatcher.dispatch({type:a,value:t,current:this._activating}),this._currentEvent={type:a,value:t,current:!0})},_emitEnd:function(){this._alive&&(this._alive=!1,this._activating||this._dispatcher.dispatch({type:l,current:this._activating}),this._clear())},_on:function(t,e){return this._alive&&(this._dispatcher.add(t,e),this._setActive(!0)),null!==this._currentEvent&&h(t,e,this._currentEvent),this._alive||h(t,e,{type:l,current:!0}),this},getType:function(){return"property"}}),t.exports=n},function(t,e,i){var n=new(i(6));n._emitEnd(),n._name="never",t.exports=function(){return n}},function(t,e,i){var n=i(10)({_name:"later",_init:function(t){var e=t.x;this._x=e},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x),this._emitEnd()}});t.exports=function(t,e){return new n(t,{x:e})}},function(t,e,i){var n=i(2).inherit,r=i(6);t.exports=function(t){function e(t,e){var i=this;r.call(this),this._wait=t,this._intervalId=null,this._$onTick=function(){return i._onTick()},this._init(e)}return n(e,r,{_init:function(t){},_free:function(){},_onTick:function(){},_onActivation:function(){var t,e;this._intervalId=(t=this._$onTick,e=this._wait,game.scene.addTimer(e,t,!0))},_onDeactivation:function(){var t;null!==this._intervalId&&(t=this._intervalId,game.scene.removeTimer(t),this._intervalId=null)},_clear:function(){r.prototype._clear.call(this),this._$onTick=null,this._free()}},t),e}},function(t,e,i){var n=i(10)({_name:"interval",_init:function(t){var e=t.x;this._x=e},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x)}});t.exports=function(t,e){return new n(t,{x:e})}},function(t,e,i){var n=i(10),r=i(5).cloneArray,o=i(8),s=n({_name:"sequentially",_init:function(t){var e=t.xs;this._xs=r(e)},_free:function(){this._xs=null},_onTick:function(){1===this._xs.length?(this._emitValue(this._xs[0]),this._emitEnd()):this._emitValue(this._xs.shift())}});t.exports=function(t,e){return 0===e.length?o():new s(t,{xs:e})}},function(t,e,i){var n=i(10)({_name:"fromPoll",_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_onTick:function(){var t=this._fn;this._emitValue(t())}});t.exports=function(t,e){return new n(t,{fn:e})}},function(t,e,i){var n=i(10),r=i(15),o=n({_name:"withInterval",_init:function(t){var e=t.fn;this._fn=e,this._emitter=r(this)},_free:function(){this._fn=null,this._emitter=null},_onTick:function(){(0,this._fn)(this._emitter)}});t.exports=function(t,e){return new o(t,{fn:e})}},function(t,e){t.exports=function(t){function e(e){return t._emitValue(e),t._active}function i(e){return t._emit(e.type,e.value),t._active}return{value:e,error:function(e){return t._emitError(e),t._active},end:function(){return t._emitEnd(),t._active},event:i,emit:e,emitEvent:i}}},function(t,e,i){var n=i(17);t.exports=function(t){var e=!1;return n((function(i){e||(t((function(t){i.emit(t),i.end()})),e=!0)})).setName("fromCallback")}},function(t,e,i){function n(t){o.call(this),this._fn=t,this._unsubscribe=null}var r=i(2).inherit,o=i(6),s=i(15);r(n,o,{_name:"stream",_onActivation:function(){var t=(0,this._fn)(s(this));this._unsubscribe="function"==typeof t?t:null,this._active||this._callUnsubscribe()},_callUnsubscribe:function(){null!==this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null)},_onDeactivation:function(){this._callUnsubscribe()},_clear:function(){o.prototype._clear.call(this),this._fn=null}}),t.exports=function(t){return new n(t)}},function(t,e,i){var n=i(17);t.exports=function(t){var e=!1;return n((function(i){e||(t((function(t,e){t?i.error(t):i.emit(e),i.end()})),e=!0)})).setName("fromNodeCallback")}},function(t,e,i){var n=i(20),r=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"]];t.exports=function(t,e,i){for(var o=void 0,s=void 0,a=0;a<r.length;a++)if("function"==typeof t[r[a][0]]&&"function"==typeof t[r[a][1]]){o=r[a][0],s=r[a][1];break}if(void 0===o)throw new Error("target don't support any of addEventListener/removeEventListener, addListener/removeListener, on/off method pair");return n((function(i){return t[o](e,i)}),(function(i){return t[s](e,i)}),i).setName("fromEvents")}},function(t,e,i){var n=i(17),r=i(21).apply;t.exports=function(t,e,i){return n((function(n){var o=i?function(){n.emit(r(i,this,arguments))}:n.emit;return t(o),function(){return e(o)}})).setName("fromSubUnsub")}},function(t,e){t.exports={spread:function(t,e){switch(e){case 0:return function(e){return t()};case 1:return function(e){return t(e[0])};case 2:return function(e){return t(e[0],e[1])};case 3:return function(e){return t(e[0],e[1],e[2])};case 4:return function(e){return t(e[0],e[1],e[2],e[3])};default:return function(e){return t.apply(null,e)}}},apply:function(t,e,i){var n=i?i.length:0;if(null!=e){if(0===n)return t.call(e);return t.apply(e,i)}switch(n){case 0:return t();case 1:return t(i[0]);case 2:return t(i[0],i[1]);case 3:return t(i[0],i[1],i[2]);case 4:return t(i[0],i[1],i[2],i[3]);default:return t.apply(null,i)}}}},function(t,e,i){function n(t){this._currentEvent={type:"value",value:t,current:!0}}(0,i(2).inherit)(n,i(7),{_name:"constant",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null}),t.exports=function(t){return new n(t)}},function(t,e,i){function n(t){this._currentEvent={type:"error",value:t,current:!0}}(0,i(2).inherit)(n,i(7),{_name:"constantError",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null}),t.exports=function(t){return new n(t)}},function(t,e,i){var n=i(17),r=i(25);t.exports=function(t){var e=!1,i=n((function(i){if(!e){var n=t.then((function(t){i.emit(t),i.end()}),(function(t){i.error(t),i.end()}));n&&"function"==typeof n.done&&n.done(),e=!0}}));return r(i,null).setName("fromPromise")}},function(t,e,i){var n=(0,i(26).createProperty)("toProperty",{_init:function(t){var e=t.fn;this._getInitialCurrent=e},_onActivation:function(){if(null!==this._getInitialCurrent){var t=this._getInitialCurrent;this._emitValue(t())}this._source.onAny(this._$handleAny)}});t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null!==e&&"function"!=typeof e)throw new Error("You should call toProperty() with a function or no arguments.");return new n(t,{fn:e})}},function(t,e,i){function n(t,e){return function(i,n){var r=this;t.call(this),this._source=i,this._name=i._name+"."+e,this._init(n),this._$handleAny=function(t){return r._handleAny(t)}}}function r(t){return{_init:function(t){},_free:function(){},_handleValue:function(t){this._emitValue(t)},_handleError:function(t){this._emitError(t)},_handleEnd:function(){this._emitEnd()},_handleAny:function(t){switch(t.type){case h:return this._handleValue(t.value);case u:return this._handleError(t.value);case c:return this._handleEnd()}},_onActivation:function(){this._source.onAny(this._$handleAny)},_onDeactivation:function(){this._source.offAny(this._$handleAny)},_clear:function(){t.prototype._clear.call(this),this._source=null,this._$handleAny=null,this._free()}}}var o=i(6),s=i(7),a=i(2).inherit,l=i(3),h=l.VALUE,u=l.ERROR,c=l.END;t.exports={createStream:function(t,e){var i=n(o,t);return a(i,o,r(o),e),i},createProperty:function(t,e){var i=n(s,t);return a(i,s,r(s),e),i}}},function(t,e,i){var n=(0,i(26).createStream)("changes",{_handleValue:function(t){this._activating||this._emitValue(t)},_handleError:function(t){this._activating||this._emitError(t)}});t.exports=function(t){return new n(t)}},function(t,e){function i(){if("function"==typeof Promise)return Promise;throw new Error("There isn't default Promise, use shim or parameter")}t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?i():arguments[1],n=null;return new e((function(e,i){t.onAny((function(t){"end"===t.type&&null!==n?(("value"===n.type?e:i)(n.value),n=null):n=t}))}))}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=this._fn;this._emitValue(e(t))}},a=r("map",s),l=o("map",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){(0,this._fn)(t)&&this._emitValue(t)}},a=r("filter",s),l=o("filter",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.n;this._n=e,0>=e&&this._emitEnd()},_handleValue:function(t){this._n--,this._emitValue(t),0===this._n&&this._emitEnd()}},a=r("take",s),l=o("take",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,{n:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){(0,this._fn)(t)?this._emitValue(t):this._emitEnd()}},a=r("takeWhile",s),l=o("takeWhile",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_init:function(){this._lastValue=s},_free:function(){this._lastValue=null},_handleValue:function(t){this._lastValue=t},_handleEnd:function(){this._lastValue!==s&&this._emitValue(this._lastValue),this._emitEnd()}},l=r("last",a),h=o("last",a);t.exports=function(t){return new(t._ofSameType(l,h))(t)}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.n;this._n=Math.max(0,e)},_handleValue:function(t){0===this._n?this._emitValue(t):this._n--}},a=r("skip",s),l=o("skip",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,{n:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=this._fn;null===this._fn||e(t)||(this._fn=null),null===this._fn&&this._emitValue(t)}},a=r("skipWhile",s),l=o("skipWhile",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_init:function(t){var e=t.fn;this._fn=e,this._prev=s},_free:function(){this._fn=null,this._prev=null},_handleValue:function(t){var e=this._fn;this._prev!==s&&e(this._prev,t)||(this._prev=t,this._emitValue(t))}},l=r("skipDuplicates",a),h=o("skipDuplicates",a),u=function(t,e){return t===e};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?u:arguments[1];return new(t._ofSameType(l,h))(t,{fn:e})}},function(t,e,i){function n(t,e){return[t,e]}var r=i(26),o=r.createStream,s=r.createProperty,a=i(3).NOTHING,l={_init:function(t){var e=t.fn,i=t.seed;this._fn=e,this._prev=i},_free:function(){this._prev=null,this._fn=null},_handleValue:function(t){if(this._prev!==a){var e=this._fn;this._emitValue(e(this._prev,t))}this._prev=t}},h=o("diff",l),u=s("diff",l);t.exports=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?a:arguments[2];return new(t._ofSameType(h,u))(t,{fn:e||n,seed:i})}},function(t,e,i){var n=i(26).createProperty,r=i(3),o=r.ERROR,s=r.NOTHING,a=n("scan",{_init:function(t){var e=t.fn,i=t.seed;this._fn=e,i!==s&&this._emitValue(i)},_free:function(){this._fn=null},_handleValue:function(t){null!==this._currentEvent&&this._currentEvent.type!==o&&(t=(0,this._fn)(this._currentEvent.value,t));this._emitValue(t)}});t.exports=function(t,e){return new a(t,{fn:e,seed:arguments.length<=2||void 0===arguments[2]?s:arguments[2]})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){for(var e=(0,this._fn)(t),i=0;i<e.length;i++)this._emitValue(e[i])}},a=r("flatten",s),l=o("flatten",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(e,i,n){var r=n(26),o=r.createStream,s=r.createProperty,a={_init:function(t){var e=this,i=t.wait;this._wait=Math.max(0,i),this._buff=[],this._lastTimer=null,this._$shiftBuff=function(){return e._emitValue(e._buff.shift())}},_free:function(){this._buff=null,this._lastTimer=null,this._$shiftBuff=null},_handleValue:function(e){this._activating?this._emitValue(e):(this._buff.push(e),this._lastTimer=t(this._$shiftBuff,this._wait))},_handleEnd:function(){var e,i=this;this._activating?this._emitEnd():this._lastTimer?(e=i._lastTimer.callback,i._lastTimer.callback=function(){e(),i._emitEnd()}):t((function(){return i._emitEnd()}),this._wait)}},l=o("delay",a),h=s("delay",a);e.exports=function(t,e){return new(t._ofSameType(l,h))(t,{wait:e})}},function(e,i,n){var r=n(26),o=r.createStream,s=r.createProperty,a=n(42),l={_init:function(t){var e=this,i=t.wait,n=t.leading,r=t.trailing;this._wait=Math.max(0,i),this._leading=n,this._trailing=r,this._trailingValue=null,this._timeoutId=null,this._endLater=!1,this._lastCallTime=0,this._$trailingCall=function(){return e._trailingCall()}},_free:function(){this._trailingValue=null,this._$trailingCall=null},_handleValue:function(e){if(this._activating)this._emitValue(e);else{var i=a();0!==this._lastCallTime||this._leading||(this._lastCallTime=i);var n=this._wait-(i-this._lastCallTime);0>=n?(this._cancelTrailing(),this._lastCallTime=i,this._emitValue(e)):this._trailing&&(this._cancelTrailing(),this._trailingValue=e,this._timeoutId=t(this._$trailingCall,n))}},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId?this._endLater=!0:this._emitEnd()},_cancelTrailing:function(){var t;null!==this._timeoutId&&(t=this._timeoutId,game.scene.removeTimer(t),this._timeoutId=null)},_trailingCall:function(){this._emitValue(this._trailingValue),this._timeoutId=null,this._trailingValue=null,this._lastCallTime=this._leading?a():0,this._endLater&&this._emitEnd()}},h=o("throttle",l),u=s("throttle",l);e.exports=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],n=i.leading,r=void 0===n||n,o=i.trailing,s=void 0===o||o;return new(t._ofSameType(h,u))(t,{wait:e,leading:r,trailing:s})}},function(t,e){t.exports=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()}},function(e,i,n){var r=n(26),o=r.createStream,s=r.createProperty,a=n(42),l={_init:function(t){var e=this,i=t.wait,n=t.immediate;this._wait=Math.max(0,i),this._immediate=n,this._lastAttempt=0,this._timeoutId=null,this._laterValue=null,this._endLater=!1,this._$later=function(){return e._later()}},_free:function(){this._laterValue=null,this._$later=null},_handleValue:function(e){this._activating?this._emitValue(e):(this._lastAttempt=a(),this._immediate&&!this._timeoutId&&this._emitValue(e),this._timeoutId||(this._timeoutId=t(this._$later,this._wait)),this._immediate||(this._laterValue=e))},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId&&!this._immediate?this._endLater=!0:this._emitEnd()},_later:function(){var e=a()-this._lastAttempt;e<this._wait&&e>=0?this._timeoutId=t(this._$later,this._wait-e):(this._timeoutId=null,this._immediate||(this._emitValue(this._laterValue),this._laterValue=null),this._endLater&&this._emitEnd())}},h=o("debounce",l),u=s("debounce",l);e.exports=function(t,e){var i=(arguments.length<=2||void 0===arguments[2]?{}:arguments[2]).immediate,n=void 0!==i&&i;return new(t._ofSameType(h,u))(t,{wait:e,immediate:n})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleValue:function(t){var e=(0,this._fn)(t);e.convert?this._emitError(e.error):this._emitValue(t)}},a=r("valuesToErrors",s),l=o("valuesToErrors",s),h=function(t){return{convert:!0,error:t}};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){var e=(0,this._fn)(t);e.convert?this._emitValue(e.value):this._emitError(t)}},a=r("errorsToValues",s),l=o("errorsToValues",s),h=function(t){return{convert:!0,value:t}};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){var e=this._fn;this._emitError(e(t))}},a=r("mapErrors",s),l=o("mapErrors",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleError:function(t){(0,this._fn)(t)&&this._emitError(t)}},a=r("filterErrors",s),l=o("filterErrors",s),h=function(t){return t};t.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?h:arguments[1];return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_handleError:function(t){this._emitError(t),this._emitEnd()}},a=r("endOnError",s),l=o("endOnError",s);t.exports=function(t){return new(t._ofSameType(a,l))(t)}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_handleValue:function(){}},a=r("skipValues",s),l=o("skipValues",s);t.exports=function(t){return new(t._ofSameType(a,l))(t)}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_handleError:function(){}},a=r("skipErrors",s),l=o("skipErrors",s);t.exports=function(t){return new(t._ofSameType(a,l))(t)}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_handleEnd:function(){}},a=r("skipEnd",s),l=o("skipEnd",s);t.exports=function(t){return new(t._ofSameType(a,l))(t)}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn;this._fn=e},_free:function(){this._fn=null},_handleEnd:function(){var t=this._fn;this._emitValue(t()),this._emitEnd()}},a=r("beforeEnd",s),l=o("beforeEnd",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,{fn:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s=i(5).slide,a={_init:function(t){var e=t.min,i=t.max;this._max=i,this._min=e,this._buff=[]},_free:function(){this._buff=null},_handleValue:function(t){this._buff=s(this._buff,t,this._max),this._buff.length>=this._min&&this._emitValue(this._buff)}},l=r("slidingWindow",a),h=o("slidingWindow",a);t.exports=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return new(t._ofSameType(l,h))(t,{min:i,max:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e=t.fn,i=t.flushOnEnd;this._fn=e,this._flushOnEnd=i,this._buff=[]},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),(0,this._fn)(t)||this._flush()},_handleEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()}},a=r("bufferWhile",s),l=o("bufferWhile",s),h=function(t){return t};t.exports=function(t,e){var i=(arguments.length<=2||void 0===arguments[2]?{}:arguments[2]).flushOnEnd,n=void 0===i||i;return new(t._ofSameType(a,l))(t,{fn:e||h,flushOnEnd:n})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s={_init:function(t){var e,i=t.transducer;this._xform=i((e=this,{"@@transducer/step":function(t,i){return e._emitValue(i),null},"@@transducer/result":function(t){return e._emitEnd(),null}}))},_free:function(){this._xform=null},_handleValue:function(t){null!==this._xform["@@transducer/step"](null,t)&&this._xform["@@transducer/result"](null)},_handleEnd:function(){this._xform["@@transducer/result"](null)}},a=r("transduce",s),l=o("transduce",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,{transducer:e})}},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s=i(15),a={_init:function(t){var e=t.fn;this._handler=e,this._emitter=s(this)},_free:function(){this._handler=null,this._emitter=null},_handleAny:function(t){this._handler(this._emitter,t)}},l=r("withHandler",a),h=o("withHandler",a);t.exports=function(t,e){return new(t._ofSameType(l,h))(t,{fn:e})}},function(t,e,i){function n(t,e,i){var n=this;r.call(this),this._activeCount=t.length,this._sources=c(t,e),this._combinator=i?p(i,this._sources.length):function(t){return t},this._aliveCount=0,this._latestValues=new Array(this._sources.length),this._latestErrors=new Array(this._sources.length),d(this._latestValues,l),this._emitAfterActivation=!1,this._endAfterActivation=!1,this._latestErrorIndex=0,this._$handlers=[];for(var o=function(t){n._$handlers.push((function(e){return n._handleAny(t,e)}))},s=0;s<this._sources.length;s++)o(s)}var r=i(6),o=i(3),s=o.VALUE,a=o.ERROR,l=o.NOTHING,h=i(2).inherit,u=i(5),c=u.concat,d=u.fillArray,p=i(21).spread,f=i(8);h(n,r,{_name:"combine",_onActivation:function(){this._aliveCount=this._activeCount;for(var t=this._activeCount;t<this._sources.length;t++)this._sources[t].onAny(this._$handlers[t]);for(t=0;t<this._activeCount;t++)this._sources[t].onAny(this._$handlers[t]);this._emitAfterActivation&&(this._emitAfterActivation=!1,this._emitIfFull()),this._endAfterActivation&&this._emitEnd()},_onDeactivation:function(){var t=this._sources.length,e=void 0;for(e=0;t>e;e++)this._sources[e].offAny(this._$handlers[e])},_emitIfFull:function(){for(var t=!0,e=!1,i=this._latestValues.length,n=new Array(i),r=new Array(i),o=0;i>o;o++)n[o]=this._latestValues[o],r[o]=this._latestErrors[o],n[o]===l&&(t=!1),void 0!==r[o]&&(e=!0);if(t){var s=this._combinator;this._emitValue(s(n))}e&&this._emitError(function(t){for(var e=void 0,i=0;i<t.length;i++)void 0!==t[i]&&(void 0===e||e.index<t[i].index)&&(e=t[i]);return e.error}(r))},_handleAny:function(t,e){e.type===s||e.type===a?(e.type===s&&(this._latestValues[t]=e.value,this._latestErrors[t]=void 0),e.type===a&&(this._latestValues[t]=l,this._latestErrors[t]={index:this._latestErrorIndex++,error:e.value}),t<this._activeCount&&(this._activating?this._emitAfterActivation=!0:this._emitIfFull())):t<this._activeCount&&(this._aliveCount--,0===this._aliveCount&&(this._activating?this._endAfterActivation=!0:this._emitEnd()))},_clear:function(){r.prototype._clear.call(this),this._sources=null,this._latestValues=null,this._latestErrors=null,this._combinator=null,this._$handlers=null}}),t.exports=function(t,e,i){return void 0===e&&(e=[]),"function"==typeof e&&(i=e,e=[]),0===t.length?f():new n(t,e,i)}},function(t,e,i){function n(t,e){var i=this;r.call(this),this._buffers=c(t,(function(t){return m(t)?d(t):[]})),this._sources=c(t,(function(t){return m(t)?f():t})),this._combinator=e?p(e,this._sources.length):function(t){return t},this._aliveCount=0,this._$handlers=[];for(var n=function(t){i._$handlers.push((function(e){return i._handleAny(t,e)}))},o=0;o<this._sources.length;o++)n(o)}var r=i(6),o=i(3),s=o.VALUE,a=o.ERROR,l=o.END,h=i(2).inherit,u=i(5),c=u.map,d=u.cloneArray,p=i(21).spread,f=i(8),m=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};h(n,r,{_name:"zip",_onActivation:function(){for(;this._isFull();)this._emit();var t=this._sources.length;this._aliveCount=t;for(var e=0;t>e&&this._active;e++)this._sources[e].onAny(this._$handlers[e])},_onDeactivation:function(){for(var t=0;t<this._sources.length;t++)this._sources[t].offAny(this._$handlers[t])},_emit:function(){for(var t=new Array(this._buffers.length),e=0;e<this._buffers.length;e++)t[e]=this._buffers[e].shift();var i=this._combinator;this._emitValue(i(t))},_isFull:function(){for(var t=0;t<this._buffers.length;t++)if(0===this._buffers[t].length)return!1;return!0},_handleAny:function(t,e){e.type===s&&(this._buffers[t].push(e.value),this._isFull()&&this._emit()),e.type===a&&this._emitError(e.value),e.type===l&&(this._aliveCount--,0===this._aliveCount&&this._emitEnd())},_clear:function(){r.prototype._clear.call(this),this._sources=null,this._buffers=null,this._combinator=null,this._$handlers=null}}),t.exports=function(t,e){return 0===t.length?f():new n(t,e)}},function(t,e,i){function n(t){o.call(this),this._addAll(t),this._initialised=!0}var r=i(2).inherit,o=i(60),s=i(8);r(n,o,{_name:"merge",_onEmpty:function(){this._initialised&&this._emitEnd()}}),t.exports=function(t){return 0===t.length?s():new n(t)}},function(t,e,i){function n(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=e.queueLim,n=void 0===i?0:i,o=e.concurLim,s=void 0===o?-1:o,a=e.drop,l=void 0===a?"new":a;r.call(this),this._queueLim=0>n?-1:n,this._concurLim=0>s?-1:s,this._drop=l,this._queue=[],this._curSources=[],this._$handleSubAny=function(e){return t._handleSubAny(e)},this._$endHandlers=[],this._currentlyAdding=null,0===this._concurLim&&this._emitEnd()}var r=i(6),o=i(3),s=o.VALUE,a=o.ERROR,l=i(2).inherit,h=i(5),u=h.concat,c=h.forEach,d=h.findByPred,p=h.find,f=h.remove,m=h.cloneArray,g=function(t){return t};l(n,r,{_name:"abstractPool",_add:function(t,e){e=e||g,-1===this._concurLim||this._curSources.length<this._concurLim?this._addToCur(e(t)):-1===this._queueLim||this._queue.length<this._queueLim?this._addToQueue(e(t)):"old"===this._drop&&(this._removeOldest(),this._add(t,e))},_addAll:function(t){var e=this;c(t,(function(t){return e._add(t)}))},_remove:function(t){-1===this._removeCur(t)&&this._removeQueue(t)},_addToQueue:function(t){this._queue=u(this._queue,[t])},_addToCur:function(t){if(this._active){if(!t._alive)return void(t._currentEvent&&this._emit(t._currentEvent.type,t._currentEvent.value));this._currentlyAdding=t,t.onAny(this._$handleSubAny),this._currentlyAdding=null,t._alive&&(this._curSources=u(this._curSources,[t]),this._active&&this._subToEnd(t))}else this._curSources=u(this._curSources,[t])},_subToEnd:function(t){var e=this,i=function(){return e._removeCur(t)};this._$endHandlers.push({obs:t,handler:i}),t.onEnd(i)},_subscribe:function(t){t.onAny(this._$handleSubAny),this._active&&this._subToEnd(t)},_unsubscribe:function(t){t.offAny(this._$handleSubAny);var e=d(this._$endHandlers,(function(e){return e.obs===t}));-1!==e&&(t.offEnd(this._$endHandlers[e].handler),this._$endHandlers.splice(e,1))},_handleSubAny:function(t){t.type===s?this._emitValue(t.value):t.type===a&&this._emitError(t.value)},_removeQueue:function(t){var e=p(this._queue,t);return this._queue=f(this._queue,e),e},_removeCur:function(t){this._active&&this._unsubscribe(t);var e=p(this._curSources,t);return this._curSources=f(this._curSources,e),-1!==e&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()),e},_removeOldest:function(){this._removeCur(this._curSources[0])},_pullQueue:function(){0!==this._queue.length&&(this._queue=m(this._queue),this._addToCur(this._queue.shift()))},_onActivation:function(){for(var t=0,e=this._curSources;t<e.length&&this._active;t++)this._subscribe(e[t])},_onDeactivation:function(){for(var t=0,e=this._curSources;t<e.length;t++)this._unsubscribe(e[t]);null!==this._currentlyAdding&&this._unsubscribe(this._currentlyAdding)},_isEmpty:function(){return 0===this._curSources.length},_onEmpty:function(){},_clear:function(){r.prototype._clear.call(this),this._queue=null,this._curSources=null,this._$handleSubAny=null,this._$endHandlers=null}}),t.exports=n},function(t,e,i){var n=i(62);t.exports=function(t){return n((function(e){return t.length>e&&t[e]})).setName("concat")}},function(t,e,i){function n(t){var e=this;o.call(this),this._generator=t,this._source=null,this._inLoop=!1,this._iteration=0,this._$handleAny=function(t){return e._handleAny(t)}}var r=i(2).inherit,o=i(6),s=i(3).END;r(n,o,{_name:"repeat",_handleAny:function(t){t.type===s?(this._source=null,this._getSource()):this._emit(t.type,t.value)},_getSource:function(){if(!this._inLoop){this._inLoop=!0;for(var t=this._generator;null===this._source&&this._alive&&this._active;)this._source=t(this._iteration++),this._source?this._source.onAny(this._$handleAny):this._emitEnd();this._inLoop=!1}},_onActivation:function(){this._source?this._source.onAny(this._$handleAny):this._getSource()},_onDeactivation:function(){this._source&&this._source.offAny(this._$handleAny)},_clear:function(){o.prototype._clear.call(this),this._generator=null,this._source=null,this._$handleAny=null}}),t.exports=function(t){return new n(t)}},function(t,e,i){function n(){o.call(this)}var r=i(2).inherit,o=i(60);r(n,o,{_name:"pool",plug:function(t){return this._add(t),this},unplug:function(t){return this._remove(t),this}}),t.exports=n},function(t,e,i){function n(t,e,i){var n=this;h.call(this,i),this._source=t,this._fn=e,this._mainEnded=!1,this._lastCurrent=null,this._$handleMain=function(t){return n._handleMain(t)}}var r=i(3),o=r.VALUE,s=r.ERROR,a=r.END,l=i(2).inherit,h=i(60);l(n,h,{_onActivation:function(){h.prototype._onActivation.call(this),this._active&&this._source.onAny(this._$handleMain)},_onDeactivation:function(){h.prototype._onDeactivation.call(this),this._source.offAny(this._$handleMain),this._hadNoEvSinceDeact=!0},_handleMain:function(t){t.type===o&&(this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1);t.type===s&&this._emitError(t.value),t.type===a&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)},_onEmpty:function(){this._mainEnded&&this._emitEnd()},_clear:function(){h.prototype._clear.call(this),this._source=null,this._lastCurrent=null,this._$handleMain=null}}),t.exports=n},function(t,e,i){function n(t,e){h.call(this,t,e)}var r=i(3),o=r.VALUE,s=r.ERROR,a=r.END,l=i(2).inherit,h=i(64);l(n,h,{_handleMain:function(t){t.type===s&&(this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1);t.type===o&&this._emitValue(t.value),t.type===a&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)}}),t.exports=n},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_handlePrimaryValue:function(t){this._lastSecondary!==s&&this._lastSecondary&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary!==s&&this._lastSecondary||this._emitEnd()}},l=r("filterBy",a),h=o("filterBy",a);t.exports=function(t,e){return new(t._ofSameType(l,h))(t,e)}},function(t,e,i){function n(t,e){return function(i,n,r){var o=this;t.call(this),this._primary=i,this._secondary=n,this._name=i._name+"."+e,this._lastSecondary=d,this._$handleSecondaryAny=function(t){return o._handleSecondaryAny(t)},this._$handlePrimaryAny=function(t){return o._handlePrimaryAny(t)},this._init(r)}}function r(t){return{_init:function(t){},_free:function(){},_handlePrimaryValue:function(t){this._emitValue(t)},_handlePrimaryError:function(t){this._emitError(t)},_handlePrimaryEnd:function(){this._emitEnd()},_handleSecondaryValue:function(t){this._lastSecondary=t},_handleSecondaryError:function(t){this._emitError(t)},_handleSecondaryEnd:function(){},_handlePrimaryAny:function(t){switch(t.type){case h:return this._handlePrimaryValue(t.value);case u:return this._handlePrimaryError(t.value);case c:return this._handlePrimaryEnd(t.value)}},_handleSecondaryAny:function(t){switch(t.type){case h:return this._handleSecondaryValue(t.value);case u:return this._handleSecondaryError(t.value);case c:this._handleSecondaryEnd(t.value),this._removeSecondary()}},_removeSecondary:function(){null!==this._secondary&&(this._secondary.offAny(this._$handleSecondaryAny),this._$handleSecondaryAny=null,this._secondary=null)},_onActivation:function(){null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny),this._active&&this._primary.onAny(this._$handlePrimaryAny)},_onDeactivation:function(){null!==this._secondary&&this._secondary.offAny(this._$handleSecondaryAny),this._primary.offAny(this._$handlePrimaryAny)},_clear:function(){t.prototype._clear.call(this),this._primary=null,this._secondary=null,this._lastSecondary=null,this._$handleSecondaryAny=null,this._$handlePrimaryAny=null,this._free()}}}var o=i(6),s=i(7),a=i(2).inherit,l=i(3),h=l.VALUE,u=l.ERROR,c=l.END,d=l.NOTHING;t.exports={createStream:function(t,e){var i=n(o,t);return a(i,o,r(o),e),i},createProperty:function(t,e){var i=n(s,t);return a(i,s,r(s),e),i}}},function(t,e,i){var n=i(57),r=function(t,e){return e};t.exports=function(t,e,i){return n([e],[t],i?function(t,e){return i(e,t)}:r).setName(t,"sampledBy")}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_handlePrimaryValue:function(t){this._lastSecondary!==s&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary===s&&this._emitEnd()}},l=r("skipUntilBy",a),h=o("skipUntilBy",a);t.exports=function(t,e){return new(t._ofSameType(l,h))(t,e)}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s={_handleSecondaryValue:function(t){this._emitEnd()}},a=r("takeUntilBy",s),l=o("takeUntilBy",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,e)}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s={_init:function(){var t=(arguments.length<=0||void 0===arguments[0]?{}:arguments[0]).flushOnEnd,e=void 0===t||t;this._buff=[],this._flushOnEnd=e},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_onActivation:function(){this._primary.onAny(this._$handlePrimaryAny),this._alive&&null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny)},_handlePrimaryValue:function(t){this._buff.push(t)},_handleSecondaryValue:function(t){this._flush()},_handleSecondaryEnd:function(t){this._flushOnEnd||this._emitEnd()}},a=r("bufferBy",s),l=o("bufferBy",s);t.exports=function(t,e,i){return new(t._ofSameType(a,l))(t,e,i)}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_init:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.flushOnEnd,i=void 0===e||e,n=t.flushOnChange,r=void 0!==n&&n,o=t.emitEmpty,s=void 0!==o&&o;this._buff=[],this._emitEmpty=s,this._flushOnEnd=i,this._flushOnChange=r},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitEmpty||this._buff.length>0)&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_handlePrimaryValue:function(t){this._buff.push(t),this._lastSecondary===s||this._lastSecondary||this._flush()},_handleSecondaryEnd:function(t){this._flushOnEnd||this._lastSecondary!==s&&!this._lastSecondary||this._emitEnd()},_handleSecondaryValue:function(t){this._flushOnChange&&!t&&this._flush(),this._lastSecondary=t}},l=r("bufferWhileBy",a),h=o("bufferWhileBy",a);t.exports=function(t,e,i){return new(t._ofSameType(l,h))(t,e,i)}},function(t,e,i){var n=i(59),r=i(29),o=i(36),s=i(25),a=function(){return!1},l=function(){return!0};t.exports=function(t,e){var i=n([r(t,l),r(e,a)]);return i=o(i),(i=s(i,a)).setName(t,"awaiting")}},function(t,e,i){function n(){o.call(this)}var r=i(2).inherit,o=i(6);r(n,o,{_name:"emitter",emit:function(t){return this._emitValue(t),this},error:function(t){return this._emitError(t),this},end:function(){return this._emitEnd(),this},emitEvent:function(t){this._emit(t.type,t.value)}}),t.exports=n},function(t,e,i){function n(){o.call(this)}var r=i(2).inherit,o=i(60);r(n,o,{_name:"bus",plug:function(t){return this._add(t),this},unplug:function(t){return this._remove(t),this},emit:function(t){return this._emitValue(t),this},error:function(t){return this._emitError(t),this},end:function(){return this._emitEnd(),this},emitEvent:function(t){this._emit(t.type,t.value)}}),t.exports=n},function(t,e,i){var n=i(26),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_init:function(t){var e=t.fn,i=t.seed;this._fn=e,this._result=i},_free:function(){this._fn=null,this._result=null},_handleValue:function(t){var e=this._fn;this._result=this._result===s?t:e(this._result,t)},_handleEnd:function(){this._result!==s&&this._emitValue(this._result),this._emitEnd()}},l=r("reduce",a),h=o("reduce",a);t.exports=function(t,e){var i=arguments.length<=2||void 0===arguments[2]?s:arguments[2];return new(t._ofSameType(l,h))(t,{fn:e,seed:i})}},function(t,e,i){var n=i(57),r=i(21).apply,o=i(5).circleShift;t.exports=function(t,e,i){var s=i;return t.length>0&&(s=function(){var e=o(arguments,t.length);return i?r(i,null,e):e}),n(e,t,s).setName("sampledBy")}},function(t,e,i){var n=i(10),r=i(5).cloneArray,o=n({_name:"repeatedly",_init:function(t){var e=t.xs;this._xs=r(e),this._i=-1},_onTick:function(){this._xs.length>0&&(this._i=(this._i+1)%this._xs.length,this._emitValue(this._xs[this._i]))}});t.exports=function(t,e){return new o(t,{xs:e})}},function(t,e,i){var n=i(29);t.exports=function(t,e){return n(t,(function(){return e})).setName(t,"mapTo")}},function(t,e,i){var n=i(29);t.exports=function(t,e){return n(t,(function(t){return e(t),t})).setName(t,"tap")}},function(t,e,i){var n=i(29);t.exports=function(t,e){return n(t,(function(t){return t[e]})).setName(t,"pluck")}},function(t,e,i){var n=i(29),r=i(21).apply;t.exports=function(t,e,i){var o=0===i.length?function(t){return t[e]()}:function(t){return r(t[e],t,i)};return n(t,o).setName(t,"invoke")}},function(t,e,i){var n=i(29),r=i(42);t.exports=function(t){return n(t,(function(t){return{value:t,time:r()}})).setName(t,"timestamp")}},function(t,e,i){function n(){var t=void 0;for(t=0;t<arguments.length;t++)if(!arguments[t])return arguments[t];return arguments[t-1]}var r=i(57);t.exports=function(t){return r(t,[],n).setName("and")}},function(t,e,i){function n(){var t=void 0;for(t=0;t<arguments.length;t++)if(arguments[t])return arguments[t];return arguments[t-1]}var r=i(57);t.exports=function(t){return r(t,[],n).setName("or")}},function(t,e,i){var n=i(29);t.exports=function(t){return n(t,(function(t){return!t})).setName(t,"not")}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s=i(3).NOTHING,a={_handlePrimaryValue:function(t){this._lastSecondary!==s&&this._emitValue(t)},_handleSecondaryValue:function(t){this._lastSecondary=t,this._lastSecondary||this._emitEnd()},_handleSecondaryEnd:function(){this._lastSecondary===s&&this._emitEnd()}},l=r("takeWhileBy",a),h=o("takeWhileBy",a);t.exports=function(t,e){return new(t._ofSameType(l,h))(t,e)}},function(t,e,i){var n=i(67),r=n.createStream,o=n.createProperty,s={_init:function(){this._hasFalseyFromSecondary=!1},_handlePrimaryValue:function(t){this._hasFalseyFromSecondary&&this._emitValue(t)},_handleSecondaryValue:function(t){this._hasFalseyFromSecondary=this._hasFalseyFromSecondary||!t},_handleSecondaryEnd:function(){this._hasFalseyFromSecondary||this._emitEnd()}},a=r("skipWhileBy",s),l=o("skipWhileBy",s);t.exports=function(t,e){return new(t._ofSameType(a,l))(t,e)}}]),game.R.variable=function(t){var e,i=t,n=game.R.stream((function(t){return e=t,function(){e=null}})).toProperty((function(){return i}));return Object.defineProperty(n,"value",{get:function(){return i},set:function(t){t!==i&&(i=t,e&&e.emit(i))}}),n},game.R.fromUpdate=function(){return game.R.fromEvents(game.scene,"update")},game.R.nextFrame=function(){return game.R.fromEvents(game.scene,"update").take(1)}})),game.module("game.game-over").require("game.panels").body((function(){function t(){function t(t){}function i(){}function h(t){var e=Math.floor(t/1e3),i=Math.floor(e/60);e>0?(Y.visible=!1,game.incentivise()||(q.visible=!0)):(Y.visible=!0,game.incentivise()||(q.visible=!1)),i=10>i?"0"+i:i.toString();var n=e%60;n=10>n?"0"+n:n.toString(),q.text=i+":"+n,game.G.bonusCountText=q.text,q.position.copy(W).add(.5*-q.width,2-q.height)}function c(){this.isDown||(this.isDown=!0,this.scale.set(.6))}function d(){this.isDown&&(this.isDown=!1,this.scale.set(.65),game.scene.emit("toggleSound"))}function p(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function f(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.system.setScene("Shop"))}function m(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function g(){this.isDown&&(this.isDown=!1,this.scale.set(1),window.sdkHandler.trigger("interstitialAd",{callback:function(){game.scene.emit("play")}},self))}function v(){}function y(){}function b(t){C.text=t.toString()}function _(t){}function x(){game.system.setScene("Playground")}function w(){EXAPI.isEnabledIncentiviseButton()?tt.isVisible()||tt.show():Z.isVisible()||Z.show()}game.Scene.call(this);var T=new game.Sprite("bg_select").addTo(this.stage);T.width=game.system.width,T.height=game.system.height;var S=(new game.Container).addTo(this.stage);S.x=.5*(game.system.width-game.System.width),game.R.fromEvents(this,"resize").onValue((function(){T.width=game.system.width,T.height=game.system.height,S.x=.5*(game.system.width-game.System.width),S.y=.5*(game.system.height-game.System.height)}));var E=new game.Sprite("hud_bg",.5*game.System.width,0).addTo(S);E.anchor.x=.5;var C=(new game.Sprite("coin_hud",-156,18,{anchor:e}).addTo(E),new game[game.USE_FONT?"Text":"BitmapText"]("000",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(E));C.position.set(-138,-3);var A=new game[game.USE_FONT?"Text":"BitmapText"](game.content[4],{font:game.USE_FONT?"16px Arial":"16px PixelDigivolve",fill:"white"}).addTo(S);A.position.set(.5*game.System.width-.5*A.width,64);var j=new game.Sprite("bg_promo").addTo(S);j.anchor.set(.5),j.position.set(.5*game.System.width,A.y+140);var R=300,M=(new game.Graphics).addTo(j);M.beginFill(),M.drawRect(-150,-180,R,360),M.endFill();var O=(new game.Container).addTo(j);O.position.x=-300,O.mask=M;var D=(new game.Container).addTo(O);D.position.x=R;var P=(new game.Graphics).addTo(D);P.beginFill(240116),P.drawRect(0,90,R,180),P.endFill(),P.position.set(-150,-180);var F=new game[game.USE_FONT?"Text":"BitmapText"](game.content[5]+":    "+game.G.score,{font:game.USE_FONT?"18px Arial":"22px PixelDigivolve",fill:"white"}).addTo(D),G=new game[game.USE_FONT?"Text":"BitmapText"](game.content[6]+":    "+game.G.best,{font:game.USE_FONT?"18px Arial":"22px PixelDigivolve",fill:"white"}).addTo(D),L=new game[game.USE_FONT?"Text":"BitmapText"](game.content[25]+": "+game.G.newCoins,{font:game.USE_FONT?"18px Arial":"22px PixelDigivolve",fill:"white",align:"center"}).addTo(D),B=Math.max(F.width,G.width,L.width);F.position.set(.5*-B,-58),G.position.set(.5*-B,-18),L.position.set(.5*-B,22);var I=game.R.interval(2e3,-1).scan((function(t,e){return t.idx+e>2?{idx:0,act:e}:t.idx+e<0?{idx:2,act:e}:{idx:t.idx+e,act:e}}),{idx:0,act:-1}).skip(1);I.onValue(t),j.interactive=!0,j.on("touchstart",i),j.on("mousedown",i);var N=new game[game.USE_FONT?"Text":"BitmapText"]("",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white",tint:16710218}).addTo(S);N.position.set(.5*game.System.width-.5*N.width,j.y+150),game.G.newHighScore?(N.text=game.content[3],N.position.x=.5*game.System.width-.5*N.width,new game.Tween(N.scale).to({x:[1.2,1],y:[1.2,1]},300).repeat(4).start()):N.text="";var k=new game.Sprite(u).addTo(S);k.anchor.set(.5),k.position.set(.5*game.System.width-160,N.y+120);var U=game.G.char+1;10>U&&(U="0"+U);var V=new game.Sprite("charater_small_"+U).addTo(k);V.anchor.set(.5),V.scale.set(.8);for(var H=-1,X=0;X<game.G.unlocks.length;X++)if(!game.G.unlocks[X]){H=X;break}H>=0&&(game.G.CHARACTERS[H].price<=game.G.coin$.value&&new game[game.USE_FONT?"Text":"BitmapText"]("!",{font:game.USE_FONT?"48px Arial":"48px PixelDigivolve",fill:"white",tint:14748416}).addTo(k).position.set(18,-60));var z=new game.Sprite("button_play_start").addTo(S);z.anchor.set(.5),z.position.set(.5*game.System.width,N.y+120);var W=new game.Sprite("button_2_wheel");W.anchor.set(.5),W.position.set(.5*game.System.width+160,N.y+120);var Y=new game.Sprite("one_free"),q=new game[game.USE_FONT?"Text":"BitmapText"]("00:59",{font:game.USE_FONT?"18px Arial":"18px PixelDigivolve",fill:"white"}).addTo(S);q.visible=!1,game.G.bonusTimer$.onValue(h),game.G.bonusAvailable||(Y.visible=!1,q.visible=!1);var Q=new game.Sprite("button_sound",.5*game.System.width,N.y+220,{anchor:e,interactive:!0,isDown:!1}).addTo(S);Q.scale.set(.65),Q.on("mousedown",c,Q),Q.on("touchstart",c,Q),Q.on("mouseup",d,Q),Q.on("mouseout",d,Q),Q.on("touchend",d,Q),k.interactive=!0,k.isDown=!1,k.on("mousedown",p,k),k.on("touchstart",p,k),k.on("mouseup",f,k),k.on("mouseout",f,k),k.on("touchend",f,k),z.interactive=!0,z.isDown=!1,z.on("mousedown",m,z),z.on("touchstart",m,z),z.on("mouseup",g,z),z.on("touchend",g,z),W.interactive=!0,W.isDown=!1,W.on("mousedown",v,W),W.on("touchstart",v,W),W.on("mouseup",y,W),W.on("mouseout",y,W),W.on("touchend",y,W),q.interactive=!0,q.on("mousedown",v,W),q.on("touchstart",v,W),q.on("mouseup",y,W),q.on("mouseout",y,W),q.on("touchend",y,W);var $=new l(S),K=new n(S,$),J=new r(S,$),Z=new o(S,$),tt=new s(S,$),et=new a(S,$,"heart");game.G.coin$.onValue(b),game.G.heart$.onValue(_),game.R.fromEvents(this,"toggleSound").throttle(100,{trailing:!1}).scan((function(t){return!t}),!game.audio.musicMuted).onValue((function(t){t?(Q.texture="button_sound",game.audio.musicMuted=game.audio.soundMuted=!1):(Q.texture="button_sound_off",game.audio.musicMuted=game.audio.soundMuted=!0)})),this.once("bonusAvailable",(function(){Y.visible=!1}));var it=game.R.fromEvents(this,"bonus");it.filter((function(){return game.G.bonusAvailable})).onValue((function(){game.system.setScene("Bonus")})),it.filter((function(){return!game.G.bonusAvailable})).filter(game.incentivise).onValue((function(){K.show()})),it.filter((function(){return!game.G.bonusAvailable})).filter((function(){return!game.incentivise()})).onValue((function(){J.show()})),this.on("skipBonusTimer",(function(){game.G.resetBonusTimer(),game.system.setScene("Bonus")}));var nt=game.R.fromEvents(this,"play"),rt=nt.filter((function(){return game.G.heart>0}));rt.onValue(x);var ot=nt.filter((function(){return game.G.heart<=0}));nt.log("tryToPlay"),ot.onValue(w),window.panel=Z,this.on("openHeartClaimPanel",(function(t){et.show(t)})),this.once("exit",(function(){game.G.lastScene="GameOver",I.offValue(t),game.G.coin$.offValue(b),game.G.heart$.offValue(_),game.G.bonusTimer$.offValue(h),rt.offValue(x),ot.offValue(w)}),this)}var e={x:.5,y:.5},i=this.imports["game.panels"],n=i.BonusAdPanel,r=i.BonusNotAvailablePanel,o=i.HeartNotAvailablePanel,s=i.MoreHeartsPanel,a=i.ClaimPanel,l=i.Dimmer,h=new game.Graphics;h.lineStyle(2,11333118),h.beginFill(3374255),h.drawRoundedRect(-31,-31,62,62,8),h.endFill();var u=h.generateTexture(game.scale);t.prototype=Object.create(game.Scene.prototype),Object.assign(t.prototype,{constructor:t,resize:function(){this.emit("resize")},exit:function(){this.removeAllListeners()}}),game.s.GameOver=t})),game.module("game.bonus").require("plugins.reactive","game.cloud").body((function(){function t(){function t(){this.isDown||(this.isDown=!0,_.scale.set(.95),game.audio.playSound("click"))}function o(){this.isDown&&(this.isDown=!1,_.scale.set(1),game.scene.emit("back"))}function s(){this.isDown||(this.isDown=!0,this.scale.set(.95),game.audio.playSound("click"))}function a(){this.isDown&&(this.isDown=!1,this.scale.set(1),game.scene.emit("roll"))}function l(){f.started=!0,f.table.aSpeed=8*Math.PI,new game.Tween(f.table).to({aSpeed:0},game.rnd.between(2e3,4e3)).easing("Quartic.Out").delay(game.rnd.between(300,900)).start(),game.G.getBonus()}function h(t){n[i[t]].action().delay(2e3).onEnd((function(){f.emit("finished")}))}function u(t){y.text=t.toString()}function c(t){}function d(){game.system.setScene("Shop")}function p(){game.system.setScene(game.G.lastScene)}game.Scene.call(this);var f=this,m=new game.Sprite("bg_select").addTo(this.stage);m.width=game.system.width,m.height=game.system.height,new r(10,100,this.stage),new r(320,300,this.stage),new r(120,400,this.stage),new r(400,500,this.stage);var g=(new game.Container).addTo(this.stage);g.x=.5*(game.system.width-game.System.width),this.container=g,game.R.fromEvents(this,"resize").onValue((function(){m.width=game.system.width,m.height=game.system.height,g.x=.5*(game.system.width-game.System.width),g.y=.5*(game.system.height-game.System.height)}));var v=new game.Sprite("hud_bg",.5*game.System.width,0).addTo(g);v.anchor.x=.5;var y=(new game.Sprite("coin_hud",-156,18,{anchor:e}).addTo(v),new game[game.USE_FONT?"Text":"BitmapText"]("000",{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(v));y.position.set(-138,-3);var b=(i.map((function(t,e){var i=new game.Sprite(n[t].texture).addTo(f.table);i.anchor.set(.5);var r=-e*Math.PI*2/8-.5*Math.PI;i.position.set(120,0).rotate(r),i.rotation=r+.5*Math.PI})),new game.Sprite("arrow").addTo(g));b.anchor.set(.5,.63),b.position.copy(this.table.position);var _=new game.Sprite("button_back").addTo(g);_.anchor.set(.5),_.position.set(.5*game.System.width-140,this.table.y+300),_.interactive=!0,_.isDown=!1,_.on("mousedown",t,_),_.on("touchstart",t,_),_.on("mouseup",o,_),_.on("mouseout",o,_),_.on("touchend",o,_);var x=(new game.Graphics).addTo(g);x.lineStyle(2,16777215),x.beginFill(5546532),x.drawRoundedRect(-130,-31,260,62,12),x.endFill(),x.position.set(.5*game.System.width+40,this.table.y+300);var w=new game[game.USE_FONT?"Text":"BitmapText"](game.content[20],{font:game.USE_FONT?"32px Arial":"32px PixelDigivolve",fill:"white"}).addTo(x);w.position.set(.5*-w.width,.5*-w.height-6),x.interactive=!0,x.isDown=!1,x.on("mousedown",s,x),x.on("touchstart",s,x),x.on("mouseup",a,x),x.on("mouseout",a,x),x.on("touchend",a,x);var T=game.R.fromEvents(this,"roll"),S=T.delay(1).map((function(){return!1})).toProperty((function(){return!0})),E=T.filterBy(S);E.onValue(l);var C=game.R.fromEvents(this,"stopped");C.onValue(h),game.G.coin$.onValue(u),game.G.heart$.onValue(c);var A=game.R.fromEvents(this,"finished");A.onValue(d);var j=E.map((function(){return!0})).toProperty((function(){return!1})),R=game.R.fromEvents(this,"back").filterBy(j.map((function(t){return!t})));R.onValue(p),this.once("exit",(function(){game.G.lastScene="Bonus",E.offValue(l),C.offValue(h),game.G.coin$.offValue(u),game.G.heart$.offValue(c),A.offValue(d),R.offValue(p)}),this)}var e={x:.5,y:.5},i=["None","Heart","Coin","None","None","Heart","Coin","Coin"],n={Box:{texture:"box_a",action:function(){return game.rnd.frac()<.5?n.Coin.action():n.Heart.action()}},Heart:{texture:"heart",action:function(){return game.R.sequentially(100,[0,0,0,0]).onValue((function(){}))}},Coin:{texture:"coin_small",action:function(){return game.R.sequentially(100,[0,0,0,0,0,0,0,0,0,0]).onValue((function(){var t=new game.Sprite("coin_hud").addTo(game.scene.container);t.anchor.set(.5),t.position.set(.5*game.System.width,260),new game.Tween(t.position).to({x:.5*game.System.width-156,y:18},1e3).easing("Cubic.InOut").onComplete((function(){t.remove(),game.G.coin+=1,game.audio.playSound("coin")})).start()}))}},None:{texture:"loos",action:function(){return game.R.constant(0)}}},r=this.imports["game.cloud"];t.prototype=Object.create(game.Scene.prototype),Object.assign(t.prototype,{constructor:t,update:function(){var t;this.table.aSpeed&&(this.table.rotation+=this.table.aSpeed*game.system.delta),this.started&&0===this.table.aSpeed&&(this.started=!1,game.audio.playSound("din"),this.emit("stopped",(t=this.table.rotation,Math.floor((t+2*Math.PI/16)%(2*Math.PI)/(2*Math.PI/8)))))},resize:function(){this.emit("resize")},exit:function(){this.removeAllListeners()}}),game.s.Bonus=t})),game.module("game.content").body((function(){game.texts=getTexts()})),game.build=1460461547848,game.config={loader:{bgColor:9800619},system:{width:400,height:640,hires:2,retina:!0,webGL:!0,resize:!0,rotateImg:"rotate.png",pauseOnHide:!0},storage:{id:"xxx"},ignoreModules:["engine.debug"],sourceFolder:"src",mediaFolder:"assets"};var runGameHelper=null;